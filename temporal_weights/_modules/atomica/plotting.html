

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>atomica.plotting &mdash; Atomica  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Atomica
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../general/index.html">General content</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../general/Compartment-Initialization.html">Initializing compartments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/Compartment-Initialization.html#characteristics-to-compartments">Characteristics to Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/Compartment-Initialization.html#problems-and-solutions">Problems and solutions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../general/Compartment-Initialization.html#negative-initial-compartment-sizes">Negative initial compartment sizes</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../general/Compartment-Initialization.html#underdetermined-system">Underdetermined system</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../general/Compartment-Initialization.html#inconsistent-system">Inconsistent system</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../general/Compartment-Initialization.html#inconsistent-overdetermined-system">Inconsistent overdetermined system</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../general/Compartment-Initialization.html#resolving-inconsistencies-initialization-weight">Resolving inconsistencies - initialization weight</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Compartment-Initialization.html#computing-initial-values-at-arbitrary-times">Computing initial values at arbitrary times</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../general/Contextual-Overview.html">Contextual overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../general/File-Logging.html">Logging cookbook</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/File-Logging.html#changing-the-amount-of-output">Changing the amount of output</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/File-Logging.html#dumping-output-to-a-log-file">Dumping output to a log file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../general/Optimization.html">Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/Optimization.html#optimization-class"><code class="docutils literal notranslate"><span class="pre">Optimization</span></code> class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#performing-an-optimization">Performing an optimization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Optimization.html#adjustments">Adjustments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#implementation-specifics">Implementation specifics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Optimization.html#constraints">Constraints</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#id1">Implementation specifics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#total-spending-constraint">Total spending constraint</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Optimization.html#measurables">Measurables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#measurables-vs-constraints">Measurables vs. constraints</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Optimization.html#optimization-examples">Optimization examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#maximize-people-alive">Maximize people alive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#minimize-deaths">Minimize deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#minimize-spending">Minimize spending</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Optimization.html#optimization-calling-structure">Optimization calling structure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../general/Parameters.html">Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#types-of-parameter">Types of parameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#value-precedence">Value precedence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#performance-considerations">Performance considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#timescales">Timescales</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#derivatives">Derivatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#interpolation-and-smoothing">Interpolation and smoothing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#maximum-compartment-duration">Maximum compartment duration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../general/junctions/Junctions.html">Junction overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../general/population-types/Population-Types.html">Population types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/population-types/Population-Types.html#framework-population-types">Framework population types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/population-types/Population-Types.html#databook-population-types">Databook population types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/population-types/Population-Types.html#programs-and-population-types">Programs and population types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/population-types/Population-Types.html#running-simulations">Running simulations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/population-types/Population-Types.html#plotting">Plotting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../general/programs/Programs.html">Program System</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/programs/Programs.html#data-and-structural-overview">Data and structural overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/programs/Programs.html#coverage-computation">Coverage computation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/programs/Programs.html#capacity">Capacity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/programs/Programs.html#coverage">Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/programs/Programs.html#number-covered">Number covered</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/programs/Programs.html#outcome-computation">Outcome computation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/programs/Programs.html#coverage-interaction">Coverage interaction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/programs/Programs.html#impact-interactions">Impact interactions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/programs/Programs.html#parameters-in-number-units">Parameters in Number units</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/programs/Programs.html#targeting-transfers">Targeting transfers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../general/skipping-excel-cells.html">Skipping Excel cells</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/skipping-excel-cells.html#General-principles">General principles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/skipping-excel-cells.html#Frameworks">Frameworks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/skipping-excel-cells.html#Databooks">Databooks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/skipping-excel-cells.html#TimeDependentConnections">TimeDependentConnections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/skipping-excel-cells.html#TimeDependentValuesEntry">TimeDependentValuesEntry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/skipping-excel-cells.html#Program-books">Program books</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/skipping-excel-cells.html#Program-targeting">Program targeting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/skipping-excel-cells.html#Spending-data">Spending data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/skipping-excel-cells.html#Program-effects">Program effects</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../general/stochastic/stochastic.html">Stochastic models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html">Timed transitions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#motivation">Motivation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#use-cases">Use cases</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#basic-implementation">Basic implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#initialization">Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#normal-transitions">Normal transitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#duration-groups">Duration groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#architecture">Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#transfers">Transfers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#junctions">Junctions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Basic-workflow.html">Basic workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Basic-workflow.html#Starting-an-application">Starting an application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Basic-workflow.html#Creating-a-project">Creating a project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Basic-workflow.html#Calibrating-the-model">Calibrating the model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Basic-workflow.html#Manual-calibration">Manual calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Basic-workflow.html#Automatic-calibration">Automatic calibration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Basic-workflow.html#Adding-programs">Adding programs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Basic-workflow.html#Reconciliation">Reconciliation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Basic-workflow.html#Scenarios">Scenarios</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Basic-workflow.html#Parameter-scenarios">Parameter scenarios</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Basic-workflow.html#Budget-scenarios">Budget scenarios</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Basic-workflow.html#Coverage-scenarios">Coverage scenarios</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Basic-workflow.html#Optimization">Optimization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/databooks/Databooks.html">Data and Databooks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/databooks/Databooks.html#TimeSeries-objects"><code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Population-table">Population table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#TimeDependentConnections">TimeDependentConnections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#TimeDependentValuesEntry">TimeDependentValuesEntry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/databooks/Databooks.html#Modifying-databooks">Modifying databooks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Creating-a-blank-databook">Creating a blank databook</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Pre-populating-data">Pre-populating data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Adding-a-variable">Adding a variable</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Removing-a-variable">Removing a variable</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Add/remove-populations">Add/remove populations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Add/remove-transfers-and-interactions">Add/remove transfers and interactions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Changing-databook-years">Changing databook years</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Further-spreadsheet-modification">Further spreadsheet modification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Frameworks.html">Frameworks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Frameworks.html#ProjectFramework-basics"><code class="docutils literal notranslate"><span class="pre">ProjectFramework</span></code> basics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Frameworks.html#Accessing-the-data">Accessing the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Frameworks.html#Exporting-a-Framework">Exporting a Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Frameworks.html#Making-a-new-Framework">Making a new Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Frameworks.html#Validating-the-input">Validating the input</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Frameworks.html#Adding-a-quantity-to-the-Framework">Adding a quantity to the Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Frameworks.html#Convenience-methods">Convenience methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Frameworks.html#Iterating-over-items">Iterating over items</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Model-dev.html">Models (implementation)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Model-dev.html#Model-object-structure">Model object structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-dev.html#Compartment">Compartment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-dev.html#Link">Link</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-dev.html#Characteristic">Characteristic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-dev.html#Parameter">Parameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-dev.html#Population">Population</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-dev.html#Model">Model</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Model-dev.html#Building">Building</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Model-dev.html#Integrating">Integrating</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-dev.html#Linking-and-unlinking">Linking and unlinking</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Model-user.html">Results and Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Model-user.html#Pre-specified-plots">Pre-specified plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Model-user.html#Exporting-results">Exporting results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Model-user.html#Exporting-raw-results">Exporting raw results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Model-user.html#Accessing-raw-values">Accessing raw values</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-user.html#Traversing-the-graph">Traversing the graph</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/ode_models/ode_models.html">Comparison with ODEs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Plotting.html">Plotting Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Quick-Reference">Quick Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Just-give-me-a-plot">Just give me a plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#FAQs">FAQs</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Plotting.html#Data-manipulation">Data manipulation</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Plotting.html#General-issues">General issues</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Plotting.html#Bar-graphs">Bar graphs</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Plotting.html#Legends">Legends</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Plotting-system-design">Plotting system design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Data-preparation-and-aggregation">Data preparation and aggregation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Characteristic-aggregations">Characteristic aggregations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Function-aggregations">Function aggregations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Axis-units">Axis units</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Flow-rate-aggregations-and-disaggregations">Flow rate aggregations and disaggregations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Plotting-series">Plotting series</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Overriding-data">Overriding data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Stacked-plots-and-data">Stacked plots and data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Plotting-transition-parameters-and-flow-rates">Plotting transition parameters and flow rates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Setting-full-names">Setting full names</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Further-formatting">Further formatting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Module-level-settings-and-separate-legends">Module-level settings and separate legends</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Time-accumulation">Time accumulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Subplots">Subplots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Saving-figures">Saving figures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Plotting-bars">Plotting bars</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Time-aggregation">Time aggregation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Stacking-bars">Stacking bars</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Negative-values">Negative values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Horizontal-bars">Horizontal bars</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Labelling-bars">Labelling bars</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Working-with-legends">Working with legends</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Controlling-legend-order">Controlling legend order</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Relabeling-legend-entries">Relabeling legend entries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Making-a-new-legend">Making a new legend</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Time-aggregation-options">Time aggregation options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Flow-rates">Flow rates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Setting-colors">Setting colors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Colour-design-patterns">Colour design patterns</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Plot-Programs.html">Plotting programs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plot-Programs.html#Creating-PlotData-from-programs">Creating <code class="docutils literal notranslate"><span class="pre">PlotData</span></code> from programs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plot-Programs.html#Plotting-spending-and-coverage">Plotting spending and coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plot-Programs.html#Bar-plots-and-selecting-times">Bar plots and selecting times</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plot-Programs.html#Time-aggregation">Time aggregation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plot-Programs.html#Output-aggregation">Output aggregation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Plot-Units.html">Plot unit conversions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plot-Units.html#Parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plot-Units.html#Programs">Programs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Probability-Rescaling.html">Probability rescaling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Probability-Rescaling.html#Geometric-vs-Exponential-distribution-for-durations">Geometric vs Exponential distribution for durations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Probability-Rescaling.html#Preserving-durations-vs-preserving-annual-flows">Preserving durations vs preserving annual flows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Probability-Rescaling.html#Atomica-models">Atomica models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Probability-Rescaling.html#Conclusions">Conclusions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Scenarios.html">Scenarios</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Scenarios.html#Parameter-scenarios">Parameter scenarios</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Scenarios.html#Using-the-ParameterScenario-class">Using the <code class="docutils literal notranslate"><span class="pre">ParameterScenario</span></code> class</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Scenarios.html#Scenario-start-year">Scenario start year</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Scenarios.html#Scenario-end-year">Scenario end year</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Scenarios.html#Smoothing">Smoothing</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Scenarios.html#Step-changes">Step changes</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Scenarios.html#Parameter-interpolation-prior-to-the-start-year">Parameter interpolation prior to the start year</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Scenarios.html#Inspecting-the-ParameterSet">Inspecting the <code class="docutils literal notranslate"><span class="pre">ParameterSet</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Scenarios.html#Modifying-a-ParameterSet">Modifying a <code class="docutils literal notranslate"><span class="pre">ParameterSet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Scenarios.html#Overwriting-function-parameters">Overwriting function parameters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Uncertainty.html">Uncertainty</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Uncertainty.html#Specifying-uncertainty">Specifying uncertainty</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Uncertainty.html#Sampling-inputs">Sampling inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Uncertainty.html#Analysis">Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Uncertainty.html#Basic-plotting">Basic plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Uncertainty.html#Comparing-sampled-results">Comparing sampled results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Uncertainty.html#Distributions-of-differences-between-results">Distributions of differences between results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Uncertainty.html#Cascade-ensembles">Cascade ensembles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Uncertainty.html#Virtual-stages">Virtual stages</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Uncertainty.html#Memory-limited-environments">Memory-limited environments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Uncertainty.html#Parallization">Parallization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Uncertainty.html#Experimental-plots">Experimental plots</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/override_cost_coverage/override_cost_coverage.html">Overriding coverage calculations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/override_cost_coverage/override_cost_coverage.html#Add-a-new-population-type">Add a new population type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/override_cost_coverage/override_cost_coverage.html#Overwriting-coverage">Overwriting coverage</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/T1-Defining-a-model.html">T1 - Defining a model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T1-Defining-a-model.html#Generating-a-databook">Generating a databook</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T1-Defining-a-model.html#Exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/T2-Calibration.html">T2 - Calibration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T2-Calibration.html#Calibration-scale-factors">Calibration scale factors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T2-Calibration.html#Calibrating-compartment-sizes">Calibrating compartment sizes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T2-Calibration.html#Calibrating-transfers">Calibrating transfers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T2-Calibration.html#Automatic-calibration">Automatic calibration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorial/T2-Calibration.html#Automated-calibration-of-transfers">Automated calibration of transfers</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T2-Calibration.html#Calibration-tips">Calibration tips</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/T3-Multiple-populations.html">T3 - Multiple populations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T3-Multiple-populations.html#Transfers">Transfers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T3-Multiple-populations.html#Interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T3-Multiple-populations.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/T4-Characteristics.html">T4 - Characteristics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/T5-Junctions.html">T5 - Junctions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T5-Junctions.html#Exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/T6-Programs.html">T6 - Programs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T6-Programs.html#Reconciliation">Reconciliation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T6-Programs.html#Common-intervention-types">Common intervention types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorial/T6-Programs.html#Vaccines">Vaccines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorial/T6-Programs.html#Diagnosis-screening-program">Diagnosis screening program</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorial/T6-Programs.html#Diagnosis">Diagnosis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorial/T6-Programs.html#Screening-with-confirmatory-test">Screening with confirmatory test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorial/T6-Programs.html#One-off-treatment">One-off treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorial/T6-Programs.html#Sustained-treatment">Sustained treatment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T6-Programs.html#Exercise">Exercise</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../library/index.html">Model library</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../library/cervicalcancer.html">Cervical cancer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/cervicalcancer.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/cervicalcancer.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-source">Compartment: Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-without-cervical-cancer">Compartment: Without cervical cancer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-screened">Compartment: Screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-treated">Compartment: Treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-dead-other">Compartment: Dead (other)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-dead-cervical-cancer">Compartment: Dead (cervical cancer)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/cervicalcancer.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#characteristic-population-size">Characteristic: Population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#characteristic-estimated-number-of-women-with-cervical-cancer">Characteristic: Estimated number of women with cervical cancer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#characteristic-estimated-number-of-women-with-cervical-cancer-who-have-ever-been-screened">Characteristic: Estimated number of women with cervical cancer who have ever been screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#characteristic-estimated-number-of-women-with-cervical-cancer-who-have-ever-been-diagnosed">Characteristic: Estimated number of women with cervical cancer who have ever been diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#characteristic-estimated-number-of-women-being-treated-for-cervical-cancer">Characteristic: Estimated number of women being treated for cervical cancer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/cervicalcancer.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-annual-number-of-births">Parameter: Annual number of births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-estimated-number-of-new-cervical-cancer-cases-annually">Parameter: Estimated number of new cervical cancer cases annually</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-acquisition-rate">Parameter: Acquisition rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-annual-number-screened">Parameter: Annual number screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-screening-yield">Parameter: Screening yield</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-annual-number-screened-positive">Parameter: Annual number screened positive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-screening-sensitivity">Parameter: Screening sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-probability-of-a-positive-confirmation-following-screening">Parameter: Probability of a positive confirmation following screening</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-mortality-rate">Parameter: Mortality rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-mortality-rate-for-those-with-untreated-cervical-cancer">Parameter: Mortality rate for those with untreated cervical cancer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/cervicalcancer.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/cervicalcancer.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#cascade-cervical-cancer-cascade">Cascade: Cervical cancer cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/diabetes.html">Diabetes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/diabetes.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/diabetes.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-source">Compartment: Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-susceptible">Compartment: Susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-unaware-uncomplicated">Compartment: Unaware &amp; uncomplicated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-unaware-vascular-damage">Compartment: Unaware &amp; vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-screened-uncomplicated">Compartment: Screened &amp; uncomplicated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-screened-vascular-damage">Compartment: Screened &amp; vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-diagnosed-uncomplicated">Compartment: Diagnosed &amp; uncomplicated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-diagnosed-vascular-damage">Compartment: Diagnosed &amp; vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-successful-treatment-uncomplicated">Compartment: Successful treatment &amp; uncomplicated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-successful-treatment-vascular-damage">Compartment: Successful treatment &amp; vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-treatment-failure-uncomplicated">Compartment: Treatment failure &amp; uncomplicated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-treatment-failure-vascular-damage">Compartment: Treatment failure &amp; vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-dead-diabetes">Compartment: Dead (diabetes)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-dead-other">Compartment: Dead (other)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/diabetes.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-population-size">Characteristic: Population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-all-people-with-t2dm">Characteristic: All people with T2DM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-people-screened-for-t2dm">Characteristic: People screened for T2DM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-people-diagnosed-with-t2dm">Characteristic: People diagnosed with T2DM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-people-treated-for-t2dm">Characteristic: People treated for T2DM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-people-with-hba1c-control">Characteristic: People with HbA1c control</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-proportion-screened-for-t2dm">Characteristic: Proportion screened for T2DM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-proportion-diagnosed-with-t2dm">Characteristic: Proportion diagnosed with T2DM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-proportion-treated-for-t2dm">Characteristic: Proportion treated for T2DM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-proportion-with-hba1c-control">Characteristic: Proportion with HbA1c control</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/diabetes.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-annual-number-of-births">Parameter: Annual number of births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-estimated-number-of-new-diabetes-cases-annually">Parameter: Estimated number of new diabetes cases annually</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-acquisition-rate">Parameter: Acquisition rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-time-before-progression-to-vascular-damage">Parameter: Time before progression to vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-annual-number-screened">Parameter: Annual number screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-yield-among-those-screened">Parameter: Yield among those screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-annual-number-screened-positive">Parameter: Annual number screened positive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-screening-sensitivity">Parameter: Screening sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-diagnosis-sensitivity">Parameter: Diagnosis sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-treatment-failure-rate">Parameter: Treatment failure rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-proportion-of-those-experiencing-treatment-failure-who-are-offered-support">Parameter: Proportion of those experiencing treatment failure who are offered support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-death-rate-for-diabetes-with-vascular-damage">Parameter: Death rate for diabetes with vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-background-mortality-rate">Parameter: Background mortality rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/diabetes.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/diabetes.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#cascade-diabetes-care-cascade">Cascade: Diabetes care cascade</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#cascade-diabetes-care-cascade-vascular-damage">Cascade: Diabetes care cascade - vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#cascade-diabetes-care-cascade-uncomplicated-cases">Cascade: Diabetes care cascade - uncomplicated cases</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/dt.html">Diagnosis-Treated</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/dt.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/dt.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#compartment-diagnosed-not-treated">Compartment: Diagnosed, not treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#compartment-treated">Compartment: Treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/dt.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#characteristic-all-diagnosed">Characteristic: All diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/dt.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#parameter-annual-number-lost-to-follow-up">Parameter: Annual number lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#parameter-proportion-of-those-on-treatment-lost-to-follow-up">Parameter: Proportion of those on treatment lost-to-follow-up</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/dt.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/dt.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#cascade-cascade">Cascade: Cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/hiv.html">HIV without dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#compartment-linked-to-care">Compartment: Linked to care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#compartment-treated">Compartment: Treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#compartment-lost-to-follow-up">Compartment: Lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#compartment-virally-suppressed-comp">Compartment: Virally suppressed (comp)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#characteristic-all-plhiv">Characteristic: All PLHIV</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#characteristic-aware-of-their-status">Characteristic: Aware of their status</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#characteristic-ever-in-care">Characteristic: Ever in care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#characteristic-currently-in-care">Characteristic: Currently in care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#characteristic-virally-suppressed">Characteristic: Virally suppressed</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-diagnosis-rate">Parameter: Diagnosis rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-average-time-taken-to-be-linked-to-care-years">Parameter: Average time taken to be linked to care (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-time-after-initiating-art-to-achieve-viral-suppression-years">Parameter: Time after initiating ART to achieve viral suppression (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-treatment-failure-rate">Parameter: Treatment failure rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#cascade-main">Cascade: main</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/hiv_dyn.html">HIV with dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv_dyn.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv_dyn.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-source">Compartment: Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-susceptible">Compartment: Susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-linked-to-care">Compartment: Linked to care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-treated">Compartment: Treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-lost-to-follow-up">Compartment: Lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-virally-suppressed-comp">Compartment: Virally suppressed (comp)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-dead-hiv-aids">Compartment: Dead (HIV/AIDS)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-dead-other">Compartment: Dead (other)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv_dyn.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#characteristic-population-size">Characteristic: Population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#characteristic-all-plhiv">Characteristic: All PLHIV</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#characteristic-aware-of-their-status">Characteristic: Aware of their status</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#characteristic-ever-in-care">Characteristic: Ever in care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#characteristic-currently-in-care">Characteristic: Currently in care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#characteristic-virally-suppressed">Characteristic: Virally suppressed</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv_dyn.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-annual-number-of-births">Parameter: Annual number of births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-estimated-number-of-new-hiv-infections-annually">Parameter: Estimated number of new HIV infections annually</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-acquisition-rate">Parameter: Acquisition rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-annual-number-of-tests-done">Parameter: Annual number of tests done</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-test-yield">Parameter: Test yield</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-annual-number-tested-positive">Parameter: Annual number tested positive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-test-sensitivity">Parameter: Test sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-average-time-taken-to-be-linked-to-care-years">Parameter: Average time taken to be linked to care (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-time-after-initiating-art-to-achieve-viral-suppression-years">Parameter: Time after initiating ART to achieve viral suppression (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-treatment-failure-rate">Parameter: Treatment failure rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-death-rate-for-those-with-untreated-hiv">Parameter: Death rate for those with untreated HIV</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-death-rate-for-those-with-on-unsuppressive-art">Parameter: Death rate for those with on unsuppressive ART</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-death-rate-for-those-with-on-suppressive-art">Parameter: Death rate for those with on suppressive ART</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-background-mortality-rate">Parameter: Background mortality rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv_dyn.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv_dyn.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#cascade-hiv-care-cascade">Cascade: HIV care cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/hypertension.html">Hypertension</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#compartment-screened">Compartment: Screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#compartment-treated">Compartment: Treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#compartment-controlled">Compartment: Controlled</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#characteristic-all-people-with-condition">Characteristic: All people with condition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#characteristic-screened-people">Characteristic: Screened people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#characteristic-diagnosed-people">Characteristic: Diagnosed people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#characteristic-blood-pressure-controlled">Characteristic: Blood pressure controlled</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-annual-number-screened">Parameter: Annual number screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-screening-rate">Parameter: Screening rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-diagnosis-rate">Parameter: Diagnosis rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-time-after-initiating-treatment-to-achieve-bp-control-years">Parameter: Time after initiating treatment to achieve BP control (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-treatment-failure-rate">Parameter: Treatment failure rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#cascade-main">Cascade: main</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/hypertension_dyn.html">Hypertension with dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension_dyn.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension_dyn.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-source">Compartment: Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-no-hypertension">Compartment: No hypertension</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-screened-not-diagnosed">Compartment: Screened, not diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-diagnosed-not-treated">Compartment: Diagnosed, not treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-treated-not-controlled">Compartment: Treated, not controlled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-controlled">Compartment: Controlled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-dead-hypertension">Compartment: Dead (hypertension)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-dead-other">Compartment: Dead (other)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension_dyn.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#characteristic-population-size">Characteristic: Population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#characteristic-all-people-with-condition">Characteristic: All people with condition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#characteristic-screened-people">Characteristic: Screened people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#characteristic-diagnosed-people">Characteristic: Diagnosed people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#characteristic-blood-pressure-controlled">Characteristic: Blood pressure controlled</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension_dyn.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-annual-number-of-births">Parameter: Annual number of births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-estimated-number-of-new-cases-annually">Parameter: Estimated number of new cases annually</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-acquisition-rate">Parameter: Acquisition rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-annual-number-screened">Parameter: Annual number screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-target-population-for-screening-programs">Parameter: Target population for screening programs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-screening-coverage-shares">Parameter: Screening coverage shares</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-screening-yield">Parameter: Screening yield</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-annual-number-screened-positive">Parameter: Annual number screened positive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-time-after-initiating-treatment-to-achieve-bp-control-years">Parameter: Time after initiating treatment to achieve BP control (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-treatment-failure-rate">Parameter: Treatment failure rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-death-rate-for-those-with-untreated-hypertension">Parameter: Death rate for those with untreated hypertension</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-background-mortality-rate">Parameter: Background mortality rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension_dyn.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension_dyn.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#cascade-hypertension-care-cascade">Cascade: Hypertension care cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/service.html">Service modalities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/service.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/service.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#compartment-source">Compartment: Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#compartment-unaware-of-own-need">Compartment: Unaware of own need</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#compartment-aware-but-not-linked-to-services">Compartment: Aware but not linked to services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#compartment-linked-to-service-provider">Compartment: Linked to service provider</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#compartment-receiving-services">Compartment: Receiving services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#compartment-successful-outcome">Compartment: Successful outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#compartment-dead">Compartment: Dead</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/service.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-all-people">Characteristic: All people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-people-aware-of-need">Characteristic: People aware of need</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-people-linked-to-services">Characteristic: People linked to services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-people-receiving-services">Characteristic: People receiving services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-people-with-successful-outcomes">Characteristic: People with successful outcomes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-proportion-aware-of-need">Characteristic: Proportion aware of need</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-proportion-linked-to-services">Characteristic: Proportion linked to services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-proportion-receiving-services">Characteristic: Proportion receiving services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-proportion-with-successful-outcomes">Characteristic: Proportion with successful outcomes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/service.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#parameter-number-of-new-cases-annual">Parameter: Number of new cases (annual)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#parameter-number-becoming-aware-of-need-annual">Parameter: Number becoming aware of need (annual)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#parameter-number-linked-to-services-annual">Parameter: Number linked to services (annual)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#parameter-number-initiated-onto-services-annual">Parameter: Number initiated onto services (annual)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#parameter-proportion-of-those-without-successful-outcomes-who-are-offered-further-support">Parameter: Proportion of those without successful outcomes who are offered further support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#parameter-probability-of-successful-outcome-among-those-receiving-services">Parameter: Probability of successful outcome among those receiving services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#parameter-background-mortality-rate">Parameter: Background mortality rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/service.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/service.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#cascade-main">Cascade: main</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/sir.html">SIR model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/sir.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/sir.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#compartment-susceptible">Compartment: Susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#compartment-infected">Compartment: Infected</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#compartment-recovered">Compartment: Recovered</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#compartment-dead">Compartment: Dead</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/sir.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-total-number-of-entities">Characteristic: Total number of entities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-prevalence">Characteristic: Prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-number-ever-infected">Characteristic: Number ever infected</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-number-infected-or-susceptible">Characteristic: Number infected or susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-number-not-at-risk-of-death">Characteristic: Number not at risk of death</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-proportion-ever-infected">Characteristic: Proportion ever infected</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-proportion-infected-or-susceptible">Characteristic: Proportion infected or susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-proportion-not-at-risk-of-death">Characteristic: Proportion not at risk of death</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/sir.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#parameter-transmission-probability-per-contact">Parameter: Transmission probability per contact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#parameter-number-of-contacts-annually">Parameter: Number of contacts annually</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#parameter-average-duration-of-infections-years">Parameter: Average duration of infections (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#parameter-death-rate-for-infected-people">Parameter: Death rate for infected people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#parameter-death-rate-for-susceptible-people">Parameter: Death rate for susceptible people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#parameter-force-of-infection">Parameter: Force of infection</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/sir.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/sir.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#cascade-main">Cascade: main</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/tb.html">TB full model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-initialization-population-size">Compartment: Initialization population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-susceptible">Compartment: Susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-vaccinated">Compartment: Vaccinated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-early-latent-untreated-diagnosable">Compartment: Early latent untreated (diagnosable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-early-latent-on-treatment">Compartment: Early latent on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-latent-early-treatment-outcome">Compartment: Junction: Latent early treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-late-latent-untreated-diagnosable">Compartment: Late latent untreated (diagnosable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-late-latent-on-treatment">Compartment: Late latent on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-latent-late-treatment-outcome">Compartment: Junction: Latent late treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-susceptible-diagnosis-restricted">Compartment: Susceptible (diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-early-latent-untreated-diagnosis-restricted">Compartment: Early latent untreated (diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-late-latent-untreated-diagnosis-restricted">Compartment: Late latent untreated (diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-smear-disaggregator-for-new-active">Compartment: Junction: Smear disaggregator for new active</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-strain-disaggregator-for-new-smear-positive">Compartment: Junction: Strain disaggregator for new smear positive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-ds-undiagnosed">Compartment: SP-DS undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-ds-diagnosed-but-not-on-treatment">Compartment: SP-DS diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-ds-on-treatment">Compartment: SP-DS on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-sp-ds-treatment-outcome">Compartment: Junction: SP-DS treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-mdr-undiagnosed">Compartment: SP-MDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-mdr-diagnosed-but-not-on-treatment">Compartment: SP-MDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-mdr-on-treatment">Compartment: SP-MDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-sp-mdr-treatment-outcome">Compartment: Junction: SP-MDR treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-xdr-undiagnosed">Compartment: SP-XDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-xdr-diagnosed-but-not-on-treatment">Compartment: SP-XDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-xdr-on-treatment">Compartment: SP-XDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-sp-xdr-treatment-outcome">Compartment: Junction: SP-XDR treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-strain-disaggregator-for-new-smear-negative">Compartment: Junction: Strain disaggregator for new smear negative</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-ds-undiagnosed">Compartment: SN-DS undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-ds-diagnosed-but-not-on-treatment">Compartment: SN-DS diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-ds-on-treatment">Compartment: SN-DS on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-sn-ds-treatment-outcome">Compartment: Junction: SN-DS treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-mdr-undiagnosed">Compartment: SN-MDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-mdr-diagnosed-but-not-on-treatment">Compartment: SN-MDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-mdr-on-treatment">Compartment: SN-MDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-sn-mdr-treatment-outcome">Compartment: Junction: SN-MDR treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-xdr-undiagnosed">Compartment: SN-XDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-xdr-diagnosed-but-not-on-treatment">Compartment: SN-XDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-xdr-on-treatment">Compartment: SN-XDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-sn-xdr-treatment-outcome">Compartment: Junction: SN-XDR treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-completed-treatment-active">Compartment: Completed treatment (active)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-source-origin-of-births">Compartment: Source: Origin of births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-source-origin-of-immigration">Compartment: Source: Origin of immigration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-infection-status-of-immigrants">Compartment: Junction: Infection status of immigrants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sink-cumulative-tb-deaths-over-simulation">Compartment: Sink: Cumulative TB deaths over simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sink-cumulative-non-tb-deaths-over-simulation">Compartment: Sink: Cumulative non-TB deaths over simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sink-cumulative-emigration-over-simulation">Compartment: Sink: Cumulative emigration over simulation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-latent-tb-infections-on-treatment">Characteristic: Latent TB infections on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-diagnosis-restricted-latent-infections">Characteristic: Suspected diagnosis restricted latent infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-undiagnosed-latent-infections">Characteristic: Suspected undiagnosed latent infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-early-latent-infections">Characteristic: Suspected early latent infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-late-latent-infections">Characteristic: Suspected late latent infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-latent-infections">Characteristic: Suspected latent infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-known-sp-ds-infections">Characteristic: Known SP-DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-known-sp-mdr-infections">Characteristic: Known SP-MDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-known-sp-xdr-infections">Characteristic: Known SP-XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-known-sn-ds-infections">Characteristic: Known SN-DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-known-sn-mdr-infections">Characteristic: Known SN-MDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-known-sn-xdr-infections">Characteristic: Known SN-XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-known-active-tb-infections">Characteristic: Known active TB infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-diagnosed-number-of-living-people-that-developed-active-tb">Characteristic: Diagnosed number of living people that developed active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-ds-infections">Characteristic: Suspected SP-DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-md-infections">Characteristic: Suspected SP-MD infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-xdr-infections">Characteristic: Suspected SP-XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-ds-infections">Characteristic: Suspected SN-DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-mdr-infections">Characteristic: Suspected SN-MDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-xdr-infections">Characteristic: Suspected SN-XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-infections">Characteristic: Suspected SP infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-infections">Characteristic: Suspected SN infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-estimated-number-of-people-with-ds-tb">Characteristic: Estimated number of people with DS TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-estimated-number-of-people-with-mdr-tb">Characteristic: Estimated number of people with MDR TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-estimated-number-of-people-with-xdr-tb">Characteristic: Estimated number of people with XDR TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-estimated-number-of-people-with-dr-tb">Characteristic: Estimated number of people with DR TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-estimated-number-of-people-with-active-tb">Characteristic: Estimated number of people with active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-estimated-number-of-living-people-that-developed-active-tb">Characteristic: Estimated number of living people that developed active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-population-size">Characteristic: Population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sp-ds-infections">Characteristic: Suspected untreated SP-DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sp-mdr-infections">Characteristic: Suspected untreated SP-MDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sp-xdr-infections">Characteristic: Suspected untreated SP-XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sn-ds-infections">Characteristic: Suspected untreated SN-DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sn-mdr-infections">Characteristic: Suspected untreated SN-MDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sn-xdr-infections">Characteristic: Suspected untreated SN-XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sp-ds-prevalence">Characteristic: Suspected untreated SP-DS prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sp-mdr-prevalence">Characteristic: Suspected untreated SP-MDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sp-xdr-prevalence">Characteristic: Suspected untreated SP-XDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sn-ds-prevalence">Characteristic: Suspected untreated SN-DS prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sn-mdr-prevalence">Characteristic: Suspected untreated SN-MDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sn-xdr-prevalence">Characteristic: Suspected untreated SN-XDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-ltbi-prevalence">Characteristic: Suspected LTBI prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-ds-prevalence">Characteristic: Suspected SP-DS prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-mdr-prevalence">Characteristic: Suspected SP-MDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-xdr-prevalence">Characteristic: Suspected SP-XDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-ds-prevalence">Characteristic: Suspected SN-DS prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-mdr-prevalence">Characteristic: Suspected SN-MDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-xdr-prevalence">Characteristic: Suspected SN-XDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-prevalence">Characteristic: Suspected SP prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-prevalence">Characteristic: Suspected SN prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-ds-prevalence">Characteristic: Suspected DS prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-dr-prevalence">Characteristic: Suspected DR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-mdr-prevalence">Characteristic: Suspected MDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-xdr-prevalence">Characteristic: Suspected XDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-active-tb-prevalence">Characteristic: Suspected active TB prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-undiagnosed-ds-infections">Characteristic: Suspected undiagnosed DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-undiagnosed-mdr-infections">Characteristic: Suspected undiagnosed MDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-undiagnosed-xdr-infections">Characteristic: Suspected undiagnosed XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-diagnosed-ds-infections">Characteristic: Diagnosed DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-diagnosed-mdr-infections">Characteristic: Diagnosed MDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-diagnosed-xdr-infections">Characteristic: Diagnosed XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-ds-cases-on-treatment">Characteristic: DS cases on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-mdr-cases-on-treatment">Characteristic: MDR cases on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-xdr-cases-on-treatment">Characteristic: XDR cases on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-active-tb-cases-on-treatment">Characteristic: Active TB cases on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-number-of-living-people-that-have-recovered-from-active-tb-in-the-previous-2-years">Characteristic: Number of living people that have recovered from active TB in the previous 2 years</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-diagnosis-sufficiency-known-versus-suspected-infections">Characteristic: Diagnosis sufficiency (known versus suspected infections)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-treatment-sufficiency-on-treatment-versus-known-infections">Characteristic: Treatment sufficiency (on-treatment versus known infections)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-the-population-with-active-tb">Parameter: Initialization proportion of the population with active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-the-population-with-latent-tb">Parameter: Initialization proportion of the population with latent TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-latent-tb-cases-that-are-early-latent">Parameter: Initialization proportion of latent TB cases that are early latent</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-latent-tb-cases-that-are-on-treatment">Parameter: Initialization proportion of latent TB cases that are on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-active-tb-cases-that-are-diagnosed">Parameter: Initialization proportion of active TB cases that are diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-diagnosed-tb-cases-that-are-on-treatment">Parameter: Initialization proportion of diagnosed TB cases that are on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-the-population-that-have-previously-been-vaccinated">Parameter: Initialization proportion of the population that have previously been vaccinated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-the-population-that-have-previously-been-infected-with-tb">Parameter: Initialization proportion of the population that have previously been infected with TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-active-infections-proportion-of-population-that-are-sp">Parameter: New active infections: proportion of population that are SP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-active-infections-proportion-of-population-that-are-sn">Parameter: New active infections: proportion of population that are SN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-sp-infections-proportion-of-population-that-are-sp-ds">Parameter: New SP infections: proportion of population that are SP-DS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-sp-infections-proportion-of-population-that-are-sp-mdr">Parameter: New SP infections: proportion of population that are SP-MDR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-sp-infections-proportion-of-population-that-are-sp-xdr">Parameter: New SP infections: proportion of population that are SP-XDR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-sn-infections-proportion-of-population-that-are-sn-ds">Parameter: New SN infections: proportion of population that are SN-DS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-sn-infections-proportion-of-population-that-are-sn-mdr">Parameter: New SN infections: proportion of population that are SN-MDR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-sn-infections-proportion-of-population-that-are-sn-xdr">Parameter: New SN infections: proportion of population that are SN-XDR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-infection-vulnerability-factor-relative-population-susceptibility">Parameter: Infection vulnerability factor (relative population susceptibility)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-infection-vulnerability-factor-vaccinated-versus-susceptible">Parameter: Infection vulnerability factor (vaccinated versus susceptible)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-infection-vulnerability-factor-recovered-versus-susceptible">Parameter: Infection vulnerability factor (recovered versus susceptible)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-infectiousness">Parameter: SP-DS infectiousness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-relative-infectiousness-sn-versus-sp">Parameter: Relative infectiousness (SN versus SP)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-relative-infectiousness-mdr-versus-ds">Parameter: Relative infectiousness (MDR versus DS)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-relative-infectiousness-xdr-versus-ds">Parameter: Relative infectiousness (XDR versus DS)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-early-latent-untreated-diagnosable">Parameter: Initialization proportion: Early latent untreated (diagnosable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-early-latent-on-treatment">Parameter: Initialization proportion: Early latent on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-late-latent-untreated-diagnosable">Parameter: Initialization proportion: Late latent untreated (diagnosable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-late-latent-on-treatment">Parameter: Initialization proportion: Late latent on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-early-latent-untreated-diagnosis-restricted">Parameter: Initialization proportion: Early latent untreated (diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-late-latent-untreated-diagnosis-restricted">Parameter: Initialization proportion: Late latent untreated (diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-ds-undiagnosed">Parameter: Initialization proportion: SP-DS undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-ds-diagnosed-but-not-on-treatment">Parameter: Initialization proportion: SP-DS diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-ds-on-treatment">Parameter: Initialization proportion: SP-DS on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-mdr-undiagnosed">Parameter: Initialization proportion: SP-MDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-mdr-diagnosed-but-not-on-treatment">Parameter: Initialization proportion: SP-MDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-mdr-on-treatment">Parameter: Initialization proportion: SP-MDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-xdr-undiagnosed">Parameter: Initialization proportion: SP-XDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-xdr-diagnosed-but-not-on-treatment">Parameter: Initialization proportion: SP-XDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-xdr-on-treatment">Parameter: Initialization proportion: SP-XDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-ds-undiagnosed">Parameter: Initialization proportion: SN-DS undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-ds-diagnosed-but-not-on-treatment">Parameter: Initialization proportion: SN-DS diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-ds-on-treatment">Parameter: Initialization proportion: SN-DS on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-mdr-undiagnosed">Parameter: Initialization proportion: SN-MDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-mdr-diagnosed-but-not-on-treatment">Parameter: Initialization proportion: SN-MDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-mdr-on-treatment">Parameter: Initialization proportion: SN-MDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-xdr-undiagnosed">Parameter: Initialization proportion: SN-XDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-xdr-diagnosed-but-not-on-treatment">Parameter: Initialization proportion: SN-XDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-xdr-on-treatment">Parameter: Initialization proportion: SN-XDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-completed-treatment-active">Parameter: Initialization proportion: Completed treatment (active)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-vaccinated">Parameter: Initialization proportion: Vaccinated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-susceptible">Parameter: Initialization proportion: Susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-susceptible-diagnosis-restricted">Parameter: Initialization proportion: Susceptible (diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-number-of-births">Parameter: Number of births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-non-tb-deaths">Parameter: Non-TB deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-number-of-new-immigrants">Parameter: Number of new immigrants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-number-of-departing-emigrants">Parameter: Number of departing emigrants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-number-of-vaccinations-administered">Parameter: Number of vaccinations administered</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-treatment-initiations-through-mass-screening">Parameter: LTBI treatment initiations through mass screening</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-treatment-initiations-through-contact-tracing">Parameter: LTBI treatment initiations through contact tracing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-treatment-average-duration-of-full-course">Parameter: LTBI treatment average duration of full course</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-treatment-proportion-of-lost-to-follow-up">Parameter: LTBI treatment proportion of lost to follow up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-treatment-proportion-of-successful-completions">Parameter: LTBI treatment proportion of successful completions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-treatment-average-duration-until-outcome">Parameter: LTBI treatment average duration until outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-ltbi-annual-number-initiating-treatment">Parameter: Early-LTBI annual number initiating treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-ltbi-diagnosis-restricted-annual-number-initiating-treatment">Parameter: Early-LTBI (diagnosis restricted) annual number initiating treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-late-ltbi-annual-number-initiating-treatment">Parameter: Late-LTBI annual number initiating treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-ltbi-treatment-abandonment-rate">Parameter: Early-LTBI treatment abandonment rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-ltbi-treatment-success-rate">Parameter: Early-LTBI treatment success rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-late-ltbi-treatment-abandonment-rate">Parameter: Late-LTBI treatment abandonment rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-late-ltbi-treatment-success-rate">Parameter: Late-LTBI treatment success rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-latency-departure-rate">Parameter: Early latency departure rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-late-latency-departure-rate">Parameter: Late latency departure rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-probability-of-early-active-versus-early-late-progression">Parameter: Probability of early-active versus early-late progression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-late-ltbi-progression-rate-diagnosable">Parameter: Early-late LTBI progression rate (diagnosable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-late-ltbi-progression-rate-diagnosis-restricted">Parameter: Early-late LTBI progression rate (diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-active-progression-rate-early-diagnosable">Parameter: LTBI-active progression rate (early diagnosable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-active-progression-rate-early-diagnosis-restricted">Parameter: LTBI-active progression rate (early diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-active-progression-rate-late-diagnosable">Parameter: LTBI-active progression rate (late diagnosable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-active-progression-rate-late-diagnosis-restricted">Parameter: LTBI-active progression rate (late diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-infectiousness">Parameter: SP-MDR infectiousness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-infectiousness">Parameter: SP-XDR infectiousness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-infectiousness">Parameter: SN-DS infectiousness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-infectiousness">Parameter: SN-MDR infectiousness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-infectiousness">Parameter: SN-XDR infectiousness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-force-of-infection-from-sp-prevalence">Parameter: Force of infection from SP prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-force-of-infection-from-sn-prevalence">Parameter: Force of infection from SN prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-force-of-infection-imparted-by-population">Parameter: Force of infection imparted by population</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-force-of-infection-experienced-by-population">Parameter: Force of infection experienced by population</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-infection-rate-susceptible-to-diagnosable-latent">Parameter: Infection rate (susceptible to diagnosable latent)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-infection-rate-vaccinated-to-diagnosis-restricted-latent">Parameter: Infection rate (vaccinated to diagnosis restricted latent)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-reinfection-rate-susceptible-to-diagnosis-restricted-for-diagnosis-restricted">Parameter: Reinfection rate (susceptible to diagnosis restricted for diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-relapse-rate-for-completed-treatment-active-cases">Parameter: Relapse rate for completed treatment (active) cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-full-recovery-rate-for-completed-treatment-active-cases">Parameter: Full recovery rate for completed treatment (active) cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-proportion-of-new-immigrants-with-ltbi">Parameter: Proportion of new immigrants with LTBI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-latent-proportion-of-new-immigrants">Parameter: Early latent proportion of new immigrants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-late-latent-proportion-of-new-immigrants">Parameter: Late latent proportion of new immigrants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-proportion-of-new-immigrants-with-active-tb-infections">Parameter: Proportion of new immigrants with active TB infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-susceptible-proportion-of-immigrants">Parameter: Susceptible proportion of immigrants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-diagnosis-notifications">Parameter: SP-DS diagnosis notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-diagnosis-notifications">Parameter: SP-MDR diagnosis notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-diagnosis-notifications">Parameter: SP-XDR diagnosis notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-diagnosis-notifications">Parameter: SN-DS diagnosis notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-diagnosis-notifications">Parameter: SN-MDR diagnosis notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-diagnosis-notifications">Parameter: SN-XDR diagnosis notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-number-of-initiations">Parameter: DS treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-treatment-number-of-initiations">Parameter: SP-DS treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-treatment-number-of-initiations">Parameter: SN-DS treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-average-duration-of-completed-treatment">Parameter: DS treatment average duration of completed treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: DS treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: DS treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-proportion-failed-escalation-to-mdr-require-re-diagnosis">Parameter: DS treatment proportion failed (escalation to MDR, require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-proportion-of-treatments-completed-success">Parameter: DS treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-proportion-of-deaths">Parameter: DS treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-average-duration-until-outcome">Parameter: DS treatment average duration until outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: SP-DS treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: SP-DS treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-treatment-proportion-failed-escalation-to-mdr-require-re-diagnosis">Parameter: SP-DS treatment proportion failed (escalation to MDR, require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-treatment-proportion-of-treatments-completed-success">Parameter: SP-DS treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-treatment-proportion-of-deaths">Parameter: SP-DS treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: SN-DS treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: SN-DS treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-treatment-proportion-failed-escalation-to-mdr-require-re-diagnosis">Parameter: SN-DS treatment proportion failed (escalation to MDR, require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-treatment-proportion-of-treatments-completed-success">Parameter: SN-DS treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-treatment-proportion-of-deaths">Parameter: SN-DS treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-number-of-initiations">Parameter: MDR treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-treatment-number-of-initiations">Parameter: SP-MDR treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-treatment-number-of-initiations">Parameter: SN-MDR treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-average-duration-of-completed-treatment">Parameter: MDR treatment average duration of completed treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: MDR treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: MDR treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-proportion-failed-escalation-to-xdr-require-re-diagnosis">Parameter: MDR treatment proportion failed (escalation to XDR, require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-proportion-of-treatments-completed-success">Parameter: MDR treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-proportion-of-deaths">Parameter: MDR treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-average-duration-until-outcome">Parameter: MDR treatment average duration until outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: SP-MDR treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: SP-MDR treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-treatment-proportion-failed-escalation-to-xdr-require-re-diagnosis">Parameter: SP-MDR treatment proportion failed (escalation to XDR, require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-treatment-proportion-of-treatments-completed-success">Parameter: SP-MDR treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-treatment-proportion-of-deaths">Parameter: SP-MDR treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: SN-MDR treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: SN-MDR treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-treatment-proportion-failed-escalation-to-xdr-require-re-diagnosis">Parameter: SN-MDR treatment proportion failed (escalation to XDR, require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-treatment-proportion-of-treatments-completed-success">Parameter: SN-MDR treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-treatment-proportion-of-deaths">Parameter: SN-MDR treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-xdr-treatment-number-of-initiations">Parameter: XDR treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-treatment-number-of-initiations">Parameter: SP-XDR treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-treatment-number-of-initiations">Parameter: SN-XDR treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-xdr-treatment-average-duration-of-completed-treatment">Parameter: XDR treatment average duration of completed treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-xdr-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: XDR treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-xdr-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: XDR treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-xdr-treatment-proportion-of-treatments-completed-success">Parameter: XDR treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-xdr-treatment-proportion-of-deaths">Parameter: XDR treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-xdr-treatment-average-duration-until-outcome">Parameter: XDR treatment average duration until outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: SP-XDR treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: SP-XDR treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-treatment-proportion-of-treatments-completed-success">Parameter: SP-XDR treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-treatment-proportion-of-deaths">Parameter: SP-XDR treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: SN-XDR treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: SN-XDR treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-treatment-proportion-of-treatments-completed-success">Parameter: SN-XDR treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-treatment-proportion-of-deaths">Parameter: SN-XDR treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-natural-recovery-rate">Parameter: SP-DS natural recovery rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-natural-recovery-rate">Parameter: SP-MDR natural recovery rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-natural-recovery-rate">Parameter: SP-XDR natural recovery rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-natural-recovery-rate">Parameter: SN-DS natural recovery rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-natural-recovery-rate">Parameter: SN-MDR natural recovery rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-natural-recovery-rate">Parameter: SN-XDR natural recovery rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-death-rate-untreated">Parameter: SP-DS death rate (untreated)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-death-rate-untreated">Parameter: SP-MDR death rate (untreated)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-death-rate-untreated">Parameter: SP-XDR death rate (untreated)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-death-rate-untreated">Parameter: SN-DS death rate (untreated)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-death-rate-untreated">Parameter: SN-MDR death rate (untreated)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-death-rate-untreated">Parameter: SN-XDR death rate (untreated)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-disutility-weight-for-active-tb">Parameter: Disutility weight for active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-yld-rate">Parameter: YLD rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-estimated-number-of-years-of-life-remaining">Parameter: Estimated number of years of life remaining</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-yll-rate">Parameter: YLL rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-dalys">Parameter: DALYs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb.html#interactions">Interactions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#interaction-preference-weighting-for-one-population-interacting-with-another">Interaction: Preference weighting for one population interacting with another</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb.html#plots">Plots</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-population-size">Plot: Population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-latent-infections">Plot: Latent infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-active-tb">Plot: Active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-active-ds-tb">Plot: Active DS-TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-active-mdr-tb">Plot: Active MDR-TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-active-xdr-tb">Plot: Active XDR-TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-tb-infections">Plot: New active TB infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-activated-tb-infections-inc-relapse-and-immigration">Plot: Activated TB infections inc. relapse and immigration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-smear-negative-active-tb">Plot: Smear negative active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-smear-positive-active-tb">Plot: Smear positive active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-latent-diagnoses">Plot: Latent diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-tb-diagnoses">Plot: New active TB diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-latent-treatment">Plot: Latent treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-active-treatment">Plot: Active treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-tb-related-deaths">Plot: TB-related deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-latent-prevalence">Plot: Latent prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-active-prevalence">Plot: Active prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-dr-prevalence">Plot: DR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-sp-ds-diagnoses">Plot: New active SP-DS diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-sp-mdr-diagnoses">Plot: New active SP-MDR diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-sp-xdr-diagnoses">Plot: New active SP-XDR diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-sn-ds-diagnoses">Plot: New active SN-DS diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-sn-mdr-diagnoses">Plot: New active SN-MDR diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-sn-xdr-diagnoses">Plot: New active SN-XDR diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-ds-number-initiating-treatment">Plot: DS number initiating treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-mdr-number-initiating-treatment">Plot: MDR number initiating treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-xdr-number-initiating-treatment">Plot: XDR number initiating treatment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#cascade-tb-treatment-including-recovered">Cascade: TB treatment (including recovered)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#cascade-sp-treatment">Cascade: SP treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#cascade-sn-treatment">Cascade: SN treatment</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/tb_simple.html">TB simple model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#compartment-notified-and-treated">Compartment: Notified and treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#compartment-lost-to-follow-up">Compartment: Lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#compartment-successfully-treated-comp">Compartment: Successfully treated (comp)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#characteristic-tb-burden">Characteristic: TB burden</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#characteristic-notified">Characteristic: Notified</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#characteristic-in-care">Characteristic: In care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#characteristic-treated">Characteristic: Treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#characteristic-successfully-treated">Characteristic: Successfully treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-annual-number-of-tests-done">Parameter: Annual number of tests done</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-test-yield">Parameter: Test yield</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-annual-number-tested-positive">Parameter: Annual number tested positive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-test-sensitivity">Parameter: Test sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-time-after-initiating-treatment-to-treatment-success-years">Parameter: Time after initiating treatment to treatment success (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-treatment-failure-rate">Parameter: Treatment failure rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#cascade-tb-care-cascade">Cascade: TB care cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/tb_simple_dyn.html">TB simple with dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple_dyn.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-source">Compartment: Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-susceptible">Compartment: Susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-vaccinated">Compartment: Vaccinated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-notified-and-treated">Compartment: Notified and treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-lost-to-follow-up">Compartment: Lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-successfully-treated-comp">Compartment: Successfully treated (comp)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-dead-tb">Compartment: Dead (TB)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-dead-other">Compartment: Dead (other)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple_dyn.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#characteristic-population-size">Characteristic: Population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#characteristic-tb-burden">Characteristic: TB burden</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#characteristic-notified">Characteristic: Notified</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#characteristic-in-care">Characteristic: In care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#characteristic-treated">Characteristic: Treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#characteristic-successfully-treated">Characteristic: Successfully treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-annual-number-of-births">Parameter: Annual number of births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-estimated-number-of-new-tb-cases-annually">Parameter: Estimated number of new TB cases annually</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-acquisition-rate">Parameter: Acquisition rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-natural-recovery-rate">Parameter: Natural recovery rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-annual-number-vaccinated">Parameter: Annual number vaccinated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-vaccination-rate">Parameter: Vaccination rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-annual-number-of-tests-done">Parameter: Annual number of tests done</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-test-yield">Parameter: Test yield</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-annual-number-tested-positive">Parameter: Annual number tested positive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-test-sensitivity">Parameter: Test sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-time-after-initiating-treatment-to-treatment-success-years">Parameter: Time after initiating treatment to treatment success (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-treatment-failure-rate">Parameter: Treatment failure rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-death-rate-for-those-with-untreated-tb">Parameter: Death rate for those with untreated TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-death-rate-for-those-unsuccessfully-treated">Parameter: Death rate for those unsuccessfully treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-death-rate-for-those-successfully-treated">Parameter: Death rate for those successfully treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-background-mortality-rate">Parameter: Background mortality rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple_dyn.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple_dyn.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#cascade-tb-care-cascade">Cascade: TB care cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/udt.html">UDT model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#compartment-treated">Compartment: Treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#characteristic-all-people-with-condition">Characteristic: All people with condition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#characteristic-diagnosed-people">Characteristic: Diagnosed people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#parameter-diagnosis-rate">Parameter: Diagnosis rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#parameter-annual-number-lost-to-follow-up">Parameter: Annual number lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#cascade-cascade">Cascade: Cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/udt_dyn.html">UDT model with dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt_dyn.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt_dyn.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#compartment-births">Compartment: Births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#compartment-treated">Compartment: Treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#compartment-dead">Compartment: dead</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt_dyn.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#characteristic-all-people-with-condition">Characteristic: All people with condition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#characteristic-diagnosed-people">Characteristic: Diagnosed people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt_dyn.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-diagnosis-rate">Parameter: Diagnosis rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-annual-number-lost-to-follow-up">Parameter: Annual number lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-birth-rate">Parameter: Birth rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-untreated-death-rate">Parameter: Untreated death rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-treated-death-rate">Parameter: Treated death rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt_dyn.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt_dyn.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#cascade-cascade">Cascade: Cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/usdt.html">USDT model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/usdt.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/usdt.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#compartment-screened">Compartment: Screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#compartment-treated">Compartment: Treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/usdt.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#characteristic-all-people-with-condition">Characteristic: All people with condition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#characteristic-screened-people">Characteristic: Screened people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#characteristic-diagnosed-people">Characteristic: Diagnosed people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/usdt.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-annual-number-screened">Parameter: Annual number screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-screening-rate">Parameter: Screening rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-diagnosis-rate">Parameter: Diagnosis rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-annual-number-lost-to-follow-up">Parameter: Annual number lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/usdt.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/usdt.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#cascade-main">Cascade: main</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/atomica.html">atomica</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.calibration.html">atomica.calibration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.calibration.calibrate.html">atomica.calibration.calibrate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.calibration.calibrate.html#atomica.calibration.calibrate"><code class="docutils literal notranslate"><span class="pre">calibrate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.cascade.html">atomica.cascade</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.cascade_summary.html">atomica.cascade.cascade_summary</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.cascade_summary.html#atomica.cascade.cascade_summary"><code class="docutils literal notranslate"><span class="pre">cascade_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.get_cascade_data.html">atomica.cascade.get_cascade_data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.get_cascade_data.html#atomica.cascade.get_cascade_data"><code class="docutils literal notranslate"><span class="pre">get_cascade_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.get_cascade_vals.html">atomica.cascade.get_cascade_vals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.get_cascade_vals.html#atomica.cascade.get_cascade_vals"><code class="docutils literal notranslate"><span class="pre">get_cascade_vals()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_cascade.html">atomica.cascade.plot_cascade</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_cascade.html#atomica.cascade.plot_cascade"><code class="docutils literal notranslate"><span class="pre">plot_cascade()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_multi_cascade.html">atomica.cascade.plot_multi_cascade</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_multi_cascade.html#atomica.cascade.plot_multi_cascade"><code class="docutils literal notranslate"><span class="pre">plot_multi_cascade()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_single_cascade.html">atomica.cascade.plot_single_cascade</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_single_cascade.html#atomica.cascade.plot_single_cascade"><code class="docutils literal notranslate"><span class="pre">plot_single_cascade()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_single_cascade_series.html">atomica.cascade.plot_single_cascade_series</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_single_cascade_series.html#atomica.cascade.plot_single_cascade_series"><code class="docutils literal notranslate"><span class="pre">plot_single_cascade_series()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.sanitize_cascade.html">atomica.cascade.sanitize_cascade</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.sanitize_cascade.html#atomica.cascade.sanitize_cascade"><code class="docutils literal notranslate"><span class="pre">sanitize_cascade()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.sanitize_pops.html">atomica.cascade.sanitize_pops</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.sanitize_pops.html#atomica.cascade.sanitize_pops"><code class="docutils literal notranslate"><span class="pre">sanitize_pops()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.validate_cascade.html">atomica.cascade.validate_cascade</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.validate_cascade.html#atomica.cascade.validate_cascade"><code class="docutils literal notranslate"><span class="pre">validate_cascade()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html">atomica.cascade.CascadeEnsemble</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.add"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.add()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.baseline"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.baseline</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.boxplot"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.boxplot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.get_vals"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.get_vals()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.mapping_function"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.mapping_function</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.n_samples"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.n_samples</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.outputs"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.outputs</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.plot_bars"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.plot_bars()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.plot_distribution"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.plot_distribution()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.plot_multi_cascade"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.plot_multi_cascade()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.plot_series"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.plot_series()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.pops"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.pops</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.results"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.results</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.run_sims"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.run_sims()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.samples"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.samples</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.set_baseline"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.set_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.tvec"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.tvec</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.update"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.InvalidCascade.html">atomica.cascade.InvalidCascade</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.InvalidCascade.html#atomica.cascade.InvalidCascade"><code class="docutils literal notranslate"><span class="pre">InvalidCascade</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.data.html">atomica.data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html">atomica.data.ProjectData</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData"><code class="docutils literal notranslate"><span class="pre">ProjectData</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.add_interaction"><code class="docutils literal notranslate"><span class="pre">ProjectData.add_interaction()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.add_pop"><code class="docutils literal notranslate"><span class="pre">ProjectData.add_pop()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.add_transfer"><code class="docutils literal notranslate"><span class="pre">ProjectData.add_transfer()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.change_tvec"><code class="docutils literal notranslate"><span class="pre">ProjectData.change_tvec()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.end_year"><code class="docutils literal notranslate"><span class="pre">ProjectData.end_year</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.from_spreadsheet"><code class="docutils literal notranslate"><span class="pre">ProjectData.from_spreadsheet()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.get_tdve_page"><code class="docutils literal notranslate"><span class="pre">ProjectData.get_tdve_page()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.get_ts"><code class="docutils literal notranslate"><span class="pre">ProjectData.get_ts()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.interpops"><code class="docutils literal notranslate"><span class="pre">ProjectData.interpops</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.new"><code class="docutils literal notranslate"><span class="pre">ProjectData.new()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.pops"><code class="docutils literal notranslate"><span class="pre">ProjectData.pops</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.remove_interaction"><code class="docutils literal notranslate"><span class="pre">ProjectData.remove_interaction()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.remove_transfer"><code class="docutils literal notranslate"><span class="pre">ProjectData.remove_transfer()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.rename_pop"><code class="docutils literal notranslate"><span class="pre">ProjectData.rename_pop()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.rename_transfer"><code class="docutils literal notranslate"><span class="pre">ProjectData.rename_transfer()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.save"><code class="docutils literal notranslate"><span class="pre">ProjectData.save()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.start_year"><code class="docutils literal notranslate"><span class="pre">ProjectData.start_year</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.tables"><code class="docutils literal notranslate"><span class="pre">ProjectData.tables()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.tdve"><code class="docutils literal notranslate"><span class="pre">ProjectData.tdve</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.tdve_pages"><code class="docutils literal notranslate"><span class="pre">ProjectData.tdve_pages</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.to_spreadsheet"><code class="docutils literal notranslate"><span class="pre">ProjectData.to_spreadsheet()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.to_workbook"><code class="docutils literal notranslate"><span class="pre">ProjectData.to_workbook()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.transfers"><code class="docutils literal notranslate"><span class="pre">ProjectData.transfers</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.tvec"><code class="docutils literal notranslate"><span class="pre">ProjectData.tvec</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.validate"><code class="docutils literal notranslate"><span class="pre">ProjectData.validate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.data.InvalidDatabook.html">atomica.data.InvalidDatabook</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.data.InvalidDatabook.html#atomica.data.InvalidDatabook"><code class="docutils literal notranslate"><span class="pre">InvalidDatabook</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.demos.html">atomica.demos</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.demos.demo.html">atomica.demos.demo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.demos.demo.html#atomica.demos.demo"><code class="docutils literal notranslate"><span class="pre">demo()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.demos.make_demo_scenarios.html">atomica.demos.make_demo_scenarios</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.demos.make_demo_scenarios.html#atomica.demos.make_demo_scenarios"><code class="docutils literal notranslate"><span class="pre">make_demo_scenarios()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.excel.html">atomica.excel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.apply_widths.html">atomica.excel.apply_widths</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.apply_widths.html#atomica.excel.apply_widths"><code class="docutils literal notranslate"><span class="pre">apply_widths()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.cell_get_number.html">atomica.excel.cell_get_number</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.cell_get_number.html#atomica.excel.cell_get_number"><code class="docutils literal notranslate"><span class="pre">cell_get_number()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.cell_get_string.html">atomica.excel.cell_get_string</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.cell_get_string.html#atomica.excel.cell_get_string"><code class="docutils literal notranslate"><span class="pre">cell_get_string()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.copy_sheet.html">atomica.excel.copy_sheet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.copy_sheet.html#atomica.excel.copy_sheet"><code class="docutils literal notranslate"><span class="pre">copy_sheet()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.read_dataframes.html">atomica.excel.read_dataframes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.read_dataframes.html#atomica.excel.read_dataframes"><code class="docutils literal notranslate"><span class="pre">read_dataframes()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.read_tables.html">atomica.excel.read_tables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.read_tables.html#atomica.excel.read_tables"><code class="docutils literal notranslate"><span class="pre">read_tables()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.standard_formats.html">atomica.excel.standard_formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.standard_formats.html#atomica.excel.standard_formats"><code class="docutils literal notranslate"><span class="pre">standard_formats()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.transfer_comments.html">atomica.excel.transfer_comments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.transfer_comments.html#atomica.excel.transfer_comments"><code class="docutils literal notranslate"><span class="pre">transfer_comments()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.update_widths.html">atomica.excel.update_widths</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.update_widths.html#atomica.excel.update_widths"><code class="docutils literal notranslate"><span class="pre">update_widths()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.validate_category.html">atomica.excel.validate_category</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.validate_category.html#atomica.excel.validate_category"><code class="docutils literal notranslate"><span class="pre">validate_category()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html">atomica.excel.TimeDependentConnections</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.assumption_heading"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.assumption_heading</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.attributes"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.attributes</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.from_tables"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.from_tables()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.ts_attributes"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.ts_attributes</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.write"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.write()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.write_assumption"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.write_assumption</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.write_uncertainty"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.write_uncertainty</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.write_units"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.write_units</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html">atomica.excel.TimeDependentValuesEntry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.assumption_heading"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.assumption_heading</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.comment"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.comment</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.from_rows"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.from_rows()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.has_data"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.has_data</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.name"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.ts_attributes"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.ts_attributes</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.tvec"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.tvec</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.write"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.write()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.write_assumption"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.write_assumption</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.write_uncertainty"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.write_uncertainty</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.write_units"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.write_units</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.framework.html">atomica.framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.framework.generate_framework_doc.html">atomica.framework.generate_framework_doc</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.framework.generate_framework_doc.html#atomica.framework.generate_framework_doc"><code class="docutils literal notranslate"><span class="pre">generate_framework_doc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html">atomica.framework.ProjectFramework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework"><code class="docutils literal notranslate"><span class="pre">ProjectFramework</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.cascades"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.cascades</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.characs"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.characs</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.comps"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.comps</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.created"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.created</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_charac"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_charac()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_charac_includes"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_charac_includes()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_comp"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_comp()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_databook_units"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_databook_units()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_interaction"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_interaction()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_label"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_label()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_par"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_par()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_variable"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_variable()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.gitinfo"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.gitinfo</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.interactions"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.interactions</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.modified"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.modified</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.name"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.pars"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.pars</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.pop_types"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.pop_types</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.save"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.save()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.sheets"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.sheets</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.spreadsheet"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.spreadsheet</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.to_spreadsheet"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.to_spreadsheet()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.uid"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.uid</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.version"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.version</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.framework.InvalidFramework.html">atomica.framework.InvalidFramework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.framework.InvalidFramework.html#atomica.framework.InvalidFramework"><code class="docutils literal notranslate"><span class="pre">InvalidFramework</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.function_parser.html">atomica.function_parser</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.function_parser.parse_function.html">atomica.function_parser.parse_function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.function_parser.parse_function.html#atomica.function_parser.parse_function"><code class="docutils literal notranslate"><span class="pre">parse_function()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.function_parser.sdiv.html">atomica.function_parser.sdiv</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.function_parser.sdiv.html#atomica.function_parser.sdiv"><code class="docutils literal notranslate"><span class="pre">sdiv()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.function_parser.vector_max.html">atomica.function_parser.vector_max</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.function_parser.vector_max.html#atomica.function_parser.vector_max"><code class="docutils literal notranslate"><span class="pre">vector_max()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.function_parser.vector_min.html">atomica.function_parser.vector_min</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.function_parser.vector_min.html#atomica.function_parser.vector_min"><code class="docutils literal notranslate"><span class="pre">vector_min()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.migration.html">atomica.migration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.migration.all_frameworks.html">atomica.migration.all_frameworks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.migration.all_frameworks.html#atomica.migration.all_frameworks"><code class="docutils literal notranslate"><span class="pre">all_frameworks()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.migration.all_progsets.html">atomica.migration.all_progsets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.migration.all_progsets.html#atomica.migration.all_progsets"><code class="docutils literal notranslate"><span class="pre">all_progsets()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.migration.all_results.html">atomica.migration.all_results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.migration.all_results.html#atomica.migration.all_results"><code class="docutils literal notranslate"><span class="pre">all_results()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.migration.migrate.html">atomica.migration.migrate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.migration.migrate.html#atomica.migration.migrate"><code class="docutils literal notranslate"><span class="pre">migrate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.migration.migration.html">atomica.migration.migration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.migration.migration.html#atomica.migration.migration"><code class="docutils literal notranslate"><span class="pre">migration()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.migration.register_migration.html">atomica.migration.register_migration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.migration.register_migration.html#atomica.migration.register_migration"><code class="docutils literal notranslate"><span class="pre">register_migration()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.migration.Migration.html">atomica.migration.Migration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.migration.Migration.html#atomica.migration.Migration"><code class="docutils literal notranslate"><span class="pre">Migration</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.model.html">atomica.model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.run_model.html">atomica.model.run_model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.run_model.html#atomica.model.run_model"><code class="docutils literal notranslate"><span class="pre">run_model()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html">atomica.model.Characteristic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic"><code class="docutils literal notranslate"><span class="pre">Characteristic</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.id"><code class="docutils literal notranslate"><span class="pre">Characteristic.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.name"><code class="docutils literal notranslate"><span class="pre">Characteristic.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.plot"><code class="docutils literal notranslate"><span class="pre">Characteristic.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.pop"><code class="docutils literal notranslate"><span class="pre">Characteristic.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.preallocate"><code class="docutils literal notranslate"><span class="pre">Characteristic.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.set_dynamic"><code class="docutils literal notranslate"><span class="pre">Characteristic.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.units"><code class="docutils literal notranslate"><span class="pre">Characteristic.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.update"><code class="docutils literal notranslate"><span class="pre">Characteristic.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html">atomica.model.Compartment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment"><code class="docutils literal notranslate"><span class="pre">Compartment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.connect"><code class="docutils literal notranslate"><span class="pre">Compartment.connect()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.id"><code class="docutils literal notranslate"><span class="pre">Compartment.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.name"><code class="docutils literal notranslate"><span class="pre">Compartment.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.outflow"><code class="docutils literal notranslate"><span class="pre">Compartment.outflow</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.plot"><code class="docutils literal notranslate"><span class="pre">Compartment.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.pop"><code class="docutils literal notranslate"><span class="pre">Compartment.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.preallocate"><code class="docutils literal notranslate"><span class="pre">Compartment.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.resolve_outflows"><code class="docutils literal notranslate"><span class="pre">Compartment.resolve_outflows()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.set_dynamic"><code class="docutils literal notranslate"><span class="pre">Compartment.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.units"><code class="docutils literal notranslate"><span class="pre">Compartment.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.update"><code class="docutils literal notranslate"><span class="pre">Compartment.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html">atomica.model.JunctionCompartment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.balance"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.balance()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.connect"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.connect()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.duration_group"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.duration_group</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.id"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.initial_flush"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.initial_flush()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.name"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.outflow"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.outflow</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.plot"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.pop"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.preallocate"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.resolve_outflows"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.resolve_outflows()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.set_dynamic"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.units"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.update"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html">atomica.model.Link</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link"><code class="docutils literal notranslate"><span class="pre">Link</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.create"><code class="docutils literal notranslate"><span class="pre">Link.create()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.id"><code class="docutils literal notranslate"><span class="pre">Link.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.name"><code class="docutils literal notranslate"><span class="pre">Link.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.plot"><code class="docutils literal notranslate"><span class="pre">Link.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.pop"><code class="docutils literal notranslate"><span class="pre">Link.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.preallocate"><code class="docutils literal notranslate"><span class="pre">Link.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.set_dynamic"><code class="docutils literal notranslate"><span class="pre">Link.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.units"><code class="docutils literal notranslate"><span class="pre">Link.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.update"><code class="docutils literal notranslate"><span class="pre">Link.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html">atomica.model.Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model"><code class="docutils literal notranslate"><span class="pre">Model</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.build"><code class="docutils literal notranslate"><span class="pre">Model.build()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.dt"><code class="docutils literal notranslate"><span class="pre">Model.dt</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.flush_junctions"><code class="docutils literal notranslate"><span class="pre">Model.flush_junctions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.get_pop"><code class="docutils literal notranslate"><span class="pre">Model.get_pop()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.process"><code class="docutils literal notranslate"><span class="pre">Model.process()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.relink"><code class="docutils literal notranslate"><span class="pre">Model.relink()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.t"><code class="docutils literal notranslate"><span class="pre">Model.t</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.unlink"><code class="docutils literal notranslate"><span class="pre">Model.unlink()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.update_comps"><code class="docutils literal notranslate"><span class="pre">Model.update_comps()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.update_links"><code class="docutils literal notranslate"><span class="pre">Model.update_links()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.update_pars"><code class="docutils literal notranslate"><span class="pre">Model.update_pars()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html">atomica.model.Parameter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter"><code class="docutils literal notranslate"><span class="pre">Parameter</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.constrain"><code class="docutils literal notranslate"><span class="pre">Parameter.constrain()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.deps"><code class="docutils literal notranslate"><span class="pre">Parameter.deps</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.derivative"><code class="docutils literal notranslate"><span class="pre">Parameter.derivative</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.fcn_str"><code class="docutils literal notranslate"><span class="pre">Parameter.fcn_str</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.id"><code class="docutils literal notranslate"><span class="pre">Parameter.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.limits"><code class="docutils literal notranslate"><span class="pre">Parameter.limits</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.links"><code class="docutils literal notranslate"><span class="pre">Parameter.links</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.name"><code class="docutils literal notranslate"><span class="pre">Parameter.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.plot"><code class="docutils literal notranslate"><span class="pre">Parameter.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.pop"><code class="docutils literal notranslate"><span class="pre">Parameter.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.pop_aggregation"><code class="docutils literal notranslate"><span class="pre">Parameter.pop_aggregation</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.preallocate"><code class="docutils literal notranslate"><span class="pre">Parameter.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.scale_factor"><code class="docutils literal notranslate"><span class="pre">Parameter.scale_factor</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.set_dynamic"><code class="docutils literal notranslate"><span class="pre">Parameter.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.set_fcn"><code class="docutils literal notranslate"><span class="pre">Parameter.set_fcn()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.skip_function"><code class="docutils literal notranslate"><span class="pre">Parameter.skip_function</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.timescale"><code class="docutils literal notranslate"><span class="pre">Parameter.timescale</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.units"><code class="docutils literal notranslate"><span class="pre">Parameter.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.update"><code class="docutils literal notranslate"><span class="pre">Parameter.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html">atomica.model.Population</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population"><code class="docutils literal notranslate"><span class="pre">Population</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.build"><code class="docutils literal notranslate"><span class="pre">Population.build()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.charac_lookup"><code class="docutils literal notranslate"><span class="pre">Population.charac_lookup</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.characs"><code class="docutils literal notranslate"><span class="pre">Population.characs</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.comp_lookup"><code class="docutils literal notranslate"><span class="pre">Population.comp_lookup</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.comps"><code class="docutils literal notranslate"><span class="pre">Population.comps</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.get_charac"><code class="docutils literal notranslate"><span class="pre">Population.get_charac()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.get_comp"><code class="docutils literal notranslate"><span class="pre">Population.get_comp()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.get_links"><code class="docutils literal notranslate"><span class="pre">Population.get_links()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.get_par"><code class="docutils literal notranslate"><span class="pre">Population.get_par()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.get_variable"><code class="docutils literal notranslate"><span class="pre">Population.get_variable()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.initialize_compartments"><code class="docutils literal notranslate"><span class="pre">Population.initialize_compartments()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.label"><code class="docutils literal notranslate"><span class="pre">Population.label</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.link_lookup"><code class="docutils literal notranslate"><span class="pre">Population.link_lookup</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.links"><code class="docutils literal notranslate"><span class="pre">Population.links</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.name"><code class="docutils literal notranslate"><span class="pre">Population.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.par_lookup"><code class="docutils literal notranslate"><span class="pre">Population.par_lookup</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.pars"><code class="docutils literal notranslate"><span class="pre">Population.pars</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.popsize"><code class="docutils literal notranslate"><span class="pre">Population.popsize()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.type"><code class="docutils literal notranslate"><span class="pre">Population.type</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html">atomica.model.ResidualJunctionCompartment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.balance"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.balance()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.connect"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.connect()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.duration_group"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.duration_group</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.id"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.initial_flush"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.initial_flush()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.name"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.outflow"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.outflow</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.plot"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.pop"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.preallocate"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.resolve_outflows"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.resolve_outflows()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.set_dynamic"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.units"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.update"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html">atomica.model.SinkCompartment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment"><code class="docutils literal notranslate"><span class="pre">SinkCompartment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.connect"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.connect()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.id"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.name"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.outflow"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.outflow</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.plot"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.pop"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.preallocate"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.resolve_outflows"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.resolve_outflows()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.set_dynamic"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.units"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.update"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html">atomica.model.SourceCompartment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment"><code class="docutils literal notranslate"><span class="pre">SourceCompartment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.connect"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.connect()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.id"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.name"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.outflow"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.outflow</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.plot"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.pop"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.preallocate"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.resolve_outflows"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.resolve_outflows()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.set_dynamic"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.units"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.update"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html">atomica.model.TimedCompartment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment"><code class="docutils literal notranslate"><span class="pre">TimedCompartment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.connect"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.connect()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.flush_link"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.flush_link</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.id"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.name"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.outflow"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.outflow</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.parameter"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.parameter</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.plot"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.pop"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.preallocate"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.resolve_outflows"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.resolve_outflows()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.set_dynamic"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.units"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.update"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.update()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.vals"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.vals</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html">atomica.model.TimedLink</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink"><code class="docutils literal notranslate"><span class="pre">TimedLink</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.create"><code class="docutils literal notranslate"><span class="pre">TimedLink.create()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.id"><code class="docutils literal notranslate"><span class="pre">TimedLink.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.name"><code class="docutils literal notranslate"><span class="pre">TimedLink.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.plot"><code class="docutils literal notranslate"><span class="pre">TimedLink.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.pop"><code class="docutils literal notranslate"><span class="pre">TimedLink.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.preallocate"><code class="docutils literal notranslate"><span class="pre">TimedLink.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.set_dynamic"><code class="docutils literal notranslate"><span class="pre">TimedLink.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.units"><code class="docutils literal notranslate"><span class="pre">TimedLink.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.update"><code class="docutils literal notranslate"><span class="pre">TimedLink.update()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.vals"><code class="docutils literal notranslate"><span class="pre">TimedLink.vals</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html">atomica.model.Variable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable"><code class="docutils literal notranslate"><span class="pre">Variable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.id"><code class="docutils literal notranslate"><span class="pre">Variable.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.name"><code class="docutils literal notranslate"><span class="pre">Variable.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.plot"><code class="docutils literal notranslate"><span class="pre">Variable.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.pop"><code class="docutils literal notranslate"><span class="pre">Variable.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.preallocate"><code class="docutils literal notranslate"><span class="pre">Variable.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.set_dynamic"><code class="docutils literal notranslate"><span class="pre">Variable.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.units"><code class="docutils literal notranslate"><span class="pre">Variable.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.update"><code class="docutils literal notranslate"><span class="pre">Variable.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.BadInitialization.html">atomica.model.BadInitialization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.BadInitialization.html#atomica.model.BadInitialization"><code class="docutils literal notranslate"><span class="pre">BadInitialization</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.ModelError.html">atomica.model.ModelError</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.ModelError.html#atomica.model.ModelError"><code class="docutils literal notranslate"><span class="pre">ModelError</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.optimization.html">atomica.optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.constrain_sum_bounded.html">atomica.optimization.constrain_sum_bounded</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.constrain_sum_bounded.html#atomica.optimization.constrain_sum_bounded"><code class="docutils literal notranslate"><span class="pre">constrain_sum_bounded()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.optimize.html">atomica.optimization.optimize</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.optimize.html#atomica.optimization.optimize"><code class="docutils literal notranslate"><span class="pre">optimize()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.Adjustable.html">atomica.optimization.Adjustable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.Adjustable.html#atomica.optimization.Adjustable"><code class="docutils literal notranslate"><span class="pre">Adjustable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Adjustable.html#atomica.optimization.Adjustable.get_hard_bounds"><code class="docutils literal notranslate"><span class="pre">Adjustable.get_hard_bounds()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.Adjustment.html">atomica.optimization.Adjustment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.Adjustment.html#atomica.optimization.Adjustment"><code class="docutils literal notranslate"><span class="pre">Adjustment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Adjustment.html#atomica.optimization.Adjustment.adjustables"><code class="docutils literal notranslate"><span class="pre">Adjustment.adjustables</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Adjustment.html#atomica.optimization.Adjustment.get_initialization"><code class="docutils literal notranslate"><span class="pre">Adjustment.get_initialization()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtLeastMeasurable.html">atomica.optimization.AtLeastMeasurable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtLeastMeasurable.html#atomica.optimization.AtLeastMeasurable"><code class="docutils literal notranslate"><span class="pre">AtLeastMeasurable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtLeastMeasurable.html#atomica.optimization.AtLeastMeasurable.get_baseline"><code class="docutils literal notranslate"><span class="pre">AtLeastMeasurable.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtLeastMeasurable.html#atomica.optimization.AtLeastMeasurable.get_objective_val"><code class="docutils literal notranslate"><span class="pre">AtLeastMeasurable.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtMostMeasurable.html">atomica.optimization.AtMostMeasurable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtMostMeasurable.html#atomica.optimization.AtMostMeasurable"><code class="docutils literal notranslate"><span class="pre">AtMostMeasurable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtMostMeasurable.html#atomica.optimization.AtMostMeasurable.get_baseline"><code class="docutils literal notranslate"><span class="pre">AtMostMeasurable.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtMostMeasurable.html#atomica.optimization.AtMostMeasurable.get_objective_val"><code class="docutils literal notranslate"><span class="pre">AtMostMeasurable.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.Constraint.html">atomica.optimization.Constraint</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.Constraint.html#atomica.optimization.Constraint"><code class="docutils literal notranslate"><span class="pre">Constraint</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Constraint.html#atomica.optimization.Constraint.constrain_instructions"><code class="docutils literal notranslate"><span class="pre">Constraint.constrain_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Constraint.html#atomica.optimization.Constraint.get_hard_constraint"><code class="docutils literal notranslate"><span class="pre">Constraint.get_hard_constraint()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.DecreaseByMeasurable.html">atomica.optimization.DecreaseByMeasurable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.DecreaseByMeasurable.html#atomica.optimization.DecreaseByMeasurable"><code class="docutils literal notranslate"><span class="pre">DecreaseByMeasurable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.DecreaseByMeasurable.html#atomica.optimization.DecreaseByMeasurable.get_baseline"><code class="docutils literal notranslate"><span class="pre">DecreaseByMeasurable.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.DecreaseByMeasurable.html#atomica.optimization.DecreaseByMeasurable.get_objective_val"><code class="docutils literal notranslate"><span class="pre">DecreaseByMeasurable.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.ExponentialSpendingAdjustment.html">atomica.optimization.ExponentialSpendingAdjustment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.ExponentialSpendingAdjustment.html#atomica.optimization.ExponentialSpendingAdjustment"><code class="docutils literal notranslate"><span class="pre">ExponentialSpendingAdjustment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.ExponentialSpendingAdjustment.html#atomica.optimization.ExponentialSpendingAdjustment.adjustables"><code class="docutils literal notranslate"><span class="pre">ExponentialSpendingAdjustment.adjustables</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.ExponentialSpendingAdjustment.html#atomica.optimization.ExponentialSpendingAdjustment.get_initialization"><code class="docutils literal notranslate"><span class="pre">ExponentialSpendingAdjustment.get_initialization()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.IncreaseByMeasurable.html">atomica.optimization.IncreaseByMeasurable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.IncreaseByMeasurable.html#atomica.optimization.IncreaseByMeasurable"><code class="docutils literal notranslate"><span class="pre">IncreaseByMeasurable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.IncreaseByMeasurable.html#atomica.optimization.IncreaseByMeasurable.get_baseline"><code class="docutils literal notranslate"><span class="pre">IncreaseByMeasurable.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.IncreaseByMeasurable.html#atomica.optimization.IncreaseByMeasurable.get_objective_val"><code class="docutils literal notranslate"><span class="pre">IncreaseByMeasurable.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeConversionRate.html">atomica.optimization.MaximizeCascadeConversionRate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeConversionRate.html#atomica.optimization.MaximizeCascadeConversionRate"><code class="docutils literal notranslate"><span class="pre">MaximizeCascadeConversionRate</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeConversionRate.html#atomica.optimization.MaximizeCascadeConversionRate.get_baseline"><code class="docutils literal notranslate"><span class="pre">MaximizeCascadeConversionRate.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeConversionRate.html#atomica.optimization.MaximizeCascadeConversionRate.get_objective_val"><code class="docutils literal notranslate"><span class="pre">MaximizeCascadeConversionRate.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeStage.html">atomica.optimization.MaximizeCascadeStage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeStage.html#atomica.optimization.MaximizeCascadeStage"><code class="docutils literal notranslate"><span class="pre">MaximizeCascadeStage</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeStage.html#atomica.optimization.MaximizeCascadeStage.get_baseline"><code class="docutils literal notranslate"><span class="pre">MaximizeCascadeStage.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeStage.html#atomica.optimization.MaximizeCascadeStage.get_objective_val"><code class="docutils literal notranslate"><span class="pre">MaximizeCascadeStage.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeMeasurable.html">atomica.optimization.MaximizeMeasurable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeMeasurable.html#atomica.optimization.MaximizeMeasurable"><code class="docutils literal notranslate"><span class="pre">MaximizeMeasurable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeMeasurable.html#atomica.optimization.MaximizeMeasurable.get_baseline"><code class="docutils literal notranslate"><span class="pre">MaximizeMeasurable.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeMeasurable.html#atomica.optimization.MaximizeMeasurable.get_objective_val"><code class="docutils literal notranslate"><span class="pre">MaximizeMeasurable.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.Measurable.html">atomica.optimization.Measurable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.Measurable.html#atomica.optimization.Measurable"><code class="docutils literal notranslate"><span class="pre">Measurable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Measurable.html#atomica.optimization.Measurable.get_baseline"><code class="docutils literal notranslate"><span class="pre">Measurable.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Measurable.html#atomica.optimization.Measurable.get_objective_val"><code class="docutils literal notranslate"><span class="pre">Measurable.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.MinimizeMeasurable.html">atomica.optimization.MinimizeMeasurable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.MinimizeMeasurable.html#atomica.optimization.MinimizeMeasurable"><code class="docutils literal notranslate"><span class="pre">MinimizeMeasurable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MinimizeMeasurable.html#atomica.optimization.MinimizeMeasurable.get_baseline"><code class="docutils literal notranslate"><span class="pre">MinimizeMeasurable.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MinimizeMeasurable.html#atomica.optimization.MinimizeMeasurable.get_objective_val"><code class="docutils literal notranslate"><span class="pre">MinimizeMeasurable.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html">atomica.optimization.Optimization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization"><code class="docutils literal notranslate"><span class="pre">Optimization</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.compute_objective"><code class="docutils literal notranslate"><span class="pre">Optimization.compute_objective()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.constrain_instructions"><code class="docutils literal notranslate"><span class="pre">Optimization.constrain_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.get_adjustment"><code class="docutils literal notranslate"><span class="pre">Optimization.get_adjustment()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.get_baselines"><code class="docutils literal notranslate"><span class="pre">Optimization.get_baselines()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.get_hard_constraints"><code class="docutils literal notranslate"><span class="pre">Optimization.get_hard_constraints()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.get_initialization"><code class="docutils literal notranslate"><span class="pre">Optimization.get_initialization()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.maxiters"><code class="docutils literal notranslate"><span class="pre">Optimization.maxiters</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.maxtime"><code class="docutils literal notranslate"><span class="pre">Optimization.maxtime</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.method"><code class="docutils literal notranslate"><span class="pre">Optimization.method</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.update_instructions"><code class="docutils literal notranslate"><span class="pre">Optimization.update_instructions()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.PairedLinearSpendingAdjustment.html">atomica.optimization.PairedLinearSpendingAdjustment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.PairedLinearSpendingAdjustment.html#atomica.optimization.PairedLinearSpendingAdjustment"><code class="docutils literal notranslate"><span class="pre">PairedLinearSpendingAdjustment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.PairedLinearSpendingAdjustment.html#atomica.optimization.PairedLinearSpendingAdjustment.adjustables"><code class="docutils literal notranslate"><span class="pre">PairedLinearSpendingAdjustment.adjustables</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.PairedLinearSpendingAdjustment.html#atomica.optimization.PairedLinearSpendingAdjustment.get_initialization"><code class="docutils literal notranslate"><span class="pre">PairedLinearSpendingAdjustment.get_initialization()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingAdjustment.html">atomica.optimization.SpendingAdjustment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingAdjustment.html#atomica.optimization.SpendingAdjustment"><code class="docutils literal notranslate"><span class="pre">SpendingAdjustment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingAdjustment.html#atomica.optimization.SpendingAdjustment.adjustables"><code class="docutils literal notranslate"><span class="pre">SpendingAdjustment.adjustables</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingAdjustment.html#atomica.optimization.SpendingAdjustment.get_initialization"><code class="docutils literal notranslate"><span class="pre">SpendingAdjustment.get_initialization()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingPackageAdjustment.html">atomica.optimization.SpendingPackageAdjustment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingPackageAdjustment.html#atomica.optimization.SpendingPackageAdjustment"><code class="docutils literal notranslate"><span class="pre">SpendingPackageAdjustment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingPackageAdjustment.html#atomica.optimization.SpendingPackageAdjustment.adjust_total_spend"><code class="docutils literal notranslate"><span class="pre">SpendingPackageAdjustment.adjust_total_spend</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingPackageAdjustment.html#atomica.optimization.SpendingPackageAdjustment.adjustables"><code class="docutils literal notranslate"><span class="pre">SpendingPackageAdjustment.adjustables</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingPackageAdjustment.html#atomica.optimization.SpendingPackageAdjustment.get_initialization"><code class="docutils literal notranslate"><span class="pre">SpendingPackageAdjustment.get_initialization()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.StartTimeAdjustment.html">atomica.optimization.StartTimeAdjustment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.StartTimeAdjustment.html#atomica.optimization.StartTimeAdjustment"><code class="docutils literal notranslate"><span class="pre">StartTimeAdjustment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.StartTimeAdjustment.html#atomica.optimization.StartTimeAdjustment.adjustables"><code class="docutils literal notranslate"><span class="pre">StartTimeAdjustment.adjustables</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.StartTimeAdjustment.html#atomica.optimization.StartTimeAdjustment.get_initialization"><code class="docutils literal notranslate"><span class="pre">StartTimeAdjustment.get_initialization()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.TotalSpendConstraint.html">atomica.optimization.TotalSpendConstraint</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.TotalSpendConstraint.html#atomica.optimization.TotalSpendConstraint"><code class="docutils literal notranslate"><span class="pre">TotalSpendConstraint</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.TotalSpendConstraint.html#atomica.optimization.TotalSpendConstraint.constrain_instructions"><code class="docutils literal notranslate"><span class="pre">TotalSpendConstraint.constrain_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.TotalSpendConstraint.html#atomica.optimization.TotalSpendConstraint.get_hard_constraint"><code class="docutils literal notranslate"><span class="pre">TotalSpendConstraint.get_hard_constraint()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.FailedConstraint.html">atomica.optimization.FailedConstraint</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.FailedConstraint.html#atomica.optimization.FailedConstraint"><code class="docutils literal notranslate"><span class="pre">FailedConstraint</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.InvalidInitialConditions.html">atomica.optimization.InvalidInitialConditions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.InvalidInitialConditions.html#atomica.optimization.InvalidInitialConditions"><code class="docutils literal notranslate"><span class="pre">InvalidInitialConditions</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.UnresolvableConstraint.html">atomica.optimization.UnresolvableConstraint</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.UnresolvableConstraint.html#atomica.optimization.UnresolvableConstraint"><code class="docutils literal notranslate"><span class="pre">UnresolvableConstraint</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.parameters.html">atomica.parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.parameters.Initialization.html">atomica.parameters.Initialization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.parameters.Initialization.html#atomica.parameters.Initialization"><code class="docutils literal notranslate"><span class="pre">Initialization</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Initialization.html#atomica.parameters.Initialization.apply"><code class="docutils literal notranslate"><span class="pre">Initialization.apply()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Initialization.html#atomica.parameters.Initialization.from_excel"><code class="docutils literal notranslate"><span class="pre">Initialization.from_excel()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Initialization.html#atomica.parameters.Initialization.from_result"><code class="docutils literal notranslate"><span class="pre">Initialization.from_result()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Initialization.html#atomica.parameters.Initialization.hash_y_factors"><code class="docutils literal notranslate"><span class="pre">Initialization.hash_y_factors()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.parameters.Parameter.html">atomica.parameters.Parameter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.parameters.Parameter.html#atomica.parameters.Parameter"><code class="docutils literal notranslate"><span class="pre">Parameter</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Parameter.html#atomica.parameters.Parameter.has_values"><code class="docutils literal notranslate"><span class="pre">Parameter.has_values()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Parameter.html#atomica.parameters.Parameter.interpolate"><code class="docutils literal notranslate"><span class="pre">Parameter.interpolate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Parameter.html#atomica.parameters.Parameter.pops"><code class="docutils literal notranslate"><span class="pre">Parameter.pops</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Parameter.html#atomica.parameters.Parameter.sample"><code class="docutils literal notranslate"><span class="pre">Parameter.sample()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Parameter.html#atomica.parameters.Parameter.smooth"><code class="docutils literal notranslate"><span class="pre">Parameter.smooth()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html">atomica.parameters.ParameterSet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet"><code class="docutils literal notranslate"><span class="pre">ParameterSet</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.all_pars"><code class="docutils literal notranslate"><span class="pre">ParameterSet.all_pars()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.apply_initialization"><code class="docutils literal notranslate"><span class="pre">ParameterSet.apply_initialization()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.calibration_spreadsheet"><code class="docutils literal notranslate"><span class="pre">ParameterSet.calibration_spreadsheet()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.get_par"><code class="docutils literal notranslate"><span class="pre">ParameterSet.get_par()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.initialization"><code class="docutils literal notranslate"><span class="pre">ParameterSet.initialization</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.load_calibration"><code class="docutils literal notranslate"><span class="pre">ParameterSet.load_calibration()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.make_constant"><code class="docutils literal notranslate"><span class="pre">ParameterSet.make_constant()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.sample"><code class="docutils literal notranslate"><span class="pre">ParameterSet.sample()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.save_calibration"><code class="docutils literal notranslate"><span class="pre">ParameterSet.save_calibration()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.y_factors"><code class="docutils literal notranslate"><span class="pre">ParameterSet.y_factors</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.plotting.html">atomica.plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.plot_bars.html">atomica.plotting.plot_bars</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.plot_bars.html#atomica.plotting.plot_bars"><code class="docutils literal notranslate"><span class="pre">plot_bars()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.plot_legend.html">atomica.plotting.plot_legend</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.plot_legend.html#atomica.plotting.plot_legend"><code class="docutils literal notranslate"><span class="pre">plot_legend()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.plot_series.html">atomica.plotting.plot_series</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.plot_series.html#atomica.plotting.plot_series"><code class="docutils literal notranslate"><span class="pre">plot_series()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.relabel_legend.html">atomica.plotting.relabel_legend</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.relabel_legend.html#atomica.plotting.relabel_legend"><code class="docutils literal notranslate"><span class="pre">relabel_legend()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.reorder_legend.html">atomica.plotting.reorder_legend</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.reorder_legend.html#atomica.plotting.reorder_legend"><code class="docutils literal notranslate"><span class="pre">reorder_legend()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.save_figs.html">atomica.plotting.save_figs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.save_figs.html#atomica.plotting.save_figs"><code class="docutils literal notranslate"><span class="pre">save_figs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html">atomica.plotting.PlotData</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData"><code class="docutils literal notranslate"><span class="pre">PlotData</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.__getitem__"><code class="docutils literal notranslate"><span class="pre">PlotData.__getitem__()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.accumulate"><code class="docutils literal notranslate"><span class="pre">PlotData.accumulate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.interpolate"><code class="docutils literal notranslate"><span class="pre">PlotData.interpolate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.programs"><code class="docutils literal notranslate"><span class="pre">PlotData.programs()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.set_colors"><code class="docutils literal notranslate"><span class="pre">PlotData.set_colors()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.time_aggregate"><code class="docutils literal notranslate"><span class="pre">PlotData.time_aggregate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.tvals"><code class="docutils literal notranslate"><span class="pre">PlotData.tvals()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html">atomica.plotting.Series</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series"><code class="docutils literal notranslate"><span class="pre">Series</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series.data_label"><code class="docutils literal notranslate"><span class="pre">Series.data_label</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series.data_pop"><code class="docutils literal notranslate"><span class="pre">Series.data_pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series.interpolate"><code class="docutils literal notranslate"><span class="pre">Series.interpolate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series.timescale"><code class="docutils literal notranslate"><span class="pre">Series.timescale</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series.unit_string"><code class="docutils literal notranslate"><span class="pre">Series.unit_string</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series.units"><code class="docutils literal notranslate"><span class="pre">Series.units</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.programs.html">atomica.programs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.programs.Covout.html">atomica.programs.Covout</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.programs.Covout.html#atomica.programs.Covout"><code class="docutils literal notranslate"><span class="pre">Covout</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Covout.html#atomica.programs.Covout.compute_impact_interaction"><code class="docutils literal notranslate"><span class="pre">Covout.compute_impact_interaction()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Covout.html#atomica.programs.Covout.get_outcome"><code class="docutils literal notranslate"><span class="pre">Covout.get_outcome()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Covout.html#atomica.programs.Covout.n_progs"><code class="docutils literal notranslate"><span class="pre">Covout.n_progs</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Covout.html#atomica.programs.Covout.sample"><code class="docutils literal notranslate"><span class="pre">Covout.sample()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Covout.html#atomica.programs.Covout.update_outcomes"><code class="docutils literal notranslate"><span class="pre">Covout.update_outcomes()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html">atomica.programs.Program</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program"><code class="docutils literal notranslate"><span class="pre">Program</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.baseline_spend"><code class="docutils literal notranslate"><span class="pre">Program.baseline_spend</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.capacity_constraint"><code class="docutils literal notranslate"><span class="pre">Program.capacity_constraint</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.coverage"><code class="docutils literal notranslate"><span class="pre">Program.coverage</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.get_capacity"><code class="docutils literal notranslate"><span class="pre">Program.get_capacity()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.get_prop_covered"><code class="docutils literal notranslate"><span class="pre">Program.get_prop_covered()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.get_spend"><code class="docutils literal notranslate"><span class="pre">Program.get_spend()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.is_one_off"><code class="docutils literal notranslate"><span class="pre">Program.is_one_off</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.label"><code class="docutils literal notranslate"><span class="pre">Program.label</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.name"><code class="docutils literal notranslate"><span class="pre">Program.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.sample"><code class="docutils literal notranslate"><span class="pre">Program.sample()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.saturation"><code class="docutils literal notranslate"><span class="pre">Program.saturation</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.spend_data"><code class="docutils literal notranslate"><span class="pre">Program.spend_data</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.target_comps"><code class="docutils literal notranslate"><span class="pre">Program.target_comps</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.target_pops"><code class="docutils literal notranslate"><span class="pre">Program.target_pops</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.unit_cost"><code class="docutils literal notranslate"><span class="pre">Program.unit_cost</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramInstructions.html">atomica.programs.ProgramInstructions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramInstructions.html#atomica.programs.ProgramInstructions"><code class="docutils literal notranslate"><span class="pre">ProgramInstructions</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramInstructions.html#atomica.programs.ProgramInstructions.scale_alloc"><code class="docutils literal notranslate"><span class="pre">ProgramInstructions.scale_alloc()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html">atomica.programs.ProgramSet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet"><code class="docutils literal notranslate"><span class="pre">ProgramSet</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.add_comp"><code class="docutils literal notranslate"><span class="pre">ProgramSet.add_comp()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.add_par"><code class="docutils literal notranslate"><span class="pre">ProgramSet.add_par()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.add_pop"><code class="docutils literal notranslate"><span class="pre">ProgramSet.add_pop()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.add_program"><code class="docutils literal notranslate"><span class="pre">ProgramSet.add_program()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.from_spreadsheet"><code class="docutils literal notranslate"><span class="pre">ProgramSet.from_spreadsheet()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.get_alloc"><code class="docutils literal notranslate"><span class="pre">ProgramSet.get_alloc()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.get_capacities"><code class="docutils literal notranslate"><span class="pre">ProgramSet.get_capacities()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.get_outcomes"><code class="docutils literal notranslate"><span class="pre">ProgramSet.get_outcomes()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.get_prop_coverage"><code class="docutils literal notranslate"><span class="pre">ProgramSet.get_prop_coverage()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.new"><code class="docutils literal notranslate"><span class="pre">ProgramSet.new()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.remove_comp"><code class="docutils literal notranslate"><span class="pre">ProgramSet.remove_comp()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.remove_par"><code class="docutils literal notranslate"><span class="pre">ProgramSet.remove_par()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.remove_pop"><code class="docutils literal notranslate"><span class="pre">ProgramSet.remove_pop()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.remove_program"><code class="docutils literal notranslate"><span class="pre">ProgramSet.remove_program()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.sample"><code class="docutils literal notranslate"><span class="pre">ProgramSet.sample()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.to_spreadsheet"><code class="docutils literal notranslate"><span class="pre">ProgramSet.to_spreadsheet()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.to_workbook"><code class="docutils literal notranslate"><span class="pre">ProgramSet.to_workbook()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.validate"><code class="docutils literal notranslate"><span class="pre">ProgramSet.validate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.programs.InvalidProgramBook.html">atomica.programs.InvalidProgramBook</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.programs.InvalidProgramBook.html#atomica.programs.InvalidProgramBook"><code class="docutils literal notranslate"><span class="pre">InvalidProgramBook</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.project.html">atomica.project</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html">atomica.project.Project</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project"><code class="docutils literal notranslate"><span class="pre">Project</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.calibrate"><code class="docutils literal notranslate"><span class="pre">Project.calibrate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.create_databook"><code class="docutils literal notranslate"><span class="pre">Project.create_databook()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.load"><code class="docutils literal notranslate"><span class="pre">Project.load()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.load_databook"><code class="docutils literal notranslate"><span class="pre">Project.load_databook()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.load_progbook"><code class="docutils literal notranslate"><span class="pre">Project.load_progbook()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.make_parset"><code class="docutils literal notranslate"><span class="pre">Project.make_parset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.make_progbook"><code class="docutils literal notranslate"><span class="pre">Project.make_progbook()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.make_scenario"><code class="docutils literal notranslate"><span class="pre">Project.make_scenario()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.optim"><code class="docutils literal notranslate"><span class="pre">Project.optim()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.parset"><code class="docutils literal notranslate"><span class="pre">Project.parset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.parsets"><code class="docutils literal notranslate"><span class="pre">Project.parsets</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.progset"><code class="docutils literal notranslate"><span class="pre">Project.progset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.result"><code class="docutils literal notranslate"><span class="pre">Project.result()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.run_optimization"><code class="docutils literal notranslate"><span class="pre">Project.run_optimization()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.run_sampled_sims"><code class="docutils literal notranslate"><span class="pre">Project.run_sampled_sims()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.run_scenarios"><code class="docutils literal notranslate"><span class="pre">Project.run_scenarios()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.run_sim"><code class="docutils literal notranslate"><span class="pre">Project.run_sim()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.save"><code class="docutils literal notranslate"><span class="pre">Project.save()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.scen"><code class="docutils literal notranslate"><span class="pre">Project.scen()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.update_settings"><code class="docutils literal notranslate"><span class="pre">Project.update_settings()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.project.ProjectSettings.html">atomica.project.ProjectSettings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.project.ProjectSettings.html#atomica.project.ProjectSettings"><code class="docutils literal notranslate"><span class="pre">ProjectSettings</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.ProjectSettings.html#atomica.project.ProjectSettings.tvec"><code class="docutils literal notranslate"><span class="pre">ProjectSettings.tvec</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.ProjectSettings.html#atomica.project.ProjectSettings.update_time_vector"><code class="docutils literal notranslate"><span class="pre">ProjectSettings.update_time_vector()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.reconciliation.html">atomica.reconciliation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.reconciliation.reconcile.html">atomica.reconciliation.reconcile</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.reconciliation.reconcile.html#atomica.reconciliation.reconcile"><code class="docutils literal notranslate"><span class="pre">reconcile()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.results.html">atomica.results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.results.export_results.html">atomica.results.export_results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.results.export_results.html#atomica.results.export_results"><code class="docutils literal notranslate"><span class="pre">export_results()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html">atomica.results.Ensemble</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble"><code class="docutils literal notranslate"><span class="pre">Ensemble</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.add"><code class="docutils literal notranslate"><span class="pre">Ensemble.add()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.baseline"><code class="docutils literal notranslate"><span class="pre">Ensemble.baseline</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.boxplot"><code class="docutils literal notranslate"><span class="pre">Ensemble.boxplot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.mapping_function"><code class="docutils literal notranslate"><span class="pre">Ensemble.mapping_function</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.n_samples"><code class="docutils literal notranslate"><span class="pre">Ensemble.n_samples</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.outputs"><code class="docutils literal notranslate"><span class="pre">Ensemble.outputs</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.plot_bars"><code class="docutils literal notranslate"><span class="pre">Ensemble.plot_bars()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.plot_distribution"><code class="docutils literal notranslate"><span class="pre">Ensemble.plot_distribution()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.plot_series"><code class="docutils literal notranslate"><span class="pre">Ensemble.plot_series()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.pops"><code class="docutils literal notranslate"><span class="pre">Ensemble.pops</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.results"><code class="docutils literal notranslate"><span class="pre">Ensemble.results</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.run_sims"><code class="docutils literal notranslate"><span class="pre">Ensemble.run_sims()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.samples"><code class="docutils literal notranslate"><span class="pre">Ensemble.samples</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.set_baseline"><code class="docutils literal notranslate"><span class="pre">Ensemble.set_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.tvec"><code class="docutils literal notranslate"><span class="pre">Ensemble.tvec</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.update"><code class="docutils literal notranslate"><span class="pre">Ensemble.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html">atomica.results.Result</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result"><code class="docutils literal notranslate"><span class="pre">Result</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.charac_names"><code class="docutils literal notranslate"><span class="pre">Result.charac_names()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.check_for_nans"><code class="docutils literal notranslate"><span class="pre">Result.check_for_nans()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.comp_names"><code class="docutils literal notranslate"><span class="pre">Result.comp_names()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.dt"><code class="docutils literal notranslate"><span class="pre">Result.dt</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.export_raw"><code class="docutils literal notranslate"><span class="pre">Result.export_raw()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.framework"><code class="docutils literal notranslate"><span class="pre">Result.framework</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.get_alloc"><code class="docutils literal notranslate"><span class="pre">Result.get_alloc()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.get_coverage"><code class="docutils literal notranslate"><span class="pre">Result.get_coverage()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.get_equivalent_alloc"><code class="docutils literal notranslate"><span class="pre">Result.get_equivalent_alloc()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.get_variable"><code class="docutils literal notranslate"><span class="pre">Result.get_variable()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.link_names"><code class="docutils literal notranslate"><span class="pre">Result.link_names()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.par_names"><code class="docutils literal notranslate"><span class="pre">Result.par_names()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.plot"><code class="docutils literal notranslate"><span class="pre">Result.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.pop_labels"><code class="docutils literal notranslate"><span class="pre">Result.pop_labels</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.t"><code class="docutils literal notranslate"><span class="pre">Result.t</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.used_programs"><code class="docutils literal notranslate"><span class="pre">Result.used_programs</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.scenarios.html">atomica.scenarios</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html">atomica.scenarios.BudgetScenario</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario"><code class="docutils literal notranslate"><span class="pre">BudgetScenario</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario.active"><code class="docutils literal notranslate"><span class="pre">BudgetScenario.active</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario.get_instructions"><code class="docutils literal notranslate"><span class="pre">BudgetScenario.get_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario.get_parset"><code class="docutils literal notranslate"><span class="pre">BudgetScenario.get_parset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario.get_progset"><code class="docutils literal notranslate"><span class="pre">BudgetScenario.get_progset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario.parsetname"><code class="docutils literal notranslate"><span class="pre">BudgetScenario.parsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario.progsetname"><code class="docutils literal notranslate"><span class="pre">BudgetScenario.progsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario.run"><code class="docutils literal notranslate"><span class="pre">BudgetScenario.run()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html">atomica.scenarios.CombinedScenario</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario"><code class="docutils literal notranslate"><span class="pre">CombinedScenario</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.active"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.active</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.get_instructions"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.get_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.get_parset"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.get_parset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.get_progset"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.get_progset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.interpolation"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.interpolation</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.parsetname"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.parsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.progsetname"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.progsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.run"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.run()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.scenario_values"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.scenario_values</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html">atomica.scenarios.CoverageScenario</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario"><code class="docutils literal notranslate"><span class="pre">CoverageScenario</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario.active"><code class="docutils literal notranslate"><span class="pre">CoverageScenario.active</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario.get_instructions"><code class="docutils literal notranslate"><span class="pre">CoverageScenario.get_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario.get_parset"><code class="docutils literal notranslate"><span class="pre">CoverageScenario.get_parset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario.get_progset"><code class="docutils literal notranslate"><span class="pre">CoverageScenario.get_progset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario.parsetname"><code class="docutils literal notranslate"><span class="pre">CoverageScenario.parsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario.progsetname"><code class="docutils literal notranslate"><span class="pre">CoverageScenario.progsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario.run"><code class="docutils literal notranslate"><span class="pre">CoverageScenario.run()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html">atomica.scenarios.ParameterScenario</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario"><code class="docutils literal notranslate"><span class="pre">ParameterScenario</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.active"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.active</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.add"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.add()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.get_instructions"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.get_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.get_parset"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.get_parset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.get_progset"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.get_progset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.interpolation"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.interpolation</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.parsetname"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.parsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.progsetname"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.progsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.run"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.run()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.scenario_values"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.scenario_values</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html">atomica.scenarios.Scenario</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario"><code class="docutils literal notranslate"><span class="pre">Scenario</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario.active"><code class="docutils literal notranslate"><span class="pre">Scenario.active</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario.get_instructions"><code class="docutils literal notranslate"><span class="pre">Scenario.get_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario.get_parset"><code class="docutils literal notranslate"><span class="pre">Scenario.get_parset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario.get_progset"><code class="docutils literal notranslate"><span class="pre">Scenario.get_progset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario.parsetname"><code class="docutils literal notranslate"><span class="pre">Scenario.parsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario.progsetname"><code class="docutils literal notranslate"><span class="pre">Scenario.progsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario.run"><code class="docutils literal notranslate"><span class="pre">Scenario.run()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.system.html">atomica.system</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.system.atomica_path.html">atomica.system.atomica_path</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.system.atomica_path.html#atomica.system.atomica_path"><code class="docutils literal notranslate"><span class="pre">atomica_path()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.system.FrameworkSettings.html">atomica.system.FrameworkSettings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.system.FrameworkSettings.html#atomica.system.FrameworkSettings"><code class="docutils literal notranslate"><span class="pre">FrameworkSettings</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.system.NotFoundError.html">atomica.system.NotFoundError</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.system.NotFoundError.html#atomica.system.NotFoundError"><code class="docutils literal notranslate"><span class="pre">NotFoundError</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.utils.html">atomica.utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.datetime_to_year.html">atomica.utils.datetime_to_year</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.datetime_to_year.html#atomica.utils.datetime_to_year"><code class="docutils literal notranslate"><span class="pre">datetime_to_year()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.evaluate_plot_string.html">atomica.utils.evaluate_plot_string</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.evaluate_plot_string.html#atomica.utils.evaluate_plot_string"><code class="docutils literal notranslate"><span class="pre">evaluate_plot_string()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.format_duration.html">atomica.utils.format_duration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.format_duration.html#atomica.utils.format_duration"><code class="docutils literal notranslate"><span class="pre">format_duration()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.get_sigfigs_necessary.html">atomica.utils.get_sigfigs_necessary</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.get_sigfigs_necessary.html#atomica.utils.get_sigfigs_necessary"><code class="docutils literal notranslate"><span class="pre">get_sigfigs_necessary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.nested_loop.html">atomica.utils.nested_loop</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.nested_loop.html#atomica.utils.nested_loop"><code class="docutils literal notranslate"><span class="pre">nested_loop()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.parallel_progress.html">atomica.utils.parallel_progress</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.parallel_progress.html#atomica.utils.parallel_progress"><code class="docutils literal notranslate"><span class="pre">parallel_progress()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.parent_dir.html">atomica.utils.parent_dir</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.parent_dir.html#atomica.utils.parent_dir"><code class="docutils literal notranslate"><span class="pre">parent_dir()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.start_logging.html">atomica.utils.start_logging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.start_logging.html#atomica.utils.start_logging"><code class="docutils literal notranslate"><span class="pre">start_logging()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.stop_logging.html">atomica.utils.stop_logging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.stop_logging.html#atomica.utils.stop_logging"><code class="docutils literal notranslate"><span class="pre">stop_logging()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html">atomica.utils.NDict</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict"><code class="docutils literal notranslate"><span class="pre">NDict</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.__add__"><code class="docutils literal notranslate"><span class="pre">NDict.__add__()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.append"><code class="docutils literal notranslate"><span class="pre">NDict.append()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.clear"><code class="docutils literal notranslate"><span class="pre">NDict.clear()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.copy"><code class="docutils literal notranslate"><span class="pre">NDict.copy()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.dict_items"><code class="docutils literal notranslate"><span class="pre">NDict.dict_items()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.dict_keys"><code class="docutils literal notranslate"><span class="pre">NDict.dict_keys()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.dict_values"><code class="docutils literal notranslate"><span class="pre">NDict.dict_values()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.disp"><code class="docutils literal notranslate"><span class="pre">NDict.disp()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.enumitems"><code class="docutils literal notranslate"><span class="pre">NDict.enumitems()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.enumkeys"><code class="docutils literal notranslate"><span class="pre">NDict.enumkeys()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.enumvals"><code class="docutils literal notranslate"><span class="pre">NDict.enumvals()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.enumvalues"><code class="docutils literal notranslate"><span class="pre">NDict.enumvalues()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.export"><code class="docutils literal notranslate"><span class="pre">NDict.export()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.filter"><code class="docutils literal notranslate"><span class="pre">NDict.filter()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.filtervals"><code class="docutils literal notranslate"><span class="pre">NDict.filtervals()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.findbykey"><code class="docutils literal notranslate"><span class="pre">NDict.findbykey()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.findbyval"><code class="docutils literal notranslate"><span class="pre">NDict.findbyval()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.findkeys"><code class="docutils literal notranslate"><span class="pre">NDict.findkeys()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.fromeach"><code class="docutils literal notranslate"><span class="pre">NDict.fromeach()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.fromkeys"><code class="docutils literal notranslate"><span class="pre">NDict.fromkeys()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.get"><code class="docutils literal notranslate"><span class="pre">NDict.get()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.getnested"><code class="docutils literal notranslate"><span class="pre">NDict.getnested()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.index"><code class="docutils literal notranslate"><span class="pre">NDict.index()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.insert"><code class="docutils literal notranslate"><span class="pre">NDict.insert()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.items"><code class="docutils literal notranslate"><span class="pre">NDict.items()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.iteritems"><code class="docutils literal notranslate"><span class="pre">NDict.iteritems()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.iternested"><code class="docutils literal notranslate"><span class="pre">NDict.iternested()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.keys"><code class="docutils literal notranslate"><span class="pre">NDict.keys()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.make"><code class="docutils literal notranslate"><span class="pre">NDict.make()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.makefrom"><code class="docutils literal notranslate"><span class="pre">NDict.makefrom()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.makenested"><code class="docutils literal notranslate"><span class="pre">NDict.makenested()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.map"><code class="docutils literal notranslate"><span class="pre">NDict.map()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.pop"><code class="docutils literal notranslate"><span class="pre">NDict.pop()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.popitem"><code class="docutils literal notranslate"><span class="pre">NDict.popitem()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.promote"><code class="docutils literal notranslate"><span class="pre">NDict.promote()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.remove"><code class="docutils literal notranslate"><span class="pre">NDict.remove()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.rename"><code class="docutils literal notranslate"><span class="pre">NDict.rename()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.reverse"><code class="docutils literal notranslate"><span class="pre">NDict.reverse()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.reversed"><code class="docutils literal notranslate"><span class="pre">NDict.reversed()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.setdefault"><code class="docutils literal notranslate"><span class="pre">NDict.setdefault()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.setitem"><code class="docutils literal notranslate"><span class="pre">NDict.setitem()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.setnested"><code class="docutils literal notranslate"><span class="pre">NDict.setnested()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.sort"><code class="docutils literal notranslate"><span class="pre">NDict.sort()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.sorted"><code class="docutils literal notranslate"><span class="pre">NDict.sorted()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.toeach"><code class="docutils literal notranslate"><span class="pre">NDict.toeach()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.update"><code class="docutils literal notranslate"><span class="pre">NDict.update()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.valind"><code class="docutils literal notranslate"><span class="pre">NDict.valind()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.values"><code class="docutils literal notranslate"><span class="pre">NDict.values()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.NamedItem.html">atomica.utils.NamedItem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.NamedItem.html#atomica.utils.NamedItem"><code class="docutils literal notranslate"><span class="pre">NamedItem</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.Quiet.html">atomica.utils.Quiet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.Quiet.html#atomica.utils.Quiet"><code class="docutils literal notranslate"><span class="pre">Quiet</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html">atomica.utils.TimeSeries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries"><code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.assumption"><code class="docutils literal notranslate"><span class="pre">TimeSeries.assumption</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.copy"><code class="docutils literal notranslate"><span class="pre">TimeSeries.copy()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.get"><code class="docutils literal notranslate"><span class="pre">TimeSeries.get()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.get_arrays"><code class="docutils literal notranslate"><span class="pre">TimeSeries.get_arrays()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.has_data"><code class="docutils literal notranslate"><span class="pre">TimeSeries.has_data</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.has_time_data"><code class="docutils literal notranslate"><span class="pre">TimeSeries.has_time_data</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.insert"><code class="docutils literal notranslate"><span class="pre">TimeSeries.insert()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.interpolate"><code class="docutils literal notranslate"><span class="pre">TimeSeries.interpolate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.remove"><code class="docutils literal notranslate"><span class="pre">TimeSeries.remove()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.remove_after"><code class="docutils literal notranslate"><span class="pre">TimeSeries.remove_after()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.remove_before"><code class="docutils literal notranslate"><span class="pre">TimeSeries.remove_before()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.remove_between"><code class="docutils literal notranslate"><span class="pre">TimeSeries.remove_between()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.sample"><code class="docutils literal notranslate"><span class="pre">TimeSeries.sample()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.sigma"><code class="docutils literal notranslate"><span class="pre">TimeSeries.sigma</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.t"><code class="docutils literal notranslate"><span class="pre">TimeSeries.t</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.units"><code class="docutils literal notranslate"><span class="pre">TimeSeries.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.vals"><code class="docutils literal notranslate"><span class="pre">TimeSeries.vals</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.version.html">atomica.version</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.html">atomica.yaml_calibration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.build.html">atomica.yaml_calibration.build</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.build.html#atomica.yaml_calibration.build"><code class="docutils literal notranslate"><span class="pre">build()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.run.html">atomica.yaml_calibration.run</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.run.html#atomica.yaml_calibration.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.BaseNode.html">atomica.yaml_calibration.BaseNode</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.BaseNode.html#atomica.yaml_calibration.BaseNode"><code class="docutils literal notranslate"><span class="pre">BaseNode</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.BaseNode.html#atomica.yaml_calibration.BaseNode.apply"><code class="docutils literal notranslate"><span class="pre">BaseNode.apply()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.BaseNode.html#atomica.yaml_calibration.BaseNode.validate"><code class="docutils literal notranslate"><span class="pre">BaseNode.validate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.CalibrationNode.html">atomica.yaml_calibration.CalibrationNode</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.CalibrationNode.html#atomica.yaml_calibration.CalibrationNode"><code class="docutils literal notranslate"><span class="pre">CalibrationNode</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.CalibrationNode.html#atomica.yaml_calibration.CalibrationNode.apply"><code class="docutils literal notranslate"><span class="pre">CalibrationNode.apply()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.CalibrationNode.html#atomica.yaml_calibration.CalibrationNode.validate"><code class="docutils literal notranslate"><span class="pre">CalibrationNode.validate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.ClearInitializationNode.html">atomica.yaml_calibration.ClearInitializationNode</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.ClearInitializationNode.html#atomica.yaml_calibration.ClearInitializationNode"><code class="docutils literal notranslate"><span class="pre">ClearInitializationNode</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.ClearInitializationNode.html#atomica.yaml_calibration.ClearInitializationNode.apply"><code class="docutils literal notranslate"><span class="pre">ClearInitializationNode.apply()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.ClearInitializationNode.html#atomica.yaml_calibration.ClearInitializationNode.validate"><code class="docutils literal notranslate"><span class="pre">ClearInitializationNode.validate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.InitializationNode.html">atomica.yaml_calibration.InitializationNode</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.InitializationNode.html#atomica.yaml_calibration.InitializationNode"><code class="docutils literal notranslate"><span class="pre">InitializationNode</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.InitializationNode.html#atomica.yaml_calibration.InitializationNode.apply"><code class="docutils literal notranslate"><span class="pre">InitializationNode.apply()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.InitializationNode.html#atomica.yaml_calibration.InitializationNode.validate"><code class="docutils literal notranslate"><span class="pre">InitializationNode.validate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.SaveCalibrationNode.html">atomica.yaml_calibration.SaveCalibrationNode</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.SaveCalibrationNode.html#atomica.yaml_calibration.SaveCalibrationNode"><code class="docutils literal notranslate"><span class="pre">SaveCalibrationNode</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.SaveCalibrationNode.html#atomica.yaml_calibration.SaveCalibrationNode.apply"><code class="docutils literal notranslate"><span class="pre">SaveCalibrationNode.apply()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.SaveCalibrationNode.html#atomica.yaml_calibration.SaveCalibrationNode.validate"><code class="docutils literal notranslate"><span class="pre">SaveCalibrationNode.validate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.SectionNode.html">atomica.yaml_calibration.SectionNode</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.SectionNode.html#atomica.yaml_calibration.SectionNode"><code class="docutils literal notranslate"><span class="pre">SectionNode</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.SectionNode.html#atomica.yaml_calibration.SectionNode.apply"><code class="docutils literal notranslate"><span class="pre">SectionNode.apply()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.yaml_calibration.SectionNode.html#atomica.yaml_calibration.SectionNode.validate"><code class="docutils literal notranslate"><span class="pre">SectionNode.validate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Atomica</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">atomica.plotting</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for atomica.plotting</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Functions for generating plots from model outputs</span>

<span class="sd">This module implements Atomica&#39;s plotting library, which is used to</span>
<span class="sd">generate various plots from model outputs.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">itertools</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">errno</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="kn">import</span> <span class="n">isna</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.interpolate</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.integrate</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.cm</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">cmx</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.colors</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">matplotlib_colors</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">PatchCollection</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.legend</span><span class="w"> </span><span class="kn">import</span> <span class="n">Legend</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.lines</span><span class="w"> </span><span class="kn">import</span> <span class="n">Line2D</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.patches</span><span class="w"> </span><span class="kn">import</span> <span class="n">Rectangle</span><span class="p">,</span> <span class="n">Patch</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">matplotlib.ticker</span><span class="w"> </span><span class="kn">import</span> <span class="n">FuncFormatter</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">atomica</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sciris</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">Compartment</span><span class="p">,</span> <span class="n">Characteristic</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">Link</span><span class="p">,</span> <span class="n">SourceCompartment</span><span class="p">,</span> <span class="n">JunctionCompartment</span><span class="p">,</span> <span class="n">SinkCompartment</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.results</span><span class="w"> </span><span class="kn">import</span> <span class="n">Result</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.system</span><span class="w"> </span><span class="kn">import</span> <span class="n">logger</span><span class="p">,</span> <span class="n">NotFoundError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.function_parser</span><span class="w"> </span><span class="kn">import</span> <span class="n">parse_function</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.system</span><span class="w"> </span><span class="kn">import</span> <span class="n">FrameworkSettings</span> <span class="k">as</span> <span class="n">FS</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">format_duration</span><span class="p">,</span> <span class="n">nested_loop</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;save_figs&quot;</span><span class="p">,</span> <span class="s2">&quot;PlotData&quot;</span><span class="p">,</span> <span class="s2">&quot;Series&quot;</span><span class="p">,</span> <span class="s2">&quot;plot_bars&quot;</span><span class="p">,</span> <span class="s2">&quot;plot_series&quot;</span><span class="p">,</span> <span class="s2">&quot;plot_legend&quot;</span><span class="p">,</span> <span class="s2">&quot;reorder_legend&quot;</span><span class="p">,</span> <span class="s2">&quot;relabel_legend&quot;</span><span class="p">]</span>

<span class="n">settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">settings</span><span class="p">[</span><span class="s2">&quot;legend_mode&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;together&quot;</span>  <span class="c1"># Possible options are [&#39;together&#39;,&#39;separate&#39;,&#39;none&#39;]</span>
<span class="n">settings</span><span class="p">[</span><span class="s2">&quot;bar_width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Width of bars in plot_bars()</span>
<span class="n">settings</span><span class="p">[</span><span class="s2">&quot;line_width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.0</span>  <span class="c1"># Width of lines in plot_series()</span>
<span class="n">settings</span><span class="p">[</span><span class="s2">&quot;marker_edge_width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="n">settings</span><span class="p">[</span><span class="s2">&quot;dpi&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>  <span class="c1"># average quality</span>
<span class="n">settings</span><span class="p">[</span><span class="s2">&quot;transparent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># Define default aggregation methods for standard units</span>
<span class="n">DEFAULT_OUTPUT_AGGREGATIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_FRACTION</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
    <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_PROPORTION</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
    <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_PROBABILITY</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
    <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_RATE</span><span class="p">:</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span>
    <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_DURATION</span><span class="p">:</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span>  <span class="c1"># e.g., diagnosis time + treatment time should be summed within a population</span>
    <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_NUMBER</span><span class="p">:</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Number of people&quot;</span><span class="p">:</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span>  <span class="c1"># This unit is used by compartments and characteristics without denominators</span>
<span class="p">}</span>

<span class="n">DEFAULT_POP_AGGREGATIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_FRACTION</span><span class="p">:</span> <span class="s2">&quot;weighted&quot;</span><span class="p">,</span>
    <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_PROPORTION</span><span class="p">:</span> <span class="s2">&quot;weighted&quot;</span><span class="p">,</span>
    <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_PROBABILITY</span><span class="p">:</span> <span class="s2">&quot;weighted&quot;</span><span class="p">,</span>
    <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_RATE</span><span class="p">:</span> <span class="s2">&quot;weighted&quot;</span><span class="p">,</span>
    <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_DURATION</span><span class="p">:</span> <span class="s2">&quot;weighted&quot;</span><span class="p">,</span>  <span class="c1"># e.g., diagnosis time should be averaged across populations</span>
    <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_NUMBER</span><span class="p">:</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Number of people&quot;</span><span class="p">:</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span>  <span class="c1"># This unit is used by compartments and characteristics without denominators</span>
    <span class="s2">&quot;&quot;</span><span class="p">:</span> <span class="s2">&quot;weighted&quot;</span><span class="p">,</span>  <span class="c1"># This unit is used by characteristics with denominators</span>
<span class="p">}</span>


<div class="viewcode-block" id="save_figs">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.save_figs.html#atomica.plotting.save_figs">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">save_figs</span><span class="p">(</span><span class="n">figs</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">fnames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Save figures to disk as PNG or other graphics format files</span>

<span class="sd">    Functions like `plot_series` and `plot_bars` can generate multiple figures, depending on</span>
<span class="sd">    the data and legend options. This function facilitates saving those figures together.</span>
<span class="sd">    The name for the file can be automatically selected when saving figures generated</span>
<span class="sd">    by `plot_series` and `plot_bars`. This function also deals with cases where the figure</span>
<span class="sd">    list may or may not contain a separate legend (so saving figures with this function means</span>
<span class="sd">    the legend mode can be changed freely without having to change the figure saving code).</span>

<span class="sd">    :param figs: A figure or list of figures</span>
<span class="sd">    :param path: Optionally append a path to the figure file name</span>
<span class="sd">    :param prefix: Optionally prepend a prefix to the file name</span>
<span class="sd">    :param fnames: Optionally an array of file names. By default, each figure is named</span>
<span class="sd">    using its &#39;label&#39; property. If a figure has an empty &#39;label&#39; string it is assumed to be</span>
<span class="sd">    a legend and will be named based on the name of the figure immediately before it.</span>
<span class="sd">    If you provide an empty string in the `fnames` argument this same operation will be carried</span>
<span class="sd">    out. If the last figure name is omitted, an empty string will automatically be added.</span>
<span class="sd">    :param file_format: the file format to save as, default png, allowed formats {png, ps, pdf, svg}</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">err</span><span class="o">.</span><span class="n">errno</span> <span class="o">!=</span> <span class="n">errno</span><span class="o">.</span><span class="n">EEXIST</span><span class="p">:</span>
            <span class="k">raise</span>

    <span class="c1"># Sanitize fig array input</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">figs</span> <span class="o">=</span> <span class="p">[</span><span class="n">figs</span><span class="p">]</span>

    <span class="c1"># Sanitize and populate default fnames values</span>
    <span class="k">if</span> <span class="n">fnames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="k">for</span> <span class="n">fig</span> <span class="ow">in</span> <span class="n">figs</span><span class="p">]</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fnames</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">fnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">fnames</span><span class="p">]</span>

    <span class="c1"># Add legend figure to the end</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fnames</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">figs</span><span class="p">):</span>
        <span class="n">fnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">fnames</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">figs</span><span class="p">),</span> <span class="s2">&quot;Number of figures must match number of specified filenames, or the last figure must be a legend with no label&quot;</span>
    <span class="k">assert</span> <span class="n">fnames</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;The first figure name cannot be empty&quot;</span>

    <span class="k">assert</span> <span class="n">file_format</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="s2">&quot;ps&quot;</span><span class="p">,</span> <span class="s2">&quot;pdf&quot;</span><span class="p">,</span> <span class="s2">&quot;svg&quot;</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;File format </span><span class="si">{</span><span class="n">file_format</span><span class="si">}</span><span class="s1"> invalid. Format must be one of &quot;png&quot;, &quot;ps&quot;, &quot;pdf&quot;, or &quot;svg&quot;&#39;</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">fig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">figs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">fnames</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>  <span class="c1"># assert above means that i&gt;0</span>
            <span class="n">fnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">fnames</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_legend&quot;</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">findobj</span><span class="p">(</span><span class="n">Legend</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">renderer</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">get_renderer</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="o">=</span><span class="n">renderer</span><span class="p">)</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">get_window_extent</span><span class="p">()</span><span class="o">.</span><span class="n">transformed</span><span class="p">(</span><span class="n">fig</span><span class="o">.</span><span class="n">dpi_scale_trans</span><span class="o">.</span><span class="n">inverted</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bbox</span> <span class="o">=</span> <span class="s2">&quot;tight&quot;</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">prefix</span> <span class="o">+</span> <span class="n">fnames</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">file_format</span>
        <span class="n">fname</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">sanitizefilename</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>  <span class="c1"># parameters may have inappropriate characters</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">fname</span><span class="p">),</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="n">bbox</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;dpi&quot;</span><span class="p">],</span> <span class="n">transparent</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;transparent&quot;</span><span class="p">])</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Saved figure &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span></div>



<div class="viewcode-block" id="PlotData">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PlotData</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Process model outputs into plottable quantities</span>

<span class="sd">    This is what gets passed into a plotting function, which displays a View of the data</span>
<span class="sd">    Conceptually, we are applying visuals to the data.</span>
<span class="sd">    But we are performing an extraction step rather than doing it directly because things like</span>
<span class="sd">    labels, colours, groupings etc. only apply to plots, not to results, and there could be several</span>
<span class="sd">    different views of the same data.</span>

<span class="sd">    Operators for ``-`` and ``/`` are defined to faciliate looking at differences and relative</span>
<span class="sd">    differences of derived quantities (quantities computed using ``PlotData`` operations) across</span>
<span class="sd">    individual results. To keep the implementation tractable, they don&#39;t generalize further than that,</span>
<span class="sd">    and operators ``+`` and ``*`` are not implemented because these operations rarely make sense</span>
<span class="sd">    for the data being operated on.</span>

<span class="sd">    :param results: Specify which results to plot. Can be</span>

<span class="sd">        - a Result,</span>
<span class="sd">        - a list of Results,</span>
<span class="sd">        - a dict/odict of results (the name of the result is taken from the Result, not the dict)</span>

<span class="sd">    :param outputs: The name of an output compartment, characteristic, or</span>
<span class="sd">                      parameter, or list of names. Inside a list, a dict can be given to</span>
<span class="sd">                      specify an aggregation e.g. ``outputs=[&#39;sus&#39;,{&#39;total&#39;:[&#39;sus&#39;,&#39;vac&#39;]}]``</span>
<span class="sd">                      where the key is the new name. Or, a formula can be given which will</span>
<span class="sd">                      be evaluated by looking up labels within the model object. Links will</span>
<span class="sd">                      automatically be summed over</span>

<span class="sd">    :param pops: The name of an output population, or list of names. Like</span>
<span class="sd">                 outputs, can specify a dict with a list of pops to aggregate over them</span>

<span class="sd">    :param output_aggregation: If an output aggregation is requested, combine the outputs listed using one of</span>

<span class="sd">          - &#39;sum&#39; - just add values together. If summing together characteristics with a denominator, then</span>
<span class="sd">                    all of the items being included in the sum must have the same denominator. This denominator</span>
<span class="sd">                    will then continue to be tracked for the sum.</span>
<span class="sd">          - &#39;average&#39; - unweighted average of quantities. If averaging characteristics with a denominator, then</span>
<span class="sd">                        the denominator will be dropped afterwards (so subsequent population aggregation will be</span>
<span class="sd">                        performed based on total population size)</span>
<span class="sd">          - &#39;weighted&#39; - weighted average where the weight is the</span>
<span class="sd">                            - Link source compartment size, or</span>
<span class="sd">                            - Characteristic denominator size, or</span>
<span class="sd">                            - Compartment size</span>
<span class="sd">                         depending on the quantities being aggregated. If one quantity has a denominator, then</span>
<span class="sd">                         all quantities must have denominators. This method cannot be used with non-transition parameters and a</span>
<span class="sd">                         KeyError will result in that case. Note that if using this method to aggregate characteristics, there</span>
<span class="sd">                         should generally not be any overlap in the compartments contributing to the denominators.</span>

<span class="sd">         For aggregating characteristics, the behaviour for combining characteristics ``a/b`` and ``c/d`` is as follows:</span>

<span class="sd">             - &#39;sum&#39; will give ``(a+c)/b`` and raise an error if ``b!=d``. The denominator ``b`` can be used for weighted population aggregation.</span>
<span class="sd">             - &#39;average&#39; will give ``((a/b)+(c/d))/2``. No denominator is tracked for weighted population aggregation, so such aggregation would use the total population size.</span>
<span class="sd">             - &#39;weighted&#39; will give ``(a+c)/(b+d)``. The denominator ``b+d`` can be used for weighted population aggregation.</span>

<span class="sd">        The default is &#39;weighted&#39; for dimensionless units, probabilities, rates, and fractions, and &#39;sum&#39; for everything else, with the exception of characteristics</span>
<span class="sd">        with denominators, where</span>
<span class="sd">            - &#39;sum&#39; is used if the characteristics all have the same denominator</span>
<span class="sd">            - &#39;weighted&#39; is used if the characteristics all have different denominators</span>
<span class="sd">            - &#39;average&#39; is used otherwise</span>

<span class="sd">    :param pop_aggregation: Same options as output_aggregation, except</span>
<span class="sd">                            - &#39;weighted&#39; uses population sizes OR characteristic denominator size. Note that output aggregation</span>
<span class="sd">                            is performed before population aggregation. This also means that population</span>
<span class="sd">                            aggregation can be used to combine already aggregated outputs (e.g.</span>
<span class="sd">                            can first sum &#39;sus&#39;+&#39;vac&#39; within populations, and then take weighted</span>
<span class="sd">                            average across populations). This weighting is principally intended for aggregating</span>
<span class="sd">                            nondimensional quantities (fractions, proportions etc.).</span>
<span class="sd">                            - By default, quantities in &#39;duration&#39; units are averaged across populations rather than summed.</span>

<span class="sd">    :param project: Optionally provide a :class:`Project` object, which will be used to convert names to labels in the outputs for plotting.</span>

<span class="sd">    :param time_aggregation: Optionally specify time aggregation method. Supported methods are &#39;integrate&#39; and &#39;average&#39; (no weighting). When aggregating</span>
<span class="sd">                                times, *non-annualized* flow rates will be used.</span>

<span class="sd">    :param t_bins: Optionally specify time bins, which will enable time aggregation. Supported inputs are</span>

<span class="sd">                      - A vector of bin edges. Time points are included if the time</span>
<span class="sd">                        is &gt;= the lower bin value and &lt; upper bin value.</span>
<span class="sd">                      - A scalar bin size (e.g. 5) which will be expanded to a vector spanning the data</span>
<span class="sd">                      - The string &#39;all&#39; will maps to bin edges ``[-inf, inf]`` aggregating over all time</span>

<span class="sd">    :param accumulate: Optionally accumulate outputs over time. Can be &#39;sum&#39; or &#39;integrate&#39; to either sum quantities or integrate by multiplying by the timestep. Accumulation happens *after* time aggregation.</span>
<span class="sd">                   The logic is extremely simple - the quantities in the Series pass through ``cumsum``. If &#39;integrate&#39; is selected, then the quantities are multiplied</span>
<span class="sd">                   by ``dt`` and the units are multiplied by ``years``</span>
<span class="sd">    :return: A :class:`PlotData` instance that can be passed to :func:`plot_series` or :func:`plot_bars`</span>

<span class="sd">    .. automethod:: __getitem__</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># TODO: Make sure to chuck a useful error when t_bins is greater than sim duration, rather than just crashing.</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">results</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pops</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_aggregation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pop_aggregation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">time_aggregation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">accumulate</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Validate inputs</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">sc</span><span class="o">.</span><span class="n">odict</span><span class="p">):</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">results</span><span class="p">]</span>

        <span class="n">result_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">result_names</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">result_names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Results must have different names (in their result.name property)&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pops</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;all&quot;</span><span class="p">]:</span>
            <span class="n">pops</span> <span class="o">=</span> <span class="p">[</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">pops</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">pops</span> <span class="o">==</span> <span class="s2">&quot;total&quot;</span><span class="p">:</span>
            <span class="n">pops</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;Total&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">pops</span><span class="p">]}]</span>
        <span class="n">pops</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">promotetolist</span><span class="p">(</span><span class="n">pops</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">outputs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">comp</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">comps</span> <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="n">SourceCompartment</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="n">JunctionCompartment</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="n">SinkCompartment</span><span class="p">))]</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">outputs</span><span class="p">]</span>

        <span class="n">pops</span> <span class="o">=</span> <span class="n">_expand_dict</span><span class="p">(</span><span class="n">pops</span><span class="p">)</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">_expand_dict</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">output_aggregation</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="s2">&quot;weighted&quot;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">pop_aggregation</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="s2">&quot;weighted&quot;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">time_aggregation</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;integrate&quot;</span><span class="p">,</span> <span class="s2">&quot;average&quot;</span><span class="p">]</span>

        <span class="c1"># First, get all of the pops and outputs requested by flattening the lists</span>
        <span class="n">pops_required</span> <span class="o">=</span> <span class="n">_extract_labels</span><span class="p">(</span><span class="n">pops</span><span class="p">)</span>
        <span class="n">outputs_required</span> <span class="o">=</span> <span class="n">_extract_labels</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tvecs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="c1"># Because aggregations always occur within a Result object, loop over results</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>

            <span class="n">result_label</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">name</span>
            <span class="n">tvecs</span><span class="p">[</span><span class="n">result_label</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">t</span>
            <span class="n">dt</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">dt</span>

            <span class="n">aggregated_outputs</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>  <span class="c1"># Dict with aggregated_outputs[pop_label][aggregated_output_label]</span>
            <span class="n">aggregated_units</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># Dict with aggregated_units[aggregated_output_label]</span>
            <span class="n">aggregated_timescales</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">aggregated_denominators</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>  <span class="c1"># Store aggregated denominators where available at the same dimensionality as outputs</span>
            <span class="n">output_units</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">output_timescales</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">compsize</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="n">denoms</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">odict</span><span class="p">()</span>  <span class="c1"># Record denominators associated with input characteristics</span>

            <span class="n">popsize</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="c1"># Defaultdict won&#39;t throw key error when checking outputs.</span>
            <span class="n">data_label</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>  <span class="c1"># Label used to identify which data to plot, maps output label to data label.</span>

            <span class="c1"># Aggregation over outputs takes place first, so loop over pops</span>
            <span class="k">for</span> <span class="n">pop_label</span> <span class="ow">in</span> <span class="n">pops_required</span><span class="p">:</span>
                <span class="n">pop</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_pop</span><span class="p">(</span><span class="n">pop_label</span><span class="p">)</span>
                <span class="n">popsize</span><span class="p">[</span><span class="n">pop_label</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">popsize</span><span class="p">()</span>
                <span class="n">data_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1"># Temporary storage for raw outputs</span>

                <span class="c1"># First pass, extract the original output quantities, summing links and annualizing as required</span>
                <span class="k">for</span> <span class="n">output_label</span> <span class="ow">in</span> <span class="n">outputs_required</span><span class="p">:</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="nb">vars</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="n">output_label</span><span class="p">)</span>
                    <span class="k">except</span> <span class="n">NotFoundError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">in_pops</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">pops</span> <span class="k">if</span> <span class="n">output_label</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
                        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Variable &quot;</span><span class="si">{</span><span class="n">output_label</span><span class="si">}</span><span class="s1">&quot; was requested in population &quot;</span><span class="si">{</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot; but it is only defined in these populations: </span><span class="si">{</span><span class="n">in_pops</span><span class="si">}</span><span class="s1">&#39;</span>
                        <span class="k">raise</span> <span class="n">NotFoundError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

                    <span class="k">if</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Requested output &quot;</span><span class="si">%s</span><span class="s1">&quot; was not recorded because only partial results were saved&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Link</span><span class="p">):</span>
                        <span class="n">data_dict</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">tvecs</span><span class="p">[</span><span class="n">result_label</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                        <span class="n">compsize</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">tvecs</span><span class="p">[</span><span class="n">result_label</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

                        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">:</span>
                            <span class="n">data_dict</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">vals</span>
                            <span class="n">compsize</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">vals</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">JunctionCompartment</span><span class="p">)</span> <span class="k">else</span> <span class="n">link</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">outflow</span>

                        <span class="c1"># Annualize the units, and record that they correspond to a flow per year</span>
                        <span class="n">data_dict</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">/=</span> <span class="n">dt</span>
                        <span class="n">output_units</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">units</span>
                        <span class="n">output_timescales</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
                        <span class="n">data_label</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parameter</span> <span class="ow">and</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_NUMBER</span><span class="p">)</span> <span class="k">else</span> <span class="kc">None</span>  <span class="c1"># Only use parameter data points if the units match</span>

                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Parameter</span><span class="p">):</span>
                        <span class="n">data_dict</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vals</span>
                        <span class="n">output_units</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">units</span>
                        <span class="n">output_timescales</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timescale</span>  <span class="c1"># The timescale attribute for non-transition parameters will already be set to None</span>
                        <span class="n">data_label</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>

                        <span class="c1"># If there are links, we can retrieve a compsize for the user to do a weighted average</span>
                        <span class="k">if</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
                            <span class="n">output_units</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">units</span>
                            <span class="n">compsize</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">tvecs</span><span class="p">[</span><span class="n">result_label</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
                                <span class="n">compsize</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">vals</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">JunctionCompartment</span><span class="p">)</span> <span class="k">else</span> <span class="n">link</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">outflow</span>

                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Compartment</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Characteristic</span><span class="p">):</span>
                        <span class="n">data_dict</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vals</span>
                        <span class="n">compsize</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vals</span>
                        <span class="n">output_units</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">units</span>
                        <span class="n">output_timescales</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="n">data_label</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Characteristic</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">denominator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">denoms</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">denominator</span>  <span class="c1"># Record the denominator for this quantity</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unknown type&quot;</span><span class="p">)</span>

                <span class="c1"># Second pass, add in any dynamically computed quantities</span>
                <span class="c1"># Using model. Parameter objects will automatically sum over Links and convert Links</span>
                <span class="c1"># to annualized rates</span>
                <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">outputs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="k">continue</span>

                    <span class="n">output_label</span><span class="p">,</span> <span class="n">f_stack_str</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">items</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># _extract_labels has already ensured only one key is present</span>

                    <span class="k">if</span> <span class="ow">not</span> <span class="n">sc</span><span class="o">.</span><span class="n">isstring</span><span class="p">(</span><span class="n">f_stack_str</span><span class="p">):</span>
                        <span class="k">continue</span>

                    <span class="k">def</span><span class="w"> </span><span class="nf">placeholder_pop</span><span class="p">():</span>
                        <span class="k">return</span> <span class="kc">None</span>

                    <span class="n">placeholder_pop</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>
                    <span class="n">par</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">pop</span><span class="o">=</span><span class="n">placeholder_pop</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">output_label</span><span class="p">)</span>
                    <span class="n">fcn</span><span class="p">,</span> <span class="n">dep_labels</span> <span class="o">=</span> <span class="n">parse_function</span><span class="p">(</span><span class="n">f_stack_str</span><span class="p">)</span>
                    <span class="n">deps</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="k">for</span> <span class="n">dep_label</span> <span class="ow">in</span> <span class="n">dep_labels</span><span class="p">:</span>
                        <span class="nb">vars</span> <span class="o">=</span> <span class="n">pop</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="n">dep_label</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">t_bins</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Link</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">vars</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Parameter</span><span class="p">))</span> <span class="ow">and</span> <span class="n">time_aggregation</span> <span class="o">==</span> <span class="s2">&quot;integrate&quot;</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Function includes Parameter/Link so annualized rates are being used. Aggregation should therefore use &#39;average&#39; rather than &#39;sum&#39;.&quot;</span><span class="p">)</span>
                        <span class="n">deps</span><span class="p">[</span><span class="n">dep_label</span><span class="p">]</span> <span class="o">=</span> <span class="nb">vars</span>
                    <span class="n">par</span><span class="o">.</span><span class="n">_fcn</span> <span class="o">=</span> <span class="n">fcn</span>
                    <span class="n">par</span><span class="o">.</span><span class="n">deps</span> <span class="o">=</span> <span class="n">deps</span>
                    <span class="n">par</span><span class="o">.</span><span class="n">preallocate</span><span class="p">(</span><span class="n">tvecs</span><span class="p">[</span><span class="n">result_label</span><span class="p">],</span> <span class="n">dt</span><span class="p">)</span>
                    <span class="n">par</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                    <span class="n">data_dict</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="n">par</span><span class="o">.</span><span class="n">vals</span>
                    <span class="n">output_units</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="n">par</span><span class="o">.</span><span class="n">units</span>
                    <span class="n">output_timescales</span><span class="p">[</span><span class="n">output_label</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="c1"># Third pass, aggregate them according to any aggregations present</span>
                <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">outputs</span><span class="p">:</span>  <span class="c1"># For each final output</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="n">output_name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># nb. there should be only one item in the output dict at this point</span>
                        <span class="n">labels</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span>

                        <span class="c1"># If this was a function, aggregation over outputs doesn&#39;t apply so just put it straight in.</span>
                        <span class="k">if</span> <span class="n">sc</span><span class="o">.</span><span class="n">isstring</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
                            <span class="n">aggregated_outputs</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span>
                            <span class="n">aggregated_units</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span>  <span class="c1"># Also, we don&#39;t know what the units of a function are</span>
                            <span class="n">aggregated_timescales</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Timescale is lost</span>
                            <span class="n">aggregated_denominators</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Denominators are not tracked</span>
                            <span class="k">continue</span>

                        <span class="n">units</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">output_units</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]))</span>
                        <span class="n">timescales</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">if</span> <span class="n">isna</span><span class="p">(</span><span class="n">output_timescales</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="k">else</span> <span class="n">output_timescales</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]))</span>  <span class="c1"># Ensure that None and nan don&#39;t appear as different timescales</span>

                        <span class="c1"># Set default aggregation method depending on the units of the quantity. If the aggregation method has not been specified</span>
                        <span class="c1"># then select a default aggregation method separately for each output</span>
                        <span class="k">if</span> <span class="n">output_aggregation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">aggregation</span> <span class="o">=</span> <span class="n">output_aggregation</span>
                        <span class="k">elif</span> <span class="n">denoms</span><span class="p">:</span>
                            <span class="k">try</span><span class="p">:</span>
                                <span class="n">denominators</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">denoms</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">])</span>
                            <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;If an aggregation includes characteristics with denominators, then all of the included quantities must be characteristics with denominators&quot;</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">e</span>

                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">denominators</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="c1"># If all characteristics share the same denominator e.g., SP and SN prevalence, then we want to add the characteristics together</span>
                                <span class="n">aggregation</span> <span class="o">=</span> <span class="s2">&quot;sum&quot;</span>
                            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">denominators</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
                                <span class="c1"># If all characteristics have different denominators e.g., proportion of SP/SN on treatment aggregated over SP and SN, then use weighted averaging</span>
                                <span class="n">aggregation</span> <span class="o">=</span> <span class="s2">&quot;weighted&quot;</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="c1"># Otherwise if mixing denominators, use a direct average. In general this should not happen because the result is not readily interpretable</span>
                                <span class="n">aggregation</span> <span class="o">=</span> <span class="s2">&quot;average&quot;</span>
                        <span class="k">elif</span> <span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">DEFAULT_OUTPUT_AGGREGATIONS</span><span class="p">:</span>
                            <span class="n">aggregation</span> <span class="o">=</span> <span class="n">DEFAULT_OUTPUT_AGGREGATIONS</span><span class="p">[</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unit quantity &quot;</span><span class="si">{</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot; was not recognized and an output aggregation method was not specified, using &quot;sum&quot; by default&#39;</span><span class="p">)</span>
                            <span class="n">aggregation</span> <span class="o">=</span> <span class="s2">&quot;sum&quot;</span>

                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Aggregation for output &#39;</span><span class="si">%s</span><span class="s2">&#39; is mixing units, this is almost certainly not desired.&quot;</span><span class="p">,</span> <span class="n">output_name</span><span class="p">)</span>
                            <span class="n">aggregated_units</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="c1"># If the user has requested a sum for a unit that doesn&#39;t use summation by default, there&#39;s a decent chance that this is a mistake</span>
                            <span class="k">if</span> <span class="n">aggregation</span> <span class="o">==</span> <span class="s2">&quot;sum&quot;</span> <span class="ow">and</span> <span class="n">DEFAULT_OUTPUT_AGGREGATIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;sum&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;sum&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">denoms</span><span class="p">:</span>  <span class="c1"># Dimensionless, like prevalance</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output &#39;</span><span class="si">{</span><span class="n">output_name</span><span class="si">}</span><span class="s2">&#39; is in &#39;</span><span class="si">{</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; units, so output aggregation probably should not be &#39;sum&#39;.&quot;</span><span class="p">)</span>
                            <span class="n">aggregated_units</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_units</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">timescales</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Aggregation for output &#39;</span><span class="si">%s</span><span class="s2">&#39; is mixing timescales, this is almost certainly not desired.&quot;</span><span class="p">,</span> <span class="n">output_name</span><span class="p">)</span>
                            <span class="n">aggregated_timescales</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">aggregated_timescales</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_timescales</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

                        <span class="c1"># Perform additional validation on the denominators</span>
                        <span class="k">if</span> <span class="n">denoms</span><span class="p">:</span>
                            <span class="n">unique_denoms</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">denoms</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">])</span>

                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_denoms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_denoms</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;When aggregating characteristics with denominators, they should generally either all have the same denominator, or all have different denominators. Partially duplicate denominators is likely not desired.&quot;</span><span class="p">)</span>

                            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_denoms</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="c1"># Check that the denominators are non-overlapping</span>
                                <span class="n">comps</span> <span class="o">=</span> <span class="p">[</span><span class="nb">set</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">get_charac_includes</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
                                <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">comps</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">()</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="n">comps</span><span class="p">)):</span>
                                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;When aggregating characteristics with different denominators, generally there should be no overlap in the denominators. However, some compartments are shared between the requested characteristic denominators. Unless this is intentional, this is likely a mistake that should be investigated.&quot;</span><span class="p">)</span>

                        <span class="k">if</span> <span class="n">aggregation</span> <span class="o">==</span> <span class="s2">&quot;sum&quot;</span><span class="p">:</span>
                            <span class="n">aggregated_outputs</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">)</span>  <span class="c1"># Add together all the outputs</span>

                            <span class="c1"># If summing characteristics that have denominators, then all quantities should have denominators, and they should all be equal</span>
                            <span class="c1"># For example, summing SP-TB and SN-TB prevalance where they both have the &#39;alive&#39; denominator</span>
                            <span class="n">has_denominator</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="ow">in</span> <span class="n">denoms</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
                            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">has_denominator</span><span class="p">):</span>
                                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">denoms</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;When aggregating characteristics with denominators, if summing them then all quantities must have the same denominator. The &quot;weighted&quot; aggregation can be used to combine characteristics with different denominators, on the assumption that their denominators do not overlap.&#39;</span>
                                <span class="n">aggregated_denominators</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">denoms</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vals</span>
                            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">has_denominator</span><span class="p">):</span>
                                <span class="n">aggregated_denominators</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;When aggregating outputs, if any quantities being aggregated have denominators, then they must all have denominators. These quantities have denominators </span><span class="si">{</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">denoms</span><span class="p">]</span><span class="si">}</span><span class="s2"> while these do not </span><span class="si">{</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">denoms</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                        <span class="k">elif</span> <span class="n">aggregation</span> <span class="o">==</span> <span class="s2">&quot;average&quot;</span><span class="p">:</span>
                            <span class="n">aggregated_outputs</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">)</span>
                            <span class="n">aggregated_outputs</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
                            <span class="n">aggregated_denominators</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># If taking a direct average then drop the denominator</span>
                        <span class="k">elif</span> <span class="n">aggregation</span> <span class="o">==</span> <span class="s2">&quot;weighted&quot;</span><span class="p">:</span>
                            <span class="n">has_denominator</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="ow">in</span> <span class="n">denoms</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>
                            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">has_denominator</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">has_denominator</span><span class="p">)</span>  <span class="c1"># An output aggregation must either have no quantities with denominators, or only contain quantities with denominators</span>
                            <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">has_denominator</span><span class="p">):</span>
                                <span class="c1"># Take weighted average based on denominator size, and then store the combined denominator further population aggregation</span>
                                <span class="n">aggregated_outputs</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">*</span> <span class="n">denoms</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">vals</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">)</span>
                                <span class="n">aggregated_denominators</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">denoms</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">vals</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">])</span>
                                <span class="n">aggregated_outputs</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="o">/=</span> <span class="n">aggregated_denominators</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span>
                            <span class="k">elif</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">(</span><span class="n">has_denominator</span><span class="p">):</span>
                                <span class="n">aggregated_outputs</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">data_dict</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">*</span> <span class="n">compsize</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">)</span>
                                <span class="n">aggregated_outputs</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="o">/=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">compsize</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">])</span>
                                <span class="n">aggregated_denominators</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># If taking a direct average then drop the denominator</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;When aggregating outputs, if any quantities being aggregated have denominators, then they must all have denominators. These quantities have denominators </span><span class="si">{</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">denoms</span><span class="p">]</span><span class="si">}</span><span class="s2"> while these do not </span><span class="si">{</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">denoms</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">aggregated_outputs</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_dict</span><span class="p">[</span><span class="n">output</span><span class="p">]</span>
                        <span class="n">aggregated_units</span><span class="p">[</span><span class="n">output</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_units</span><span class="p">[</span><span class="n">output</span><span class="p">]</span>
                        <span class="n">aggregated_timescales</span><span class="p">[</span><span class="n">output</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_timescales</span><span class="p">[</span><span class="n">output</span><span class="p">]</span>
                        <span class="n">aggregated_denominators</span><span class="p">[</span><span class="n">pop_label</span><span class="p">][</span><span class="n">output</span><span class="p">]</span> <span class="o">=</span> <span class="n">denoms</span><span class="p">[</span><span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">vals</span> <span class="k">if</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">denoms</span> <span class="k">else</span> <span class="kc">None</span>

            <span class="c1"># Now aggregate over populations</span>
            <span class="c1"># If we have requested a reduction over populations, this is done for every output present</span>
            <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">pops</span><span class="p">:</span>  <span class="c1"># This is looping over the population entries</span>
                <span class="k">for</span> <span class="n">output_name</span> <span class="ow">in</span> <span class="n">aggregated_outputs</span><span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">aggregated_outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                        <span class="n">pop_name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">pop_labels</span> <span class="o">=</span> <span class="n">pop</span><span class="p">[</span><span class="n">pop_name</span><span class="p">]</span>

                        <span class="c1"># Set population aggregation method depending on the quantity being aggregated</span>
                        <span class="k">if</span> <span class="n">pop_aggregation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">aggregation</span> <span class="o">=</span> <span class="n">pop_aggregation</span>
                        <span class="k">elif</span> <span class="n">aggregated_denominators</span><span class="p">[</span><span class="n">pop_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">output_name</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="c1"># Outputs with denominators use weighted by default</span>
                            <span class="n">aggregation</span> <span class="o">=</span> <span class="s2">&quot;weighted&quot;</span>
                        <span class="k">elif</span> <span class="n">aggregated_units</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span> <span class="ow">in</span> <span class="n">DEFAULT_POP_AGGREGATIONS</span><span class="p">:</span>
                            <span class="n">aggregation</span> <span class="o">=</span> <span class="n">DEFAULT_POP_AGGREGATIONS</span><span class="p">[</span><span class="n">aggregated_units</span><span class="p">[</span><span class="n">output_name</span><span class="p">]]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unit quantity &quot;</span><span class="si">{</span><span class="n">aggregated_units</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot; was not recognized and an output aggregation method was not specified, using &quot;sum&quot; by default&#39;</span><span class="p">)</span>
                            <span class="n">aggregation</span> <span class="o">=</span> <span class="s2">&quot;sum&quot;</span>

                        <span class="c1"># Perform aggregation</span>
                        <span class="k">if</span> <span class="n">aggregation</span> <span class="o">==</span> <span class="s2">&quot;sum&quot;</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">aggregation</span> <span class="o">==</span> <span class="s2">&quot;sum&quot;</span> <span class="ow">and</span> <span class="n">DEFAULT_POP_AGGREGATIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">aggregated_units</span><span class="p">[</span><span class="n">output_name</span><span class="p">],</span> <span class="s2">&quot;sum&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;sum&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">pop_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output &#39;</span><span class="si">{</span><span class="n">output_name</span><span class="si">}</span><span class="s2">&#39; is in &#39;</span><span class="si">{</span><span class="n">aggregated_units</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; units, so output aggregation should probably be &#39;</span><span class="si">{</span><span class="n">DEFAULT_POP_AGGREGATIONS</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">aggregated_units</span><span class="p">[</span><span class="n">output_name</span><span class="p">])</span><span class="si">}</span><span class="s2">&#39;, not &#39;sum&#39;.&quot;</span><span class="p">)</span>
                            <span class="n">vals</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">aggregated_outputs</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pop_labels</span><span class="p">)</span>  <span class="c1"># Add together all the outputs</span>
                        <span class="k">elif</span> <span class="n">aggregation</span> <span class="o">==</span> <span class="s2">&quot;average&quot;</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">aggregated_denominators</span><span class="p">[</span><span class="n">pop_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">output_name</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output &#39;</span><span class="si">{</span><span class="n">output_name</span><span class="si">}</span><span class="s2">&#39; has a denominator, so output aggregation should probably be &#39;weighted&#39; rather than &#39;average&#39;&quot;</span><span class="p">)</span>
                            <span class="n">vals</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">aggregated_outputs</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pop_labels</span><span class="p">)</span>  <span class="c1"># Add together all the outputs</span>
                            <span class="n">vals</span> <span class="o">/=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pop_labels</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">aggregation</span> <span class="o">==</span> <span class="s2">&quot;weighted&quot;</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">aggregated_denominators</span><span class="p">[</span><span class="n">pop_labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">output_name</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                                <span class="n">weights</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">aggregated_denominators</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pop_labels</span><span class="p">}</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">weights</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">:</span> <span class="n">popsize</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pop_labels</span><span class="p">}</span>
                            <span class="n">numerator</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">aggregated_outputs</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span> <span class="o">*</span> <span class="n">weights</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pop_labels</span><span class="p">)</span>  <span class="c1"># Add together all the outputs</span>
                            <span class="n">denominator</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">weights</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pop_labels</span><span class="p">])</span>
                            <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="n">denominator</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">numerator</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">numerator</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unknown population aggregation method &quot;</span><span class="si">{</span><span class="n">aggregation</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

                        <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Series</span><span class="p">(</span><span class="n">tvecs</span><span class="p">[</span><span class="n">result_label</span><span class="p">],</span> <span class="n">vals</span><span class="p">,</span> <span class="n">result_label</span><span class="p">,</span> <span class="n">pop_name</span><span class="p">,</span> <span class="n">output_name</span><span class="p">,</span> <span class="n">data_label</span><span class="p">[</span><span class="n">output_name</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="n">aggregated_units</span><span class="p">[</span><span class="n">output_name</span><span class="p">],</span> <span class="n">timescale</span><span class="o">=</span><span class="n">aggregated_timescales</span><span class="p">[</span><span class="n">output_name</span><span class="p">],</span> <span class="n">data_pop</span><span class="o">=</span><span class="n">pop_name</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">vals</span> <span class="o">=</span> <span class="n">aggregated_outputs</span><span class="p">[</span><span class="n">pop</span><span class="p">][</span><span class="n">output_name</span><span class="p">]</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Series</span><span class="p">(</span><span class="n">tvecs</span><span class="p">[</span><span class="n">result_label</span><span class="p">],</span> <span class="n">vals</span><span class="p">,</span> <span class="n">result_label</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output_name</span><span class="p">,</span> <span class="n">data_label</span><span class="p">[</span><span class="n">output_name</span><span class="p">],</span> <span class="n">units</span><span class="o">=</span><span class="n">aggregated_units</span><span class="p">[</span><span class="n">output_name</span><span class="p">],</span> <span class="n">timescale</span><span class="o">=</span><span class="n">aggregated_timescales</span><span class="p">[</span><span class="n">output_name</span><span class="p">],</span> <span class="n">data_pop</span><span class="o">=</span><span class="n">pop</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">odict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pops</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">odict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">pops</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="n">pop</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">_get_full_name</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">project</span><span class="p">)</span> <span class="k">if</span> <span class="n">project</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">key</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">odict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">outputs</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="n">output</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">_get_full_name</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">project</span><span class="p">)</span> <span class="k">if</span> <span class="n">project</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">key</span>

        <span class="c1"># Handle time aggregation</span>
        <span class="k">if</span> <span class="n">t_bins</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">time_aggregate</span><span class="p">(</span><span class="n">t_bins</span><span class="p">,</span> <span class="n">time_aggregation</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">accumulate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">accumulate</span><span class="p">)</span>

<div class="viewcode-block" id="PlotData.accumulate">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.accumulate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">accumulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">accumulation_method</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Accumulate values over time</span>

<span class="sd">        Accumulation methods are</span>

<span class="sd">        :param accumulation_method: Select whether to add or integrate. Supported methods are:</span>
<span class="sd">                                    - &#39;sum&#39; : runs `cumsum` on all quantities - should not be used if units are flow rates (so will check for a timescale).</span>
<span class="sd">                                              Summation should be used for compartment-based quantities, such as DALYs</span>
<span class="sd">                                    - &#39;integrate&#39; : integrate using trapezoidal rule, assuming initial value of 0</span>
<span class="sd">                                            Note that here there is no concept of &#39;dt&#39; because we might have non-uniform time aggregation bins</span>
<span class="sd">                                            Therefore, we need to use the time vector actually contained in the Series object (via `cumtrapz()`)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Note, in general we need to be able to explicitly specify the method to use, because we don&#39;t</span>
        <span class="c1"># know how to deal with parameter functions that have unknown units</span>
        <span class="k">assert</span> <span class="n">accumulation_method</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;integrate&quot;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">accumulation_method</span> <span class="o">==</span> <span class="s2">&quot;sum&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">isna</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">timescale</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Quantity &quot;</span><span class="si">%s</span><span class="s1">&quot; has timescale </span><span class="si">%g</span><span class="s1"> which means it should be accumulated by integration, not summation&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">output</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">timescale</span><span class="p">))</span>
                <span class="n">s</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">vals</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">accumulation_method</span> <span class="o">==</span> <span class="s2">&quot;integrate&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">timescale</span><span class="p">:</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">cumulative_trapezoid</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">vals</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">tvec</span> <span class="o">/</span> <span class="n">s</span><span class="o">.</span><span class="n">timescale</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">integrate</span><span class="o">.</span><span class="n">cumulative_trapezoid</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">vals</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">tvec</span><span class="p">)</span>
                <span class="n">s</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">vals</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>

                <span class="c1"># If integrating a quantity with a timescale, then lose the timescale factor</span>
                <span class="c1"># Otherwise, the units pick up a factor of time</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">isna</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">timescale</span><span class="p">):</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">timescale</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;Number of people&quot;</span><span class="p">:</span>
                        <span class="n">s</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;Number of person-years&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">s</span><span class="o">.</span><span class="n">units</span> <span class="o">+=</span> <span class="s2">&quot; years&quot;</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unknown accumulation type&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Cumulative &quot;</span> <span class="o">+</span> <span class="n">v</span></div>


<div class="viewcode-block" id="PlotData.time_aggregate">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.time_aggregate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">time_aggregate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t_bins</span><span class="p">,</span> <span class="n">time_aggregation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interpolation_method</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Aggregate values over time</span>

<span class="sd">        Note that *accumulation* is a running total, whereas *aggregation* refers to binning. The two can be</span>
<span class="sd">        both be applied (aggregation should be performed prior to accumulation).</span>

<span class="sd">        Normally, aggregation is performed when constructing a `PlotData` instance and this method does not need</span>
<span class="sd">        to be manually called. However, in rare cases, it may be necessary to explicitly set the interpolation method.</span>
<span class="sd">        Specifically, the interpolation method needs to match the underlying assumption for parameter values. For</span>
<span class="sd">        parameter scenarios, this may require that the &#39;previous&#39; method is used (to match the assumption in the parameter overwrite)</span>
<span class="sd">        rather than relying on the standard assumption that databook quantities can be interpolated directly.</span>

<span class="sd">        This method modifies the `PlotData` object in-place. However, the modified object is also returned, so that</span>
<span class="sd">        time aggregation can be chained with other operations, the same as `PlotData.interpolate()`.</span>

<span class="sd">        :param t_bins: Vector of bin edges OR a scalar bin size, which will be automatically expanded to a vector of bin edges</span>
<span class="sd">        :param time_aggregation: can be &#39;integrate&#39; or &#39;average&#39;. Note that for quantities that have a timescale, flow parameters</span>
<span class="sd">                                 in number units will be adjusted accordingly (e.g. a parameter in units of &#39;people/day&#39;</span>
<span class="sd">                                 aggregated over a 1 year period will display as the equivalent number of people that year)</span>
<span class="sd">        :param interpolation_method: Assumption on how the quantity behaves in between timesteps - in general, &#39;linear&#39; should be suitable for</span>
<span class="sd">                                     most dynamic quantities, while &#39;previous&#39; should be used for spending and other program-related quantities.</span>
<span class="sd">        :return: The same modified `PlotData` instance</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="n">time_aggregation</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;integrate&quot;</span><span class="p">,</span> <span class="s2">&quot;average&quot;</span><span class="p">]</span>
        <span class="k">assert</span> <span class="n">interpolation_method</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="s2">&quot;previous&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">interpolation_method</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">interpolation_method</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">t_bins</span><span class="p">,</span> <span class="s2">&quot;__len__&quot;</span><span class="p">):</span>
            <span class="c1"># If a scalar bin is provided, then it is assumed to correspond to the bin width, in which case we need</span>
            <span class="c1"># to create uniformly spaced bins up to the last complete bin.</span>
            <span class="k">if</span> <span class="n">t_bins</span> <span class="o">&gt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tvec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tvec</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="c1"># If bin width is greater than the sim duration, treat it the same as aggregating over all times</span>
                <span class="n">t_bins</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tvec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tvec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">%</span> <span class="n">t_bins</span><span class="p">:</span>
                    <span class="c1"># If the simulation ends in a multiple of the t_bins, then we can have a final bin extending up to the last</span>
                    <span class="c1"># simulation year. If we just use tvec[-1] in np.arange then that final bin will be excluded. So we add</span>
                    <span class="c1"># t_bins on to that final bin to ensure it&#39;s included.</span>
                    <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tvec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">t_bins</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tvec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">t_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tvec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">upper</span><span class="p">,</span> <span class="n">t_bins</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">t_bins</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;If passing in t_bins as a list of bin edges, at least two values must be provided&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">sc</span><span class="o">.</span><span class="n">isstring</span><span class="p">(</span><span class="n">t_bins</span><span class="p">)</span> <span class="ow">and</span> <span class="n">t_bins</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="n">t_bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tvec</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

        <span class="n">t_bins</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">promotetoarray</span><span class="p">(</span><span class="n">t_bins</span><span class="p">)</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="n">t_bins</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="n">t_bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">:</span>

            <span class="c1"># Decide automatic aggregation method if not specified - this is done on a per-quantity basis</span>
            <span class="k">if</span> <span class="n">time_aggregation</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">units</span> <span class="ow">in</span> <span class="p">{</span><span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_DURATION</span><span class="p">,</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_PROBABILITY</span><span class="p">,</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_RATE</span><span class="p">,</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_PROPORTION</span><span class="p">,</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_FRACTION</span><span class="p">}:</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;average&quot;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;integrate&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">method</span> <span class="o">=</span> <span class="n">time_aggregation</span>
                <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;integrate&quot;</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">units</span> <span class="ow">in</span> <span class="p">{</span><span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_DURATION</span><span class="p">,</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_PROBABILITY</span><span class="p">,</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_RATE</span><span class="p">,</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_PROPORTION</span><span class="p">,</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_FRACTION</span><span class="p">}:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Units for series &quot;</span><span class="si">%s</span><span class="s1">&quot; are &quot;</span><span class="si">%s</span><span class="s1">&quot; so time aggregation should probably be &quot;average&quot;, not &quot;integrate&quot;&#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">isna</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">timescale</span><span class="p">):</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">timescale</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">scale</span> <span class="o">=</span> <span class="mf">1.0</span>

            <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">lower</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="n">lower_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">tvec</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span> <span class="c1"># Time index for bin start</span>
            <span class="n">upper_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">tvec</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span> <span class="c1"># Time index for bin end</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">l_idx</span><span class="p">,</span> <span class="n">u_idx</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">lower_idx</span><span class="p">,</span> <span class="n">upper_idx</span><span class="p">)):</span>

                <span class="c1"># For bins that partially extend out of bounds, return NaN as the value immediately</span>
                <span class="k">if</span> <span class="n">l</span> <span class="o">&lt;</span> <span class="n">s</span><span class="o">.</span><span class="n">tvec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">u</span> <span class="o">&gt;</span> <span class="n">s</span><span class="o">.</span><span class="n">tvec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                    <span class="k">continue</span>
                <span class="k">elif</span> <span class="n">l</span> <span class="o">==</span> <span class="n">u</span><span class="p">:</span>
                    <span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">continue</span>

                <span class="c1"># The bins will consist of the actual simulation time points, plus</span>
                <span class="c1"># partial bins that are interpolated before and after if the requested</span>
                <span class="c1"># bins don&#39;t line up with the simulation timepoints</span>
                <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">l_idx</span><span class="p">,</span><span class="n">u_idx</span><span class="p">)</span>
                <span class="n">t2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">tvec</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                <span class="n">interpolate</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">l</span> <span class="ow">or</span> <span class="n">t2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">u</span><span class="p">:</span>
                    <span class="n">interpolate</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">t2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">t2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">l</span><span class="p">:</span>
                        <span class="n">t2</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">l</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">t2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">u</span><span class="p">:</span>
                        <span class="n">t2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
                    <span class="n">t2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">interpolation_method</span> <span class="o">==</span> <span class="s2">&quot;linear&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">interpolate</span><span class="p">:</span>
                        <span class="n">v2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">t2</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">tvec</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">vals</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>  <span class="c1"># Return NaN outside bounds - it should never be valid to use extrapolated output values in time aggregation</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">v2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                    <span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">v2</span> <span class="o">/</span> <span class="n">scale</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">t2</span><span class="p">)</span>  <span class="c1"># Note division by timescale here, which annualizes it</span>
                <span class="k">elif</span> <span class="n">interpolation_method</span> <span class="o">==</span> <span class="s2">&quot;previous&quot;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">interpolate</span><span class="p">:</span>
                        <span class="n">v2</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">tvec</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">vals</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;previous&quot;</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">assume_sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">))(</span><span class="n">t2</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">v2</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
                    <span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">v2</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">scale</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t2</span><span class="p">))</span>

            <span class="n">s</span><span class="o">.</span><span class="n">tvec</span> <span class="o">=</span> <span class="p">(</span><span class="n">lower</span> <span class="o">+</span> <span class="n">upper</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span>

            <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;integrate&quot;</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>

                <span class="c1"># If integrating the units might change</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">isna</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">timescale</span><span class="p">):</span>
                    <span class="c1"># Any flow rates get integrated over the bin width, so change the timescale to None</span>
                    <span class="c1"># If the units were &#39;duration&#39;, this doesn&#39;t make sense, but integrating a duration doesn&#39;t</span>
                    <span class="c1"># make sense either. This would only happen if the user explicitly requests it anyway. For example,</span>
                    <span class="c1"># a parameter might go from &#39;number of people per month&#39; to &#39;number of people&#39;</span>
                    <span class="n">s</span><span class="o">.</span><span class="n">timescale</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># For quantities that don&#39;t have a timescale and are being integrated, the scale is 1.0 and</span>
                    <span class="c1"># it picks up &#39;years&#39; in the units. So for example, &#39;number of people&#39; becomes &#39;number of person years&#39;</span>
                    <span class="c1"># This would be the usage 99% of the time (esp. for DALYs that are interested in number of person-years)</span>
                    <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="s2">&quot;Number of people&quot;</span><span class="p">:</span>
                        <span class="n">s</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;Number of person-years&quot;</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="n">isna</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">units</span><span class="p">):</span>
                        <span class="n">s</span><span class="o">.</span><span class="n">units</span> <span class="o">+=</span> <span class="s2">&quot; years&quot;</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># If the units are none, decide what to do. It probably makes sense just to do nothing and</span>
                        <span class="c1"># leave the units blank, on the assumption that the user knows what they are doing if they</span>
                        <span class="c1"># are working with dimensionless quantities. More commonly, the quantity wouldn&#39;t actually</span>
                        <span class="c1"># be dimensionless, but it might not have had units entered e.g. parameter functions</span>
                        <span class="k">pass</span>

            <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;average&quot;</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">t_bins</span> <span class="o">/</span> <span class="n">scale</span><span class="p">)</span>  <span class="c1"># Divide by bin width if averaging within the bins</span>
                <span class="n">s</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;Average </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">units</span><span class="p">)</span>  <span class="c1"># It will look odd to do &#39;Cumulative Average Number of people&#39; but that&#39;s will accurately what the user has requested (combining aggregation and accumulation is permitted, but not likely to be necessary)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Unknown time aggregation type &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">time_aggregation</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">sc</span><span class="o">.</span><span class="n">isstring</span><span class="p">(</span><span class="n">t_bins</span><span class="p">)</span> <span class="ow">and</span> <span class="n">t_bins</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">t_labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;All&quot;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">t_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">format_float_positional</span><span class="p">(</span><span class="n">low</span><span class="p">,</span><span class="n">trim</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">-</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">format_float_positional</span><span class="p">(</span><span class="n">high</span><span class="p">,</span><span class="n">trim</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">low</span><span class="p">,</span> <span class="n">high</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)]</span>

        <span class="k">return</span> <span class="bp">self</span></div>


    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;PlotData</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;Results: </span><span class="si">{0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;Pops: </span><span class="si">{0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="s2">&quot;Outputs: </span><span class="si">{0}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">s</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Difference between two instances</span>

<span class="sd">        This function iterates over all Series and takes their difference.</span>
<span class="sd">        The intended functionality is when wanting to compute the difference</span>
<span class="sd">        of derived quantities between two results. It only functions clearly when</span>
<span class="sd">        the only difference between two PlotData instances is the result they were</span>
<span class="sd">        constructed on. For example, model usage would be</span>

<span class="sd">        &gt;&gt;&gt; a = PlotData(result1, outputs, pops)</span>
<span class="sd">        &gt;&gt;&gt; b = PlotData(result2, outputs, pops)</span>
<span class="sd">        &gt;&gt;&gt; c = a-b</span>

<span class="sd">        Both PlotData instances must have</span>

<span class="sd">            - The same pops</span>
<span class="sd">            - The same outputs</span>
<span class="sd">            - The same units (i.e. the same aggregation steps)</span>
<span class="sd">            - The same time points</span>

<span class="sd">        This method also incorporates singleton expansion for results, which means that one or both</span>
<span class="sd">        of the PlotData instances can contain a single result instead of multiple results. The single</span>
<span class="sd">        result will be applied against all of the results in the other PlotData instance, so for example</span>
<span class="sd">        a single baseline result can be subtracted off a set of scenarios. Note that if both PlotData instances</span>
<span class="sd">        have more than one result, then an error will be raised (because the result names don&#39;t have to match,</span>
<span class="sd">        it is otherwise impossible to identify which pairs of results to subtract).</span>

<span class="sd">        Series will be copied either from the PlotData instance that has multiple Results, or from the left :class:`PlotData` instance</span>
<span class="sd">        if both instances have only one result. Thus, ensure that ordering, formatting, and</span>
<span class="sd">        labels are set in advance on the appropriate object, if preserving the formatting is important. In practice, it would be usually</span>
<span class="sd">        be best to operate on the :class:`PlotData` values first, before setting formatting etc.</span>

<span class="sd">        :param other: A :class:`PlotData` instance to subtract off</span>
<span class="sd">        :return: A new :class:`PlotData` instance</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">),</span> <span class="s2">&quot;PlotData subtraction can only operate on another PlotData instance&quot;</span>
        <span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">pops</span><span class="p">),</span> <span class="s2">&quot;PlotData subtraction requires both instances to have the same populations&quot;</span>
        <span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">outputs</span><span class="p">),</span> <span class="s2">&quot;PlotData subtraction requires both instances to have the same populations&quot;</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">other</span><span class="o">.</span><span class="n">tvals</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;When subtracting PlotData instances, both of them cannot have more than one result&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">dcp</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">dcp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">new</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">odict</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">s1</span> <span class="ow">in</span> <span class="n">new</span><span class="o">.</span><span class="n">series</span><span class="p">:</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s1</span><span class="o">.</span><span class="n">pop</span><span class="p">,</span> <span class="n">s1</span><span class="o">.</span><span class="n">output</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s2</span> <span class="o">=</span> <span class="n">other</span><span class="p">[</span><span class="n">other</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s1</span><span class="o">.</span><span class="n">pop</span><span class="p">,</span> <span class="n">s1</span><span class="o">.</span><span class="n">output</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">s1</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">s2</span><span class="o">.</span><span class="n">units</span>
            <span class="k">assert</span> <span class="n">s1</span><span class="o">.</span><span class="n">timescale</span> <span class="o">==</span> <span class="n">s2</span><span class="o">.</span><span class="n">timescale</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># If `b` has more than one result, then `s1` is from `b` and `s2` is from `a`, so the values for `a-b` are `s2-s1`</span>
                <span class="n">s1</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">vals</span> <span class="o">-</span> <span class="n">s1</span><span class="o">.</span><span class="n">vals</span>
                <span class="n">s1</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s2</span><span class="o">.</span><span class="n">result</span><span class="p">,</span> <span class="n">s1</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s1</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">vals</span> <span class="o">-</span> <span class="n">s2</span><span class="o">.</span><span class="n">vals</span>
                <span class="n">s1</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">result</span><span class="p">,</span> <span class="n">s2</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>

            <span class="n">new</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">s1</span><span class="o">.</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">result</span>

        <span class="k">return</span> <span class="n">new</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Divide two instances</span>

<span class="sd">        This function iterates over all Series and divides them. The original intention</span>
<span class="sd">        is to use this functionality when wanting to compute fractional differences between</span>
<span class="sd">        insteances. It only functions clearly when the only difference between two PlotData instances is the result they were</span>
<span class="sd">        constructed on. For example, model usage would be</span>

<span class="sd">        &gt;&gt;&gt; a = PlotData(result1, outputs, pops)</span>
<span class="sd">        &gt;&gt;&gt; b = PlotData(result2, outputs, pops)</span>
<span class="sd">        &gt;&gt;&gt; c = (a-b)/a</span>

<span class="sd">        Both PlotData instances must have</span>

<span class="sd">            - The same pops</span>
<span class="sd">            - The same outputs</span>
<span class="sd">            - The same units (i.e. the same aggregation steps)</span>
<span class="sd">            - The same time points</span>

<span class="sd">        Series will be copied either from the PlotData instance that has multiple Results, or from the left :class:`PlotData` instance</span>
<span class="sd">        if both instances have only one result. Thus, ensure that ordering, formatting, and</span>
<span class="sd">        labels are set in advance on the appropriate object, if preserving the formatting is important. In practice, it would be usually</span>
<span class="sd">        be best to operate on the :class:`PlotData` values first, before setting formatting etc.</span>

<span class="sd">        :param other: A :class:`PlotData` instance to serve as denominator in division</span>
<span class="sd">        :return: A new :class:`PlotData` instance</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">),</span> <span class="s2">&quot;PlotData subtraction can only operate on another PlotData instance&quot;</span>
        <span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">pops</span><span class="p">),</span> <span class="s2">&quot;PlotData subtraction requires both instances to have the same populations&quot;</span>
        <span class="k">assert</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outputs</span><span class="p">)</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">outputs</span><span class="p">),</span> <span class="s2">&quot;PlotData subtraction requires both instances to have the same populations&quot;</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">array_equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tvals</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">other</span><span class="o">.</span><span class="n">tvals</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;When subtracting PlotData instances, both of them cannot have more than one result&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">dcp</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">dcp</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">new</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">odict</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">s1</span> <span class="ow">in</span> <span class="n">new</span><span class="o">.</span><span class="n">series</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">s2</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s1</span><span class="o">.</span><span class="n">pop</span><span class="p">,</span> <span class="n">s1</span><span class="o">.</span><span class="n">output</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s2</span> <span class="o">=</span> <span class="n">other</span><span class="p">[</span><span class="n">other</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">s1</span><span class="o">.</span><span class="n">pop</span><span class="p">,</span> <span class="n">s1</span><span class="o">.</span><span class="n">output</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">s1</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">s2</span><span class="o">.</span><span class="n">units</span>
            <span class="k">assert</span> <span class="n">s1</span><span class="o">.</span><span class="n">timescale</span> <span class="o">==</span> <span class="n">s2</span><span class="o">.</span><span class="n">timescale</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># If `b` has more than one result, then `s1` is from `b` and `s2` is from `a`, so the values for `a-b` are `s2-s1`</span>
                <span class="n">s1</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">s2</span><span class="o">.</span><span class="n">vals</span> <span class="o">/</span> <span class="n">s1</span><span class="o">.</span><span class="n">vals</span>
                <span class="n">s1</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s2</span><span class="o">.</span><span class="n">result</span><span class="p">,</span> <span class="n">s1</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">s1</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">vals</span> <span class="o">/</span> <span class="n">s2</span><span class="o">.</span><span class="n">vals</span>
                <span class="n">s1</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">/</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">result</span><span class="p">,</span> <span class="n">s2</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
            <span class="n">s1</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">new</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">s1</span><span class="o">.</span><span class="n">result</span><span class="p">]</span> <span class="o">=</span> <span class="n">s1</span><span class="o">.</span><span class="n">result</span>

        <span class="k">return</span> <span class="n">new</span>

<div class="viewcode-block" id="PlotData.programs">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.programs">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">programs</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">t_bins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">quantity</span><span class="o">=</span><span class="s2">&quot;spending&quot;</span><span class="p">,</span> <span class="n">accumulate</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nan_outside</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructs a PlotData instance from program values</span>

<span class="sd">        This alternate constructor can be used to plot program-related quantities such as spending or coverage.</span>

<span class="sd">        :param results: single Result, or list of Results</span>
<span class="sd">        :param outputs: specification of which programs to plot spending for. Can be:</span>
<span class="sd">                        - the name of a single program</span>
<span class="sd">                        - a list of program names</span>
<span class="sd">                        - aggregation dict e.g. {&#39;treatment&#39;:[&#39;tx-1&#39;,&#39;tx-2&#39;]} or list of such dicts. Output aggregation type is automatically &#39;sum&#39; for</span>
<span class="sd">                          program spending, and aggregation is NOT permitted for coverages (due to modality interactions)</span>
<span class="sd">        :param t_bins: aggregate over time, using summation for spending and number coverage, and average for fraction/proportion coverage. Notice that</span>
<span class="sd">                        unlike the `PlotData()` constructor, this function does _not_ allow the time aggregation method to be manually set.</span>
<span class="sd">        :param quantity: can be &#39;spending&#39;, &#39;coverage_number&#39;, &#39;coverage_eligible&#39;, or &#39;coverage_fraction&#39;. The &#39;coverage_eligible&#39; is</span>
<span class="sd">                        the sum of compartments reached by a program, such that coverage_fraction = coverage_number/coverage_eligible</span>
<span class="sd">        :param accumulate: can be &#39;sum&#39; or &#39;integrate&#39;</span>
<span class="sd">        :param nan_outside: If True, then values will be NaN outside the program start/stop year</span>
<span class="sd">        :return: A new :class:`PlotData` instance</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Sanitize the results input</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">sc</span><span class="o">.</span><span class="n">odict</span><span class="p">):</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">Result</span><span class="p">):</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[</span><span class="n">results</span><span class="p">]</span>

        <span class="n">result_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">result_names</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">result_names</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Results must have different names (in their result.name property)&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">result</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">progset</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Tried to plot program outputs for result &quot;</span><span class="si">%s</span><span class="s1">&quot;, but that result did not use programs&#39;</span> <span class="o">%</span> <span class="n">result</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">outputs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">progset</span><span class="o">.</span><span class="n">programs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">outputs</span><span class="p">]</span>

        <span class="n">outputs</span> <span class="o">=</span> <span class="n">_expand_dict</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;spending&quot;</span><span class="p">,</span> <span class="s2">&quot;equivalent_spending&quot;</span><span class="p">,</span> <span class="s2">&quot;coverage_number&quot;</span><span class="p">,</span> <span class="s2">&quot;coverage_eligible&quot;</span><span class="p">,</span> <span class="s2">&quot;coverage_fraction&quot;</span><span class="p">,</span> <span class="s2">&quot;coverage_capacity&quot;</span><span class="p">]</span>
        <span class="c1"># Make a new PlotData instance</span>
        <span class="c1"># We are using __new__ because this method is to be formally considered an alternate constructor and</span>
        <span class="c1"># thus bears responsibility for ensuring this new instance is initialized correctly</span>
        <span class="n">plotdata</span> <span class="o">=</span> <span class="n">PlotData</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">PlotData</span><span class="p">)</span>
        <span class="n">plotdata</span><span class="o">.</span><span class="n">series</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Because aggregations always occur within a Result object, loop over results</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">quantity</span> <span class="o">==</span> <span class="s2">&quot;spending&quot;</span><span class="p">:</span>
                <span class="n">all_vals</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_alloc</span><span class="p">()</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">progset</span><span class="o">.</span><span class="n">currency</span>
                <span class="n">timescales</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">all_vals</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">quantity</span> <span class="o">==</span> <span class="s2">&quot;equivalent_spending&quot;</span><span class="p">:</span>
                <span class="n">all_vals</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_equivalent_alloc</span><span class="p">()</span>
                <span class="n">units</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">progset</span><span class="o">.</span><span class="n">currency</span>
                <span class="n">timescales</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">all_vals</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;coverage_capacity&quot;</span><span class="p">,</span> <span class="s2">&quot;coverage_number&quot;</span><span class="p">}:</span>
                <span class="k">if</span> <span class="n">quantity</span> <span class="o">==</span> <span class="s2">&quot;coverage_capacity&quot;</span><span class="p">:</span>
                    <span class="n">all_vals</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_coverage</span><span class="p">(</span><span class="s2">&quot;capacity&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">all_vals</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_coverage</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">)</span>
                <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;Number of people&quot;</span>
                <span class="n">timescales</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">all_vals</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">quantity</span> <span class="o">==</span> <span class="s2">&quot;coverage_eligible&quot;</span><span class="p">:</span>
                <span class="n">all_vals</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_coverage</span><span class="p">(</span><span class="s2">&quot;eligible&quot;</span><span class="p">)</span>
                <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;Number of people&quot;</span>
                <span class="n">timescales</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">all_vals</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">quantity</span> <span class="o">==</span> <span class="s2">&quot;coverage_fraction&quot;</span><span class="p">:</span>
                <span class="n">all_vals</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">get_coverage</span><span class="p">(</span><span class="s2">&quot;fraction&quot;</span><span class="p">)</span>
                <span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;Fraction covered&quot;</span>
                <span class="n">timescales</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="n">all_vals</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unknown quantity&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">outputs</span><span class="p">:</span>  <span class="c1"># For each final output</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>  <span class="c1"># If this is an aggregation over programs</span>
                    <span class="k">if</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;spending&quot;</span><span class="p">,</span> <span class="s2">&quot;equivalent_spending&quot;</span><span class="p">]:</span>
                        <span class="n">output_name</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># This is the aggregated name</span>
                        <span class="n">labels</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="n">output_name</span><span class="p">]</span>  <span class="c1"># These are the quantities being aggregated</span>

                        <span class="c1"># We only support summation for combining program spending, not averaging</span>
                        <span class="n">vals</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">all_vals</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">)</span>
                        <span class="n">output_name</span> <span class="o">=</span> <span class="n">output_name</span>
                        <span class="n">data_label</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># No data present for aggregations</span>
                        <span class="n">timescale</span> <span class="o">=</span> <span class="n">timescales</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Cannot use program aggregation for anything other than spending yet&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="n">all_vals</span><span class="p">[</span><span class="n">output</span><span class="p">]</span>
                    <span class="n">output_name</span> <span class="o">=</span> <span class="n">output</span>
                    <span class="n">data_label</span> <span class="o">=</span> <span class="n">output</span>  <span class="c1"># Can look up program spending by the program name</span>
                    <span class="n">timescale</span> <span class="o">=</span> <span class="n">timescales</span><span class="p">[</span><span class="n">output</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">nan_outside</span><span class="p">:</span>
                    <span class="n">vals</span><span class="p">[(</span><span class="n">result</span><span class="o">.</span><span class="n">t</span> <span class="o">&lt;</span> <span class="n">result</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">program_instructions</span><span class="o">.</span><span class="n">start_year</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">t</span> <span class="o">&gt;</span> <span class="n">result</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">program_instructions</span><span class="o">.</span><span class="n">stop_year</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

                <span class="n">plotdata</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Series</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="n">result</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">pop</span><span class="o">=</span><span class="n">FS</span><span class="o">.</span><span class="n">DEFAULT_SYMBOL_INAPPLICABLE</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="n">output_name</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="n">data_label</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="n">units</span><span class="p">,</span> <span class="n">timescale</span><span class="o">=</span><span class="n">timescale</span><span class="p">))</span>  <span class="c1"># The program should specify the units for its unit cost</span>

        <span class="n">plotdata</span><span class="o">.</span><span class="n">results</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">odict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">name</span>

        <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">odict</span><span class="p">({</span><span class="n">FS</span><span class="o">.</span><span class="n">DEFAULT_SYMBOL_INAPPLICABLE</span><span class="p">:</span> <span class="n">FS</span><span class="o">.</span><span class="n">DEFAULT_SYMBOL_INAPPLICABLE</span><span class="p">})</span>

        <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">odict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">outputs</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="k">else</span> <span class="n">output</span>
            <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">progset</span><span class="o">.</span><span class="n">programs</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">progset</span><span class="o">.</span><span class="n">programs</span> <span class="k">else</span> <span class="n">key</span>

        <span class="k">if</span> <span class="n">t_bins</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># TODO - time aggregation of coverage_number by integration should only be applied to one-off programs</span>
            <span class="c1"># TODO - confirm time aggregation of spending is correct for the units entered in databook or in overwrites</span>
            <span class="k">if</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;spending&quot;</span><span class="p">,</span> <span class="s2">&quot;equivalent_spending&quot;</span><span class="p">,</span> <span class="s2">&quot;coverage_number&quot;</span><span class="p">}:</span>
                <span class="n">plotdata</span><span class="o">.</span><span class="n">time_aggregate</span><span class="p">(</span><span class="n">t_bins</span><span class="p">,</span> <span class="s2">&quot;integrate&quot;</span><span class="p">,</span> <span class="n">interpolation_method</span><span class="o">=</span><span class="s2">&quot;previous&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">quantity</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;coverage_eligible&quot;</span><span class="p">,</span> <span class="s2">&quot;coverage_fraction&quot;</span><span class="p">}:</span>
                <span class="n">plotdata</span><span class="o">.</span><span class="n">time_aggregate</span><span class="p">(</span><span class="n">t_bins</span><span class="p">,</span> <span class="s2">&quot;average&quot;</span><span class="p">,</span> <span class="n">interpolation_method</span><span class="o">=</span><span class="s2">&quot;previous&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unknown quantity type for aggregation&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">accumulate</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plotdata</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">accumulate</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">plotdata</span></div>


<div class="viewcode-block" id="PlotData.tvals">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.tvals">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">tvals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return vector of time values</span>

<span class="sd">        This method returns a vector of time values for the ``PlotData`` object, if all of the series have the</span>
<span class="sd">        same time axis (otherwise it will throw an error). All series must have the same number of timepoints.</span>
<span class="sd">        This will always be the case for a ``PlotData`` object unless the instance has been manually modified after construction.</span>

<span class="sd">        :return: Tuple with (array of time values, array of time labels)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">tvec</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;All series must have the same number of time points.&quot;</span>
        <span class="n">tvec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tvec</span>
        <span class="n">t_labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">t_labels</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">)):</span>
            <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">tvec</span><span class="p">,</span> <span class="n">tvec</span><span class="p">)),</span> <span class="s2">&quot;All series must have the same time points&quot;</span>
        <span class="k">return</span> <span class="n">tvec</span><span class="p">,</span> <span class="n">t_labels</span></div>


<div class="viewcode-block" id="PlotData.interpolate">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.interpolate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_tvec</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Interpolate all ``Series`` onto new time values</span>

<span class="sd">        This will modify all of the contained ``Series`` objects in-place.</span>
<span class="sd">        The modified ``PlotData`` instance is also returned, so that interpolation and</span>
<span class="sd">        construction can be performed in one line. i.e. both</span>

<span class="sd">        &gt;&gt;&gt; d = PlotData(result)</span>
<span class="sd">        ... d.interpolate(tvals)</span>

<span class="sd">        and</span>

<span class="sd">        &gt;&gt;&gt; vals = PlotData(result).interpolate(tvals)</span>

<span class="sd">        will work as intended.</span>

<span class="sd">        :param new_tvec: Vector of new time values</span>
<span class="sd">        :return: The modified `PlotData` instance</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">new_tvec</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">promotetoarray</span><span class="p">(</span><span class="n">new_tvec</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">series</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">:</span>
            <span class="n">series</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">new_tvec</span><span class="p">)</span>
            <span class="n">series</span><span class="o">.</span><span class="n">tvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">new_tvec</span><span class="p">)</span>
            <span class="n">series</span><span class="o">.</span><span class="n">t_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">new_tvec</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span></div>


<div class="viewcode-block" id="PlotData.__getitem__">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.__getitem__">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implement custom indexing</span>

<span class="sd">        The :class:`Series` objects stored within :class:`PlotData` are each bound to a single</span>
<span class="sd">        result, population, and output. This operator makes it possible to easily retrieve</span>
<span class="sd">        a particular :class:`Series` instance. For example,</span>

<span class="sd">        &gt;&gt;&gt; d = PlotData(results)</span>
<span class="sd">        ... d[&#39;default&#39;,&#39;0-4&#39;,&#39;sus&#39;]</span>

<span class="sd">        :param key: A tuple of (result,pop,output)</span>
<span class="sd">        :return: A :class:`Series` instance</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">s</span><span class="o">.</span><span class="n">result</span> <span class="o">==</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">pop</span> <span class="o">==</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">s</span><span class="o">.</span><span class="n">output</span> <span class="o">==</span> <span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                <span class="k">return</span> <span class="n">s</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Series </span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2"> not found&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span></div>


<div class="viewcode-block" id="PlotData.set_colors">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.set_colors">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_colors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">results</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">pops</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">outputs</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assign colors to quantities</span>

<span class="sd">        This function facilitates assigned colors to the ``Series`` objects contained in this</span>
<span class="sd">        ``PlotData`` instance.</span>

<span class="sd">        :param colors: Specify the colours to use. This can be</span>
<span class="sd">                    - A list of colours that applies to the list of all matching items</span>
<span class="sd">                    - A single colour to use for all matching items</span>
<span class="sd">                    - The name of a colormap to use (e.g., &#39;Blues&#39;)</span>
<span class="sd">        :param results: A list of results to set colors for, or a dict of results where the key names the results (e.g. ``PlotData.results``)</span>
<span class="sd">        :param pops: A list of pops to set colors for, or a dict of pops where the key names the pops (e.g. ``PlotData.pops``</span>
<span class="sd">        :param outputs:A list of outputs to set colors for, or a dict of outputs where the key names the outputs (e.g. ``PlotData.outputs``)</span>
<span class="sd">        :param overwrite: False (default) or True. If True, then any existing manually set colours will be overwritten</span>
<span class="sd">        :return: The `PlotData` instance (also modified in-place)</span>

<span class="sd">        Essentially, the lists of results, pops, and outputs are used to filter the ``Series`` resulting in a list of ``Series`` to operate on.</span>
<span class="sd">        Then, the colors argument is applied to that list.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">promotetolist</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">pops</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">pops</span> <span class="o">=</span> <span class="n">pops</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pops</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">promotetolist</span><span class="p">(</span><span class="n">pops</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outputs</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">promotetolist</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>

        <span class="n">targets</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">pops</span><span class="p">,</span> <span class="n">outputs</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">colors</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">gridcolors</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">))</span>  <span class="c1"># Default colors</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">colors</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">),</span> <span class="s2">&quot;Number of colors must either be a string, or a list with as many elements as colors to set&quot;</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="n">colors</span>
        <span class="k">elif</span> <span class="n">colors</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;#&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">colors</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">datad</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">m</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_r&quot;</span><span class="p">)]:</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">colors</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">))]</span>  <span class="c1"># Apply color to all requested outputs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">color_norm</span> <span class="o">=</span> <span class="n">matplotlib_colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">))</span>
            <span class="n">scalar_map</span> <span class="o">=</span> <span class="n">cmx</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">color_norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">colors</span><span class="p">)</span>
            <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="n">scalar_map</span><span class="o">.</span><span class="n">to_rgba</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">targets</span><span class="p">))]</span>

        <span class="c1"># Now each of these colors gets assigned</span>
        <span class="k">for</span> <span class="n">color</span><span class="p">,</span> <span class="n">target</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">targets</span><span class="p">):</span>
            <span class="n">series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">series</span>
            <span class="n">series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">series</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">result</span> <span class="o">==</span> <span class="n">target</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">target</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">)]</span>
            <span class="n">series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">series</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">pop</span> <span class="o">==</span> <span class="n">target</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">target</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">)]</span>
            <span class="n">series</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">series</span> <span class="k">if</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">output</span> <span class="o">==</span> <span class="n">target</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">or</span> <span class="n">target</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">series</span><span class="p">:</span>
                <span class="n">s</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span> <span class="k">if</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">color</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">overwrite</span><span class="p">)</span> <span class="k">else</span> <span class="n">s</span><span class="o">.</span><span class="n">color</span>

        <span class="k">return</span> <span class="bp">self</span></div>
</div>



<div class="viewcode-block" id="Series">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Series</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represent a plottable time series</span>

<span class="sd">    A Series represents a quantity available for plotting. It is like a `TimeSeries` but contains</span>
<span class="sd">    additional information only used for plotting, such as color.</span>

<span class="sd">    :param tvec: array of time values</span>
<span class="sd">    :param vals: array of values</span>
<span class="sd">    :param result: name of the result associated with ths data</span>
<span class="sd">    :param pop: name of the pop associated with the data</span>
<span class="sd">    :param output: name of the output associated with the data</span>
<span class="sd">    :param data_label: name of a quantity in project data to plot in conjunction with this `Series`</span>
<span class="sd">    :param color: the color to render the `Series` with</span>
<span class="sd">    :param units: the units for the values</span>
<span class="sd">    :param timescale: For Number, Probability and Duration units, there are timescales associated with them</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tvec</span><span class="p">,</span> <span class="n">vals</span><span class="p">,</span> <span class="n">result</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">pop</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;default&quot;</span><span class="p">,</span> <span class="n">data_label</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">units</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">timescale</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data_pop</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">tvec</span><span class="p">)</span>  <span class="c1"># : array of time values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tvec</span><span class="p">)</span>  <span class="c1"># : Iterable array of time labels - could be set to strings like [2010-2014]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span>  <span class="c1"># : array of values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="n">result</span>  <span class="c1"># : name of the result associated with ths data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pop</span> <span class="o">=</span> <span class="n">pop</span>  <span class="c1"># : name of the pop associated with the data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output</span> <span class="o">=</span> <span class="n">output</span>  <span class="c1"># : name of the output associated with the data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">color</span>  <span class="c1"># : the color to render the `Series` with</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_label</span> <span class="o">=</span> <span class="n">data_label</span>  <span class="c1">#: Used to identify data for plotting - should match the name of a data TDVE</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data_pop</span> <span class="o">=</span> <span class="n">data_pop</span>  <span class="c1">#: Used to identify which population in the TDVE (specified by ``data_label``) to look up</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">units</span>  <span class="c1">#: The units for the quantity to display on the plot</span>

        <span class="c1">#: If the quantity has a time-like denominator (e.g. number/year, probability/day) then the denominator is stored here (in units of years)</span>
        <span class="c1">#: This enables quantities to be time-aggregated correctly (e.g. number/day must be converted to number/timestep prior to summation or integration)</span>
        <span class="c1">#: For links, the timescale is normally just ``dt``. This also enables more rigorous checking for quantities with time denominators than checking</span>
        <span class="c1">#: for a string like ``&#39;/year&#39;`` because users may not set this specifically.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timescale</span> <span class="o">=</span> <span class="n">timescale</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">vals</span><span class="p">)):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> contains NaNs&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">unit_string</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the units for the quantity including timescale</span>

<span class="sd">        When making plots, it is useful for the axis label to have the units of the quantity. The units should</span>
<span class="sd">        also include the time scale e.g. &quot;Death rate (probability per day)&quot;. However, if the timescale changes</span>
<span class="sd">        due to aggregation or accumulation, then the value might be different. In that case,</span>
<span class="sd">        The unit of the quantity is interpreted as a numerator if the Timescale is not None. For example,</span>
<span class="sd">        Compartments have units of &#39;number&#39;, while Links have units of &#39;number/timestep&#39; which is stored as</span>
<span class="sd">        ``Series.units=&#39;number&#39;`` and ``Series.timescale=0.25`` (if ``dt=0.25``). The `unit_string` attribute</span>
<span class="sd">        returns a string that is suitable to use for plots e.g. &#39;number per week&#39;.</span>

<span class="sd">        :return: A string representation of the units for use in plotting</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">isna</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timescale</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_DURATION</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">format_duration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timescale</span><span class="p">,</span> <span class="kc">True</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> per </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">format_duration</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timescale</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s2">&quot;Series(</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">,</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">result</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output</span><span class="p">)</span>

<div class="viewcode-block" id="Series.interpolate">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series.interpolate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_tvec</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return interpolated vector of values</span>

<span class="sd">        This function returns an `np.array()` with the values of this series interpolated onto the requested</span>
<span class="sd">        time array new_tvec. To ensure results are not misleading, extrapolation is disabled</span>
<span class="sd">        and will return `NaN` if `new_tvec` contains values outside the original time range.</span>

<span class="sd">        Note that unlike `PlotData.interpolate()`, `Series.interpolate()` does not modify the object but instead</span>
<span class="sd">        returns the interpolated values. This makes the `Series` object more versatile (`PlotData` is generally</span>
<span class="sd">        used only for plotting, but the `Series` object can be a convenient way to work with values computed using</span>
<span class="sd">        the sophisticated aggregations within `PlotData`).</span>

<span class="sd">        :param new_tvec: array of new time values</span>
<span class="sd">        :return: array with interpolated values (same size as `new_tvec`)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">out_of_bounds</span> <span class="o">=</span> <span class="p">(</span><span class="n">new_tvec</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvec</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="n">new_tvec</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">out_of_bounds</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Series has values from </span><span class="si">%.2f</span><span class="s2"> to </span><span class="si">%.2f</span><span class="s2"> so requested time points </span><span class="si">%s</span><span class="s2"> are out of bounds&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">new_tvec</span><span class="p">[</span><span class="n">out_of_bounds</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">promotetoarray</span><span class="p">(</span><span class="n">new_tvec</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">tvec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="plot_bars">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.plot_bars.html#atomica.plotting.plot_bars">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_bars</span><span class="p">(</span><span class="n">plotdata</span><span class="p">,</span> <span class="n">stack_pops</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">stack_outputs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">outer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_all_labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produce a bar plot</span>

<span class="sd">    :param plotdata: a :class:`PlotData` instance to plot</span>
<span class="sd">    :param stack_pops: A list of lists with populations to stack. A bar is rendered for each item in the list.</span>
<span class="sd">                       For example, `[[&#39;0-4&#39;,&#39;5-14&#39;],[&#39;15-64&#39;]]` will render two bars, with two populations stacked</span>
<span class="sd">                       in the first bar, and only one population in the second bar. Items not appearing in this list</span>
<span class="sd">                       will be rendered unstacked.</span>
<span class="sd">    :param stack_outputs: Same as `stack_pops`, but for outputs.</span>
<span class="sd">    :param outer: Optionally select whether the outermost/highest level of grouping is by `&#39;times&#39;` or by `&#39;results&#39;`</span>
<span class="sd">    :param legend_mode: override the default legend mode in settings</span>
<span class="sd">    :param show_all_labels: If True, then inner/outer labels will be shown even if there is only one label</span>
<span class="sd">    :param orientation: &#39;vertical&#39; (default) or &#39;horizontal&#39;</span>
<span class="sd">    :return: A list of newly created Figures</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">global</span> <span class="n">settings</span>
    <span class="k">if</span> <span class="n">legend_mode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">legend_mode</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;legend_mode&quot;</span><span class="p">]</span>

    <span class="k">assert</span> <span class="n">outer</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;times&quot;</span><span class="p">,</span> <span class="s2">&quot;results&quot;</span><span class="p">],</span> <span class="s1">&#39;Supported outer groups are &quot;times&quot; or &quot;results&quot;&#39;</span>
    <span class="k">assert</span> <span class="n">orientation</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">],</span> <span class="s1">&#39;Supported orientations are &quot;vertical&quot; or &quot;horizontal&quot;&#39;</span>

    <span class="k">if</span> <span class="n">outer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># If there is only one Result, then use &#39;outer=results&#39; so that times can be promoted to axis labels</span>
            <span class="n">outer</span> <span class="o">=</span> <span class="s2">&quot;results&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outer</span> <span class="o">=</span> <span class="s2">&quot;times&quot;</span>

    <span class="n">plotdata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">dcp</span><span class="p">(</span><span class="n">plotdata</span><span class="p">)</span>

    <span class="c1"># Note - all of the tvecs must be the same</span>
    <span class="n">tvals</span><span class="p">,</span> <span class="n">t_labels</span> <span class="o">=</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">tvals</span><span class="p">()</span>  <span class="c1"># We have to iterate over these, with offsets, if there is more than one</span>

    <span class="c1"># If quantities are stacked, then they need to be coloured differently.</span>
    <span class="k">if</span> <span class="n">stack_pops</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">color_by</span> <span class="o">=</span> <span class="s2">&quot;outputs&quot;</span>
        <span class="n">plotdata</span><span class="o">.</span><span class="n">set_colors</span><span class="p">(</span><span class="n">outputs</span><span class="o">=</span><span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">elif</span> <span class="n">stack_outputs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">color_by</span> <span class="o">=</span> <span class="s2">&quot;pops&quot;</span>
        <span class="n">plotdata</span><span class="o">.</span><span class="n">set_colors</span><span class="p">(</span><span class="n">pops</span><span class="o">=</span><span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">color_by</span> <span class="o">=</span> <span class="s2">&quot;both&quot;</span>
        <span class="n">plotdata</span><span class="o">.</span><span class="n">set_colors</span><span class="p">(</span><span class="n">pops</span><span class="o">=</span><span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">outputs</span><span class="o">=</span><span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_input_stacks</span><span class="p">(</span><span class="n">input_stacks</span><span class="p">,</span> <span class="n">available_items</span><span class="p">):</span>
        <span class="c1"># Sanitize the input. input stack could be</span>
        <span class="c1"># - A list of stacks, where a stack is a list of pops or a string with a single pop</span>
        <span class="c1"># - A dict of stacks, where the key is the name, and the value is a list of pops or a string with a single pop</span>
        <span class="c1"># - None, in which case all available items are used</span>
        <span class="c1"># - &#39;all&#39; in which case all of the items appear in a single stack</span>
        <span class="c1">#</span>
        <span class="c1"># The return value `output_stacks` is a list of tuples where</span>
        <span class="c1"># (a,b,c)</span>
        <span class="c1"># a - The automatic name</span>
        <span class="c1"># b - User provided manual name</span>
        <span class="c1"># c - List of pop labels</span>
        <span class="c1"># Same for outputs</span>

        <span class="k">if</span> <span class="n">input_stacks</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">available_items</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">input_stacks</span> <span class="o">==</span> <span class="s2">&quot;all&quot;</span><span class="p">:</span>
            <span class="c1"># Put all available items into a single stack</span>
            <span class="k">return</span> <span class="n">process_input_stacks</span><span class="p">([</span><span class="n">available_items</span><span class="p">],</span> <span class="n">available_items</span><span class="p">)</span>

        <span class="n">items</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">output_stacks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_stacks</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">input_stacks</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">output_stacks</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
                    <span class="n">items</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">sc</span><span class="o">.</span><span class="n">isstring</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="n">output_stacks</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">]))</span>
                    <span class="n">items</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unsupported input&quot;</span><span class="p">)</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_stacks</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">input_stacks</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="n">output_stacks</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>
                    <span class="n">items</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">sc</span><span class="o">.</span><span class="n">isstring</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                    <span class="n">output_stacks</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">]))</span>
                    <span class="n">items</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unsupported input&quot;</span><span class="p">)</span>

        <span class="c1"># Add missing items</span>
        <span class="n">missing</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">available_items</span><span class="p">)</span> <span class="o">-</span> <span class="n">items</span><span class="p">)</span>
        <span class="n">output_stacks</span> <span class="o">+=</span> <span class="p">[(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">missing</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">output_stacks</span>

    <span class="n">pop_stacks</span> <span class="o">=</span> <span class="n">process_input_stacks</span><span class="p">(</span><span class="n">stack_pops</span><span class="p">,</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">output_stacks</span> <span class="o">=</span> <span class="n">process_input_stacks</span><span class="p">(</span><span class="n">stack_outputs</span><span class="p">,</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="c1"># Now work out which pops and outputs appear in each bar (a bar is a pop-output combo)</span>
    <span class="n">bar_pops</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">bar_outputs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">pop_stacks</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">output_stacks</span><span class="p">:</span>
            <span class="n">bar_pops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pop</span><span class="p">)</span>
            <span class="n">bar_outputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>

    <span class="n">width</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;bar_width&quot;</span><span class="p">]</span>
    <span class="n">gaps</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">]</span>  <span class="c1"># Spacing within blocks, between inner groups, and between outer groups</span>

    <span class="n">block_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">bar_pops</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">width</span> <span class="o">+</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># If there is only one bar group, then increase spacing between bars</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">gaps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.3</span>

    <span class="k">if</span> <span class="n">outer</span> <span class="o">==</span> <span class="s2">&quot;times&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># If there is only one inner group</span>
            <span class="n">gaps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">gaps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">result_offset</span> <span class="o">=</span> <span class="n">block_width</span> <span class="o">+</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">tval_offset</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">block_width</span> <span class="o">+</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">iterator</span> <span class="o">=</span> <span class="n">nested_loop</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">)),</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">))],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">outer</span> <span class="o">==</span> <span class="s2">&quot;results&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># If there is only one inner group</span>
            <span class="n">gaps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">gaps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">result_offset</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">block_width</span> <span class="o">+</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">tval_offset</span> <span class="o">=</span> <span class="n">block_width</span> <span class="o">+</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">iterator</span> <span class="o">=</span> <span class="n">nested_loop</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">)),</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">))],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;outer option must be either &quot;times&quot; or &quot;results&quot;&#39;</span><span class="p">)</span>

    <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;bars&quot;</span><span class="p">)</span>
    <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

    <span class="n">rectangles</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>  <span class="c1"># Accumulate the list of rectangles for each colour</span>
    <span class="n">color_legend</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">odict</span><span class="p">()</span>

    <span class="c1"># NOTE</span>
    <span class="c1"># pops, output - colour separates them. To merge colours, aggregate the data first</span>
    <span class="c1"># results, time - spacing separates them. Can choose to group by one or the other</span>

    <span class="c1"># Now, there are three levels of ticks</span>
    <span class="c1"># There is the within-block level, the inner group, and the outer group</span>
    <span class="n">block_labels</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Labels for individual bars (tick labels)</span>
    <span class="n">inner_labels</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># Labels for bar groups below axis</span>
    <span class="n">block_offset</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">base_offset</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">negative_present</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># If True, it means negative quantities were present</span>

    <span class="c1"># Iterate over the inner and outer groups, rendering blocks at a time</span>
    <span class="k">for</span> <span class="n">r_idx</span><span class="p">,</span> <span class="n">t_idx</span> <span class="ow">in</span> <span class="n">iterator</span><span class="p">:</span>
        <span class="n">base_offset</span> <span class="o">=</span> <span class="n">r_idx</span> <span class="o">*</span> <span class="n">result_offset</span> <span class="o">+</span> <span class="n">t_idx</span> <span class="o">*</span> <span class="n">tval_offset</span>  <span class="c1"># Offset between outer groups</span>
        <span class="n">block_offset</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Offset between inner groups</span>

        <span class="k">if</span> <span class="n">outer</span> <span class="o">==</span> <span class="s2">&quot;results&quot;</span><span class="p">:</span>
            <span class="n">inner_labels</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">base_offset</span> <span class="o">+</span> <span class="n">block_width</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">t_labels</span><span class="p">[</span><span class="n">t_idx</span><span class="p">]))</span>
        <span class="k">elif</span> <span class="n">outer</span> <span class="o">==</span> <span class="s2">&quot;times&quot;</span><span class="p">:</span>
            <span class="n">inner_labels</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">base_offset</span> <span class="o">+</span> <span class="n">block_width</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">r_idx</span><span class="p">]))</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">bar_pop</span><span class="p">,</span> <span class="n">bar_output</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bar_pops</span><span class="p">)),</span> <span class="n">bar_pops</span><span class="p">,</span> <span class="n">bar_outputs</span><span class="p">):</span>
            <span class="c1"># pop is something like [&#39;0-4&#39;,&#39;5-14&#39;] or [&#39;0-4&#39;]</span>
            <span class="c1"># output is something like [&#39;sus&#39;,&#39;vac&#39;] or [&#39;0-4&#39;] depending on the stack</span>

            <span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>  <span class="c1"># Baselines for positive and negative bars, respectively</span>

            <span class="c1"># Set the name of the bar</span>
            <span class="c1"># If the user provided a label, it will always be displayed</span>
            <span class="c1"># In addition, if there is more than one label of the other (output/pop) type,</span>
            <span class="c1"># then that label will also be shown, otherwise it will be suppressed</span>
            <span class="k">if</span> <span class="n">bar_pop</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">or</span> <span class="n">bar_output</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">bar_pop</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">bar_output</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                        <span class="n">bar_label</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bar_pop</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bar_output</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_stacks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">output_stacks</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">bar_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">bar_label</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bar_pop</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bar_output</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">bar_label</span> <span class="o">=</span> <span class="n">bar_pop</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pop_stacks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pop_stacks</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">bar_pop</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                        <span class="n">bar_label</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">bar_pop</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">bar_output</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">bar_label</span> <span class="o">=</span> <span class="n">bar_output</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">color_by</span> <span class="o">==</span> <span class="s2">&quot;outputs&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">pop_stacks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pop_stacks</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">bar_label</span> <span class="o">=</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">bar_pop</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">elif</span> <span class="n">color_by</span> <span class="o">==</span> <span class="s2">&quot;pops&quot;</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_stacks</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">output_stacks</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">bar_label</span> <span class="o">=</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">bar_output</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bar_label</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

            <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">bar_pop</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">bar_output</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
                    <span class="n">series</span> <span class="o">=</span> <span class="n">plotdata</span><span class="p">[</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">r_idx</span><span class="p">],</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">series</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">t_idx</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">baseline</span> <span class="o">=</span> <span class="n">y0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="n">y0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">y</span>
                        <span class="n">height</span> <span class="o">=</span> <span class="n">y</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">baseline</span> <span class="o">=</span> <span class="n">y0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">y</span>
                        <span class="n">y0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">y</span>
                        <span class="n">height</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span>
                        <span class="n">negative_present</span> <span class="o">=</span> <span class="kc">True</span>

                    <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">:</span>
                        <span class="n">rectangles</span><span class="p">[</span><span class="n">series</span><span class="o">.</span><span class="n">color</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">baseline</span><span class="p">,</span> <span class="n">base_offset</span> <span class="o">+</span> <span class="n">block_offset</span><span class="p">),</span> <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">))</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">rectangles</span><span class="p">[</span><span class="n">series</span><span class="o">.</span><span class="n">color</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Rectangle</span><span class="p">((</span><span class="n">base_offset</span> <span class="o">+</span> <span class="n">block_offset</span><span class="p">,</span> <span class="n">baseline</span><span class="p">),</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">))</span>

                    <span class="k">if</span> <span class="n">series</span><span class="o">.</span><span class="n">color</span> <span class="ow">in</span> <span class="n">color_legend</span> <span class="ow">and</span> <span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">color_legend</span><span class="p">[</span><span class="n">series</span><span class="o">.</span><span class="n">color</span><span class="p">]:</span>
                        <span class="n">color_legend</span><span class="p">[</span><span class="n">series</span><span class="o">.</span><span class="n">color</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="n">series</span><span class="o">.</span><span class="n">color</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">color_legend</span><span class="p">:</span>
                        <span class="n">color_legend</span><span class="p">[</span><span class="n">series</span><span class="o">.</span><span class="n">color</span><span class="p">]</span> <span class="o">=</span> <span class="p">[(</span><span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">)]</span>

            <span class="n">block_labels</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">base_offset</span> <span class="o">+</span> <span class="n">block_offset</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span> <span class="n">bar_label</span><span class="p">))</span>

            <span class="n">block_offset</span> <span class="o">+=</span> <span class="n">width</span> <span class="o">+</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Add the patches to the figure and assemble the legend patches</span>
    <span class="n">legend_patches</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">color</span><span class="p">,</span> <span class="n">items</span> <span class="ow">in</span> <span class="n">color_legend</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">pc</span> <span class="o">=</span> <span class="n">PatchCollection</span><span class="p">(</span><span class="n">rectangles</span><span class="p">[</span><span class="n">color</span><span class="p">],</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">pc</span><span class="p">)</span>
        <span class="n">pops</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">items</span><span class="p">])</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">items</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">pops</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># If the same color is used for all pops and always the same output</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span>  <span class="c1"># Use the output name</span>
        <span class="k">elif</span> <span class="n">outputs</span> <span class="o">==</span> <span class="nb">set</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">pops</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Same color for all outputs and always same pop</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span>  <span class="c1"># Use the pop name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                <span class="n">label</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">,</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="o">.</span><span class="n">strip</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Replace trailing newline and comma</span>
        <span class="n">legend_patches</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Patch</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">))</span>

    <span class="c1"># Set axes now, because we need block_offset and base_offset after the loop</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">()</span>
    <span class="n">_turn_off_border</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">block_labels</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">block_labels</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">top</span><span class="o">=</span><span class="n">block_offset</span> <span class="o">+</span> <span class="n">base_offset</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="mf">0.75</span> <span class="o">+</span> <span class="mf">0.75</span> <span class="o">*</span> <span class="p">(</span><span class="n">block_offset</span> <span class="o">+</span> <span class="n">base_offset</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">negative_present</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s2">&quot;zero&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">block_labels</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">block_labels</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
        <span class="n">sc</span><span class="o">.</span><span class="n">SIticks</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">left</span><span class="o">=-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">right</span><span class="o">=</span><span class="n">block_offset</span> <span class="o">+</span> <span class="n">base_offset</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="mf">1.1</span> <span class="o">+</span> <span class="mf">1.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">block_offset</span> <span class="o">+</span> <span class="n">base_offset</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">negative_present</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_position</span><span class="p">(</span><span class="s2">&quot;zero&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">block_labels</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">block_labels</span><span class="p">])</span>
        <span class="n">sc</span><span class="o">.</span><span class="n">SIticks</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>

    <span class="c1"># Calculate the units. As all bar patches are shown on the same axis, they are all expected to have the</span>
    <span class="c1"># same units. If they do not, the plot could be misleading</span>
    <span class="n">units</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">unit_string</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">series</span><span class="p">]))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isna</span><span class="p">(</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Warning - bar plot quantities mix units, double check that output selection is correct&quot;</span><span class="p">)</span>

    <span class="c1"># Outer group labels are only displayed if there is more than one group</span>
    <span class="k">if</span> <span class="n">outer</span> <span class="o">==</span> <span class="s2">&quot;times&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">show_all_labels</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">tvals</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_labels</span><span class="p">:</span>
            <span class="c1"># Can&#39;t use title() here, there are usually more than one of these labels and they need to be positioned</span>
            <span class="c1"># at the particular axis value where the block of bars appear. Also, it would be common that the plot still</span>
            <span class="c1"># needs a title in addition to these (these outer labels are essentially tertiary axis ticks, not a title for the plot)</span>
            <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">offset</span> <span class="o">+</span> <span class="p">(</span><span class="n">tval_offset</span> <span class="o">-</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis_transform</span><span class="p">(),</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <span class="p">(</span><span class="n">tval_offset</span> <span class="o">-</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis_transform</span><span class="p">(),</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="n">tval_offset</span>

    <span class="k">elif</span> <span class="n">outer</span> <span class="o">==</span> <span class="s2">&quot;results&quot;</span> <span class="ow">and</span> <span class="p">(</span><span class="n">show_all_labels</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">offset</span> <span class="o">+</span> <span class="p">(</span><span class="n">result_offset</span> <span class="o">-</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">r</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis_transform</span><span class="p">(),</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <span class="p">(</span><span class="n">result_offset</span> <span class="o">-</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">gaps</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">r</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis_transform</span><span class="p">(),</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
            <span class="n">offset</span> <span class="o">+=</span> <span class="n">result_offset</span>

    <span class="c1"># If there are no block labels (e.g. due to stacking) and the number of inner labels matches the number of bars, then promote the inner group</span>
    <span class="c1"># labels and use them as bar labels</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">any</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">block_labels</span><span class="p">])</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">block_labels</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">inner_labels</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inner_labels</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inner_labels</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inner_labels</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inner_labels</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">show_all_labels</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">inner_labels</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inner_labels</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># Otherwise, if there is only one inner group AND there are bar labels, don&#39;t show the inner group labels unless show_all_labels is True</span>
        <span class="k">if</span> <span class="n">orientation</span> <span class="o">==</span> <span class="s2">&quot;horizontal&quot;</span><span class="p">:</span>
            <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>  <span class="c1"># instantiate a second axes that shares the same y-axis</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inner_labels</span><span class="p">])</span>
            <span class="c1"># TODO - At the moment there is a chance these labels will overlap, need to increase the offset somehow e.g. padding with spaces</span>
            <span class="c1"># Best to leave this until a specific test case arises</span>
            <span class="c1"># Simply rotating doesn&#39;t work because the vertical labels also overlap with the original axis labels</span>
            <span class="c1"># So would be necessary to apply some offset as well (perhaps from YAxis.get_text_widths)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inner_labels</span><span class="p">])</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax2</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>  <span class="c1"># instantiate a second axes that shares the same x-axis</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inner_labels</span><span class="p">])</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">inner_labels</span><span class="p">])</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
            <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">ax</span><span class="o">.</span><span class="n">get_xlim</span><span class="p">())</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>  <span class="c1"># Do a final resizing</span>

    <span class="c1"># Do the legend last, so repositioning the axes works properly</span>
    <span class="k">if</span> <span class="n">legend_mode</span> <span class="o">==</span> <span class="s2">&quot;together&quot;</span><span class="p">:</span>
        <span class="n">_render_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="n">handles</span><span class="o">=</span><span class="n">legend_patches</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">legend_mode</span> <span class="o">==</span> <span class="s2">&quot;separate&quot;</span><span class="p">:</span>
        <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">separatelegend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">legend_patches</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">figs</span></div>



<div class="viewcode-block" id="plot_series">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.plot_series.html#atomica.plotting.plot_series">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_series</span><span class="p">(</span><span class="n">plotdata</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;line&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legend_mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Produce a time series plot</span>

<span class="sd">    :param plotdata: a :class:`PlotData` instance to plot</span>
<span class="sd">    :param plot_type: &#39;line&#39;, &#39;stacked&#39;, or &#39;proportion&#39; (stacked, normalized to 1)</span>
<span class="sd">    :param axis: Specify which quantity to group outputs on plots by - can be &#39;outputs&#39;, &#39;results&#39;, or &#39;pops&#39;. A line will</span>
<span class="sd">                 be drawn for each of the selected quantity, and any other quantities will appear as separate figures.</span>
<span class="sd">    :param data:  Draw scatter points for data wherever the output label matches a data label. Only draws data if the plot_type is &#39;line&#39;</span>
<span class="sd">    :param legend_mode: override the default legend mode in settings</span>
<span class="sd">    :param lw: override the default line width</span>
<span class="sd">    :param n_cols: If None (default), separate figures will be created for each axis. If provided, axes will be tiled as subplots in a single figure</span>
<span class="sd">                   window with the requested number of columns</span>
<span class="sd">    :return: A list of newly created Figures</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">global</span> <span class="n">settings</span>
    <span class="k">if</span> <span class="n">legend_mode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">legend_mode</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;legend_mode&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">lw</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;line_width&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">axis</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">axis</span> <span class="o">=</span> <span class="s2">&quot;outputs&quot;</span>
    <span class="k">assert</span> <span class="n">axis</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;outputs&quot;</span><span class="p">,</span> <span class="s2">&quot;results&quot;</span><span class="p">,</span> <span class="s2">&quot;pops&quot;</span><span class="p">]</span>

    <span class="n">subplots</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">n_cols</span><span class="p">)</span>  <span class="c1"># If True, use subplots</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_prepare_figures</span><span class="p">(</span><span class="n">dim1</span><span class="p">,</span> <span class="n">dim2</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">):</span>
        <span class="n">n_figs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dim1</span><span class="p">)</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">dim2</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">legend_mode</span> <span class="o">==</span> <span class="s2">&quot;separate&quot;</span> <span class="k">else</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">subplots</span><span class="p">:</span>
            <span class="c1"># Use subplots</span>
            <span class="n">n_cols</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n_cols</span><span class="p">)</span>
            <span class="n">n_rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n_figs</span> <span class="o">/</span> <span class="n">n_cols</span><span class="p">))</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="n">n_cols</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="n">n_rows</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;series&quot;</span><span class="p">)</span>
            <span class="n">size</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_cols</span><span class="p">,</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_rows</span><span class="p">)</span>
            <span class="n">figs</span> <span class="o">=</span> <span class="p">[</span><span class="n">fig</span><span class="p">]</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>

            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_figs</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">axes</span><span class="p">)):</span>
                <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_figs</span><span class="p">):</span>
                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
                <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
                <span class="n">axes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">fig</span> <span class="ow">in</span> <span class="n">figs</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">figs</span><span class="p">[:</span><span class="n">n_figs</span><span class="p">],</span> <span class="n">axes</span><span class="p">[:</span><span class="n">n_figs</span><span class="p">]</span>

    <span class="n">plotdata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">dcp</span><span class="p">(</span><span class="n">plotdata</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">min</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">series</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;At least one Series has only one timepoint. Series must have at least 2 time points to be rendered as a line - `plot_bars` may be more suitable for such data&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;results&quot;</span><span class="p">:</span>
        <span class="n">plotdata</span><span class="o">.</span><span class="n">set_colors</span><span class="p">(</span><span class="n">results</span><span class="o">=</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="n">figs</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">_prepare_figures</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">,</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>

            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">subplots</span><span class="p">:</span>
                <span class="n">figs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">))</span>

            <span class="n">units</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">unit_string</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">]))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isna</span><span class="p">(</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">output</span><span class="p">],</span> <span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">output</span><span class="p">]))</span>

            <span class="k">if</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span> <span class="o">!=</span> <span class="n">FS</span><span class="o">.</span><span class="n">DEFAULT_SYMBOL_INAPPLICABLE</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">pop</span><span class="p">]))</span>

            <span class="k">if</span> <span class="n">plot_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;stacked&quot;</span><span class="p">,</span> <span class="s2">&quot;proportion&quot;</span><span class="p">]:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">vals</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">])</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;proportion&quot;</span> <span class="k">else</span> <span class="n">y</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">stackplot</span><span class="p">(</span><span class="n">plotdata</span><span class="p">[</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">tvec</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">color</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;stacked&quot;</span> <span class="ow">and</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">_stack_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">):</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">tvec</span><span class="p">,</span> <span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">vals</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">_render_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">])</span>
            <span class="n">_apply_series_formatting</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">legend_mode</span> <span class="o">==</span> <span class="s2">&quot;together&quot;</span><span class="p">:</span>
                <span class="n">_render_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;pops&quot;</span><span class="p">:</span>
        <span class="n">plotdata</span><span class="o">.</span><span class="n">set_colors</span><span class="p">(</span><span class="n">pops</span><span class="o">=</span><span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="n">figs</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">_prepare_figures</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">,</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>

            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">subplots</span><span class="p">:</span>
                <span class="n">figs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">output</span><span class="p">))</span>

            <span class="n">units</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">unit_string</span> <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">]))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isna</span><span class="p">(</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">output</span><span class="p">],</span> <span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">output</span><span class="p">]))</span>

            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">plot_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;stacked&quot;</span><span class="p">,</span> <span class="s2">&quot;proportion&quot;</span><span class="p">]:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">vals</span> <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">])</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;proportion&quot;</span> <span class="k">else</span> <span class="n">y</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">stackplot</span><span class="p">(</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">tvec</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">color</span> <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;stacked&quot;</span> <span class="ow">and</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">_stack_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span> <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">tvec</span><span class="p">,</span> <span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">vals</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">pop</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">_render_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">])</span>
            <span class="n">_apply_series_formatting</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">legend_mode</span> <span class="o">==</span> <span class="s2">&quot;together&quot;</span><span class="p">:</span>
                <span class="n">_render_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">axis</span> <span class="o">==</span> <span class="s2">&quot;outputs&quot;</span><span class="p">:</span>
        <span class="n">plotdata</span><span class="o">.</span><span class="n">set_colors</span><span class="p">(</span><span class="n">outputs</span><span class="o">=</span><span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="n">figs</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">_prepare_figures</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">,</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">,</span> <span class="n">n_cols</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>

            <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">subplots</span><span class="p">:</span>
                <span class="n">figs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">))</span>

            <span class="n">units</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">([</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">unit_string</span> <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">]))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">units</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isna</span><span class="p">(</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">+</span> <span class="n">units</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:])</span>

            <span class="k">if</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">pop</span><span class="p">]</span> <span class="o">!=</span> <span class="n">FS</span><span class="o">.</span><span class="n">DEFAULT_SYMBOL_INAPPLICABLE</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">-</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="p">],</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">pop</span><span class="p">]))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plotdata</span><span class="o">.</span><span class="n">results</span><span class="p">[</span><span class="n">result</span><span class="p">]))</span>

            <span class="k">if</span> <span class="n">plot_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;stacked&quot;</span><span class="p">,</span> <span class="s2">&quot;proportion&quot;</span><span class="p">]:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">vals</span> <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">])</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;proportion&quot;</span> <span class="k">else</span> <span class="n">y</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">stackplot</span><span class="p">(</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">tvec</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="p">[</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">color</span> <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;stacked&quot;</span> <span class="ow">and</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">_stack_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span> <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">output</span> <span class="ow">in</span> <span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">tvec</span><span class="p">,</span> <span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">vals</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">]</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">plotdata</span><span class="o">.</span><span class="n">outputs</span><span class="p">[</span><span class="n">output</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">_render_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">plotdata</span><span class="p">[</span><span class="n">result</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">output</span><span class="p">])</span>
            <span class="n">_apply_series_formatting</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">legend_mode</span> <span class="o">==</span> <span class="s2">&quot;together&quot;</span><span class="p">:</span>
                <span class="n">_render_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;axis option must be one of &quot;results&quot;, &quot;pops&quot; or &quot;outputs&quot;&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">legend_mode</span> <span class="o">==</span> <span class="s2">&quot;separate&quot;</span><span class="p">:</span>
        <span class="n">reverse_legend</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="n">plot_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;stacked&quot;</span><span class="p">,</span> <span class="s2">&quot;proportion&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">subplots</span><span class="p">:</span>
            <span class="c1"># Replace the last figure with a legend figure</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="n">figs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>  <span class="c1"># TODO - update Sciris to allow passing in an existing figure</span>
            <span class="n">figs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">separatelegend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="n">reverse_legend</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">legend_ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
            <span class="n">legend_ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>  <span class="c1"># Hide axis lines</span>
            <span class="k">if</span> <span class="n">reverse_legend</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
                <span class="n">handles</span> <span class="o">=</span> <span class="n">handles</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">labels</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">legend_ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">figs</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">_stack_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Internal function to stack series data</span>

<span class="sd">    Used by `plot_series` when rendering stacked plots and also showing data.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">baselines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">s</span><span class="o">.</span><span class="n">vals</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">series</span><span class="p">]),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">baselines</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">baselines</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])),</span> <span class="n">baselines</span><span class="p">])</span>  <span class="c1"># Insert row of zeros for first data row</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
        <span class="n">_render_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">baselines</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:],</span> <span class="kc">True</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_render_data</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">series</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filled</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Renders a scatter plot for a single variable in a single population</span>

<span class="sd">    :param ax: axis object that data will be rendered in</span>
<span class="sd">    :param data: a ProjectData instance containing the data to render</span>
<span class="sd">    :param series: a `Series` object, the &#39;pop&#39; and &#39;data_label&#39; attributes are used to extract the TimeSeries from the data</span>
<span class="sd">    :param baseline: adds an offset to the data e.g. for stacked plots</span>
<span class="sd">    :param filled: fill the marker with a solid fill e.g. for stacked plots</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ts</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get_ts</span><span class="p">(</span><span class="n">series</span><span class="o">.</span><span class="n">data_label</span><span class="p">,</span> <span class="n">series</span><span class="o">.</span><span class="n">data_pop</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">ts</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">ts</span><span class="o">.</span><span class="n">has_time_data</span><span class="p">:</span>
        <span class="k">return</span>

    <span class="n">t</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">get_arrays</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">baseline</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">promotetoarray</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">series</span><span class="o">.</span><span class="n">tvec</span><span class="p">,</span> <span class="n">baseline</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="n">y_data</span>

    <span class="k">if</span> <span class="n">filled</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">facecolors</span><span class="o">=</span><span class="n">series</span><span class="o">.</span><span class="n">color</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>  <span class="c1"># label=&#39;Data %s %s&#39; % (name(pop,proj),name(output,proj)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;marker_edge_width&quot;</span><span class="p">],</span> <span class="n">facecolors</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">series</span><span class="o">.</span><span class="n">color</span><span class="p">)</span>  <span class="c1"># label=&#39;Data %s %s&#39; % (name(pop,proj),name(output,proj)))</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_apply_series_formatting</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="c1"># This function applies formatting that is common to all Series plots</span>
    <span class="c1"># (irrespective of the &#39;axis&#39; setting)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">enable</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">_turn_off_border</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;proportion&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Proportion &quot;</span> <span class="o">+</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylabel</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.05</span><span class="p">)</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">SIticks</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_turn_off_border</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Turns off top and right borders.</span>

<span class="sd">    Note that this function will leave the bottom and left borders on.</span>

<span class="sd">    :param ax: An axis object</span>
<span class="sd">    :return: None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>


<div class="viewcode-block" id="plot_legend">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.plot_legend.html#atomica.plotting.plot_legend">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_legend</span><span class="p">(</span><span class="n">entries</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">legendsettings</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Render a new legend</span>

<span class="sd">    :param entries: Dict where key is the label and value is the colour e.g. `{&#39;sus&#39;:&#39;blue&#39;,&#39;vac&#39;:&#39;red&#39;}`</span>
<span class="sd">    :param plot_type: Optionally specify &#39;patch&#39;, &#39;line&#39;, &#39;circle&#39;, or a list the same length as param_entries containing these values</span>
<span class="sd">    :param fig: Optionally takes in the figure to render the legend in. If not provided, a new figure will be created</span>
<span class="sd">    :param legendsettings: settings for the layout of the legend. If not provided will default to appropriate values depending on whether the legend is separate or together with a plot</span>
<span class="sd">    :return: The matplotlib `Figure` object containing the legend</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">plot_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plot_type</span> <span class="o">=</span> <span class="s2">&quot;line&quot;</span>

    <span class="n">plot_type</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">promotetolist</span><span class="p">(</span><span class="n">plot_type</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_type</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">plot_type</span> <span class="o">=</span> <span class="n">plot_type</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">plot_type</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">),</span> <span class="s2">&quot;If plot_type is a list, it must have the same number of values as there are entries in the legend (</span><span class="si">%s</span><span class="s2"> vs </span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">plot_type</span><span class="p">,</span> <span class="n">entries</span><span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">color</span><span class="p">),</span> <span class="n">p_type</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">entries</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">plot_type</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">p_type</span> <span class="o">==</span> <span class="s2">&quot;patch&quot;</span><span class="p">:</span>
            <span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">p_type</span> <span class="o">==</span> <span class="s2">&quot;line&quot;</span><span class="p">:</span>
            <span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;line_width&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">p_type</span> <span class="o">==</span> <span class="s2">&quot;circle&quot;</span><span class="p">:</span>
            <span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Line2D</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;marker_edge_width&quot;</span><span class="p">],</span> <span class="n">fillstyle</span><span class="o">=</span><span class="s2">&quot;none&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unknown plot type &quot;</span><span class="si">{</span><span class="n">p_type</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Draw in a new figure</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">separatelegend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="n">legendsettings</span><span class="o">=</span><span class="n">legendsettings</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">existing_legend</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">findobj</span><span class="p">(</span><span class="n">Legend</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">existing_legend</span> <span class="ow">and</span> <span class="n">existing_legend</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">parent</span> <span class="ow">is</span> <span class="n">fig</span><span class="p">:</span>  <span class="c1"># If existing legend and this is a separate legend fig</span>
            <span class="n">existing_legend</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>  <span class="c1"># Delete the old legend</span>
            <span class="k">if</span> <span class="n">legendsettings</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">legendsettings</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;frameon&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>  <span class="c1"># Settings for separate legend</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="o">**</span><span class="n">legendsettings</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Drawing into an existing figure</span>
            <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">legendsettings</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">legendsettings</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;center left&quot;</span><span class="p">,</span> <span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="s2">&quot;ncol&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
            <span class="k">if</span> <span class="n">existing_legend</span><span class="p">:</span>
                <span class="n">existing_legend</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>  <span class="c1"># Delete the old legend</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="o">**</span><span class="n">legendsettings</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">h</span><span class="p">,</span> <span class="o">**</span><span class="n">legendsettings</span><span class="p">)</span>
                <span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">fig</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">_render_legend</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">plot_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">handles</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Internal function to render a legend</span>

<span class="sd">    :param ax: Axis in which to create the legend</span>
<span class="sd">    :param plot_type: Used to decide whether to reverse the legend order for stackplots</span>
<span class="sd">    :param handles: The handles of the objects to enter in the legend. Labels should be stored in the handles</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">handles</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">h</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">handles</span><span class="p">]</span>

    <span class="n">legendsettings</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="s2">&quot;center left&quot;</span><span class="p">,</span> <span class="s2">&quot;bbox_to_anchor&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="s2">&quot;ncol&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;framealpha&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
    <span class="c1">#    labels = [textwrap.fill(label, 16) for label in labels]</span>

    <span class="k">if</span> <span class="n">plot_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;stacked&quot;</span><span class="p">,</span> <span class="s2">&quot;proportion&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="o">**</span><span class="n">legendsettings</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="o">**</span><span class="n">legendsettings</span><span class="p">)</span>

    <span class="n">box</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">width</span> <span class="o">*</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>


<div class="viewcode-block" id="reorder_legend">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.reorder_legend.html#atomica.plotting.reorder_legend">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">reorder_legend</span><span class="p">(</span><span class="n">figs</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Change the order of an existing legend</span>

<span class="sd">    :param figs: Figure, or list of figures, containing legends for which the order should be changed</span>
<span class="sd">    :param order: Specification of the order in which to render the legend entries. This can be</span>
<span class="sd">                    - The string `&#39;reverse&#39;` which will reverse the order of the legend</span>
<span class="sd">                    - A list of indices mapping old position to new position. For example, if the</span>
<span class="sd">                        original label order was [&#39;a,&#39;b&#39;,&#39;c&#39;], then order=[1,0,2] would result in [&#39;b&#39;,&#39;a&#39;,&#39;c&#39;].</span>
<span class="sd">                        If a partial list is provided, then only a subset of the legend entries will appear. This</span>
<span class="sd">                        allows this function to be used to remove legend entries as well.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">fig</span> <span class="ow">in</span> <span class="n">figs</span><span class="p">:</span>  <span class="c1"># Apply order operation to all figures passed in</span>
            <span class="n">reorder_legend</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">figs</span>

    <span class="n">legend</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">findobj</span><span class="p">(</span><span class="n">Legend</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">_legend_handle_box</span><span class="o">.</span><span class="n">_children</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Only single-column legends are supported&quot;</span>
    <span class="n">vpacker</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">_legend_handle_box</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">order</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s2">&quot;reverse&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># matplotlib&lt;3.8</span>
            <span class="n">order</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="c1"># matplotlib&gt;=3.9</span>
            <span class="n">order</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">legend_handles</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="nb">max</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">vpacker</span><span class="o">.</span><span class="n">_children</span><span class="p">),</span> <span class="s2">&quot;Requested index greater than number of legend entries&quot;</span>

    <span class="n">new_children</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">order</span><span class="p">)):</span>
        <span class="n">new_children</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vpacker</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">order</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="n">vpacker</span><span class="o">.</span><span class="n">_children</span> <span class="o">=</span> <span class="n">new_children</span></div>



<div class="viewcode-block" id="relabel_legend">
<a class="viewcode-back" href="../../_autosummary/atomica.plotting.relabel_legend.html#atomica.plotting.relabel_legend">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">relabel_legend</span><span class="p">(</span><span class="n">figs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Change the labels on an existing legend</span>

<span class="sd">    :param figs: Figure, or list of figures, to change labels in</span>
<span class="sd">    :param labels: `list` of labels the same length as the number of legend labels OR a `dict` of labels where the key is the index</span>
<span class="sd">    of the labels to change. The `dict` input option makes it possible to change only a subset of the labels.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">figs</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">fig</span> <span class="ow">in</span> <span class="n">figs</span><span class="p">:</span>
            <span class="n">relabel_legend</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
        <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">figs</span>

    <span class="n">legend</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">findobj</span><span class="p">(</span><span class="n">Legend</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">legend</span><span class="o">.</span><span class="n">_legend_handle_box</span><span class="o">.</span><span class="n">_children</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Only single-column legends are supported&quot;</span>
    <span class="n">vpacker</span> <span class="o">=</span> <span class="n">legend</span><span class="o">.</span><span class="n">_legend_handle_box</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">vpacker</span><span class="o">.</span><span class="n">_children</span><span class="p">),</span> <span class="s2">&quot;If specifying list of labels, length must match number of legend entries&quot;</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="n">l</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">)}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">labels</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">assert</span> <span class="nb">max</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">vpacker</span><span class="o">.</span><span class="n">_children</span><span class="p">),</span> <span class="s2">&quot;Requested index greater than number of legend entries&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Labels must be a list or a dict&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">vpacker</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">_children</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">_text</span>
        <span class="n">text</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="n">label</span><span class="p">)</span></div>



<span class="k">def</span><span class="w"> </span><span class="nf">_get_full_name</span><span class="p">(</span><span class="n">code_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return the label of an object retrieved by name</span>

<span class="sd">    If a :class:`Project` has been provided, code names can be converted into</span>
<span class="sd">    labels for plotting. This function is different to `framework.get_label()` though,</span>
<span class="sd">    because it supports converting population names to labels as well (this information is</span>
<span class="sd">    in the project&#39;s data, not in the framework), and it also supports converting</span>
<span class="sd">    link syntax (e.g. `sus:vac`) into full names as well. Note also that this means that the strings</span>
<span class="sd">    returned by `_get_full_name` can be as specific as necessary for plotting.</span>

<span class="sd">    :param code_name: The code name for a variable (e.g. `&#39;sus&#39;`, `&#39;pris&#39;`, `&#39;sus:vac&#39;`)</span>
<span class="sd">    :param proj: Optionally specify a :class:`Project` instance</span>
<span class="sd">    :return: If a project was provided, returns the full name. Otherwise, just returns the code name</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">proj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">code_name</span>

    <span class="k">if</span> <span class="n">code_name</span> <span class="ow">in</span> <span class="n">proj</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pops</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">proj</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">code_name</span><span class="p">][</span><span class="s2">&quot;label&quot;</span><span class="p">]</span>  <span class="c1"># Convert population</span>

    <span class="k">if</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">code_name</span><span class="p">:</span>  <span class="c1"># We are parsing a link</span>
        <span class="c1"># Handle Links specified with colon syntax</span>
        <span class="n">output_tokens</span> <span class="o">=</span> <span class="n">code_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">output_tokens</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">output_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">src</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">par</span> <span class="o">=</span> <span class="n">output_tokens</span>

        <span class="c1"># If &#39;par_name:flow&#39; syntax was used</span>
        <span class="k">if</span> <span class="n">dest</span> <span class="o">==</span> <span class="s2">&quot;flow&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">proj</span><span class="o">.</span><span class="n">framework</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> (flow)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">proj</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="n">src</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;</span><span class="si">{0}</span><span class="s2"> (flow)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">src</span> <span class="ow">and</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">proj</span><span class="o">.</span><span class="n">framework</span><span class="p">:</span>
            <span class="n">src</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dest</span> <span class="ow">and</span> <span class="n">dest</span> <span class="ow">in</span> <span class="n">proj</span><span class="o">.</span><span class="n">framework</span><span class="p">:</span>
            <span class="n">dest</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">par</span> <span class="ow">and</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">proj</span><span class="o">.</span><span class="n">framework</span><span class="p">:</span>
            <span class="n">par</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="n">par</span><span class="p">)</span>

        <span class="n">full</span> <span class="o">=</span> <span class="s2">&quot;Flow&quot;</span>
        <span class="k">if</span> <span class="n">src</span><span class="p">:</span>
            <span class="n">full</span> <span class="o">+=</span> <span class="s2">&quot; from </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dest</span><span class="p">:</span>
            <span class="n">full</span> <span class="o">+=</span> <span class="s2">&quot; to </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">par</span><span class="p">:</span>
            <span class="n">full</span> <span class="o">+=</span> <span class="s2">&quot; (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">par</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">full</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">code_name</span> <span class="ow">in</span> <span class="n">proj</span><span class="o">.</span><span class="n">framework</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">proj</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="n">code_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">code_name</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_expand_dict</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">list</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Expand a dict with multiple keys into a list of single-key dicts</span>

<span class="sd">    An aggregation is defined as a mapping of multiple outputs into a single</span>
<span class="sd">    variable with a single label. This is represented by a dict with a single key,</span>
<span class="sd">    where the key is the label of the new quantity, and the value represents the instructions</span>
<span class="sd">    for how to compute the quantity. Sometimes outputs and pops are used directly, without</span>
<span class="sd">    renaming, so in this case, only the string representing the name of the quantity is required.</span>
<span class="sd">    Therefore, the format used internally by `PlotData` is that outputs/pops are represented</span>
<span class="sd">    as lists with length equal to the total number of quantities being returned/computed, and</span>
<span class="sd">    that list can contain dictionaries with single keys whenever an aggregation is required.</span>

<span class="sd">    For ease of use, it is convenient for users to enter multiple aggregations as a single dict</span>
<span class="sd">    with multiple keys. This function processes such a dict into the format used internally</span>
<span class="sd">    by PlotData.</span>


<span class="sd">    :param x: A list of inputs, containing strings or dicts that might have multiple keys</span>
<span class="sd">    :return: A list containing strings or dicts where any dicts have only one key</span>

<span class="sd">    Example usage:</span>

<span class="sd">    &gt;&gt;&gt; _expand_dict([&#39;a&#39;,{&#39;b&#39;:1,&#39;c&#39;:2}])</span>
<span class="sd">    [&#39;a&#39;, {&#39;b&#39;: 1}, {&#39;c&#39;: 2}]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If a list contains a dict with multiple keys, expand it into multiple dicts each</span>
    <span class="c1"># with a single key</span>
    <span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">y</span> <span class="o">+=</span> <span class="p">[{</span><span class="n">a</span><span class="p">:</span> <span class="n">b</span><span class="p">}</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="k">elif</span> <span class="n">sc</span><span class="o">.</span><span class="n">isstring</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unknown type&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_extract_labels</span><span class="p">(</span><span class="n">input_arrays</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract all quantities from list of dicts</span>

<span class="sd">    The inputs supported by `outputs` and `pops` can contain lists of optional</span>
<span class="sd">    aggregations. The first step in `PlotData` is to extract all of the quantities</span>
<span class="sd">    in the `Model` object that are required to compute the requested aggregations.</span>

<span class="sd">    :param input_arrays: Input string, list, or dict specifying aggregations</span>
<span class="sd">    :return: Set of unique string values that correspond to model quantities</span>

<span class="sd">    Example usage:</span>

<span class="sd">    &gt;&gt;&gt; _extract_labels([&#39;vac&#39;,{&#39;a&#39;:[&#39;vac&#39;,&#39;sus&#39;]}])</span>
<span class="sd">    set([&#39;vac&#39;,&#39;sus&#39;])</span>

<span class="sd">    The main workflow is:</span>

<span class="sd">    [&#39;vac&#39;,{&#39;a&#39;:[&#39;vac&#39;,&#39;sus&#39;]}] -&gt; [&#39;vac&#39;,&#39;vac&#39;,&#39;sus&#39;] -&gt; set([&#39;vac&#39;,&#39;sus&#39;])</span>

<span class="sd">    i.e. first a flat list is constructed by replacing any dicts with their values</span>
<span class="sd">    and concatenating, then the list is converted into a set</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">input_arrays</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Aggregation dict can only have one key, for multiple aggregations, use a list of dicts&quot;</span>
            <span class="k">if</span> <span class="n">sc</span><span class="o">.</span><span class="n">isstring</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]]):</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Atomica Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>