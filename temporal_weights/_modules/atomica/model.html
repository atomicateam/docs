<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>atomica.model &mdash; Atomica  documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Atomica
          </a>
              <div class="version">
                1.28.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../general/index.html">General content</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../general/Compartment-Initialization.html">Initializing compartments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/Compartment-Initialization.html#characteristics-to-compartments">Characteristics to Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/Compartment-Initialization.html#problems-and-solutions">Problems and solutions</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../general/Compartment-Initialization.html#negative-initial-compartment-sizes">Negative initial compartment sizes</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../general/Compartment-Initialization.html#underdetermined-system">Underdetermined system</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../general/Compartment-Initialization.html#inconsistent-system">Inconsistent system</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../general/Compartment-Initialization.html#inconsistent-overdetermined-system">Inconsistent overdetermined system</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../general/Compartment-Initialization.html#resolving-inconsistencies-initialization-weight">Resolving inconsistencies - initialization weight</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Compartment-Initialization.html#computing-initial-values-at-arbitrary-times">Computing initial values at arbitrary times</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../general/Contextual-Overview.html">Contextual overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../general/File-Logging.html">Logging cookbook</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/File-Logging.html#changing-the-amount-of-output">Changing the amount of output</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/File-Logging.html#dumping-output-to-a-log-file">Dumping output to a log file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../general/Optimization.html">Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/Optimization.html#optimization-class"><code class="docutils literal notranslate"><span class="pre">Optimization</span></code> class</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#performing-an-optimization">Performing an optimization</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Optimization.html#adjustments">Adjustments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#implementation-specifics">Implementation specifics</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Optimization.html#constraints">Constraints</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#id1">Implementation specifics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#total-spending-constraint">Total spending constraint</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Optimization.html#measurables">Measurables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#measurables-vs-constraints">Measurables vs. constraints</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Optimization.html#optimization-examples">Optimization examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#maximize-people-alive">Maximize people alive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#minimize-deaths">Minimize deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/Optimization.html#minimize-spending">Minimize spending</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Optimization.html#optimization-calling-structure">Optimization calling structure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../general/Parameters.html">Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#types-of-parameter">Types of parameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#value-precedence">Value precedence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#performance-considerations">Performance considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#timescales">Timescales</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#derivatives">Derivatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#interpolation-and-smoothing">Interpolation and smoothing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/Parameters.html#maximum-compartment-duration">Maximum compartment duration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../general/junctions/Junctions.html">Junction overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../general/population-types/Population-Types.html">Population types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/population-types/Population-Types.html#framework-population-types">Framework population types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/population-types/Population-Types.html#databook-population-types">Databook population types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/population-types/Population-Types.html#programs-and-population-types">Programs and population types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/population-types/Population-Types.html#running-simulations">Running simulations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/population-types/Population-Types.html#plotting">Plotting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../general/programs/Programs.html">Program System</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/programs/Programs.html#data-and-structural-overview">Data and structural overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/programs/Programs.html#coverage-computation">Coverage computation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/programs/Programs.html#capacity">Capacity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/programs/Programs.html#coverage">Coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/programs/Programs.html#number-covered">Number covered</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/programs/Programs.html#outcome-computation">Outcome computation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/programs/Programs.html#coverage-interaction">Coverage interaction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/programs/Programs.html#impact-interactions">Impact interactions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/programs/Programs.html#parameters-in-number-units">Parameters in Number units</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/programs/Programs.html#targeting-transfers">Targeting transfers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../general/skipping-excel-cells.html">Skipping Excel cells</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/skipping-excel-cells.html#General-principles">General principles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/skipping-excel-cells.html#Frameworks">Frameworks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/skipping-excel-cells.html#Databooks">Databooks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/skipping-excel-cells.html#TimeDependentConnections">TimeDependentConnections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/skipping-excel-cells.html#TimeDependentValuesEntry">TimeDependentValuesEntry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/skipping-excel-cells.html#Program-books">Program books</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/skipping-excel-cells.html#Program-targeting">Program targeting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/skipping-excel-cells.html#Spending-data">Spending data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../general/skipping-excel-cells.html#Program-effects">Program effects</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../general/stochastic/stochastic.html">Stochastic models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html">Timed transitions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#motivation">Motivation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#use-cases">Use cases</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#basic-implementation">Basic implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#initialization">Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#normal-transitions">Normal transitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#duration-groups">Duration groups</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#architecture">Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#transfers">Transfers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../general/timed-transitions/Timed-Transitions.html#junctions">Junctions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Basic-workflow.html">Basic workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Basic-workflow.html#Starting-an-application">Starting an application</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Basic-workflow.html#Creating-a-project">Creating a project</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Basic-workflow.html#Calibrating-the-model">Calibrating the model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Basic-workflow.html#Manual-calibration">Manual calibration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Basic-workflow.html#Automatic-calibration">Automatic calibration</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Basic-workflow.html#Adding-programs">Adding programs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Basic-workflow.html#Reconciliation">Reconciliation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Basic-workflow.html#Scenarios">Scenarios</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Basic-workflow.html#Parameter-scenarios">Parameter scenarios</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Basic-workflow.html#Budget-scenarios">Budget scenarios</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Basic-workflow.html#Coverage-scenarios">Coverage scenarios</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Basic-workflow.html#Optimization">Optimization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/databooks/Databooks.html">Data and Databooks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/databooks/Databooks.html#TimeSeries-objects"><code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code> objects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Population-table">Population table</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#TimeDependentConnections">TimeDependentConnections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#TimeDependentValuesEntry">TimeDependentValuesEntry</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/databooks/Databooks.html#Modifying-databooks">Modifying databooks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Creating-a-blank-databook">Creating a blank databook</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Pre-populating-data">Pre-populating data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Adding-a-variable">Adding a variable</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Removing-a-variable">Removing a variable</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Add/remove-populations">Add/remove populations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Add/remove-transfers-and-interactions">Add/remove transfers and interactions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Changing-databook-years">Changing databook years</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/databooks/Databooks.html#Further-spreadsheet-modification">Further spreadsheet modification</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Frameworks.html">Frameworks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Frameworks.html#ProjectFramework-basics"><code class="docutils literal notranslate"><span class="pre">ProjectFramework</span></code> basics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Frameworks.html#Accessing-the-data">Accessing the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Frameworks.html#Exporting-a-Framework">Exporting a Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Frameworks.html#Making-a-new-Framework">Making a new Framework</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Frameworks.html#Validating-the-input">Validating the input</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Frameworks.html#Adding-a-quantity-to-the-Framework">Adding a quantity to the Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Frameworks.html#Convenience-methods">Convenience methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Frameworks.html#Iterating-over-items">Iterating over items</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Model-dev.html">Models (implementation)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Model-dev.html#Model-object-structure">Model object structure</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-dev.html#Compartment">Compartment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-dev.html#Link">Link</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-dev.html#Characteristic">Characteristic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-dev.html#Parameter">Parameter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-dev.html#Population">Population</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-dev.html#Model">Model</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Model-dev.html#Building">Building</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Model-dev.html#Integrating">Integrating</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-dev.html#Linking-and-unlinking">Linking and unlinking</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Model-user.html">Results and Models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Model-user.html#Pre-specified-plots">Pre-specified plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Model-user.html#Exporting-results">Exporting results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Model-user.html#Exporting-raw-results">Exporting raw results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Model-user.html#Accessing-raw-values">Accessing raw values</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Model-user.html#Traversing-the-graph">Traversing the graph</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/ode_models/ode_models.html">Comparison with ODEs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Plotting.html">Plotting Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Quick-Reference">Quick Reference</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Just-give-me-a-plot">Just give me a plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#FAQs">FAQs</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Plotting.html#Data-manipulation">Data manipulation</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Plotting.html#General-issues">General issues</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Plotting.html#Bar-graphs">Bar graphs</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Plotting.html#Legends">Legends</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Plotting-system-design">Plotting system design</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Data-preparation-and-aggregation">Data preparation and aggregation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Function-aggregations">Function aggregations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Axis-units">Axis units</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Flow-rate-aggregations-and-disaggregations">Flow rate aggregations and disaggregations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Plotting-series">Plotting series</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Overriding-data">Overriding data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Stacked-plots-and-data">Stacked plots and data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Plotting-transition-parameters-and-flow-rates">Plotting transition parameters and flow rates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Setting-full-names">Setting full names</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Further-formatting">Further formatting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Module-level-settings-and-separate-legends">Module-level settings and separate legends</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Time-accumulation">Time accumulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Subplots">Subplots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Saving-figures">Saving figures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Plotting-bars">Plotting bars</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Time-aggregation">Time aggregation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Stacking-bars">Stacking bars</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Negative-values">Negative values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Horizontal-bars">Horizontal bars</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Labelling-bars">Labelling bars</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Working-with-legends">Working with legends</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Controlling-legend-order">Controlling legend order</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Relabeling-legend-entries">Relabeling legend entries</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Making-a-new-legend">Making a new legend</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Time-aggregation-options">Time aggregation options</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Flow-rates">Flow rates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plotting.html#Setting-colors">Setting colors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plotting.html#Colour-design-patterns">Colour design patterns</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Plot-Programs.html">Plotting programs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plot-Programs.html#Creating-PlotData-from-programs">Creating <code class="docutils literal notranslate"><span class="pre">PlotData</span></code> from programs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plot-Programs.html#Plotting-spending-and-coverage">Plotting spending and coverage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plot-Programs.html#Bar-plots-and-selecting-times">Bar plots and selecting times</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plot-Programs.html#Time-aggregation">Time aggregation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Plot-Programs.html#Output-aggregation">Output aggregation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Plot-Units.html">Plot unit conversions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plot-Units.html#Parameters">Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Plot-Units.html#Programs">Programs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Probability-Rescaling.html">Probability rescaling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Probability-Rescaling.html#Geometric-vs-Exponential-distribution-for-durations">Geometric vs Exponential distribution for durations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Probability-Rescaling.html#Preserving-durations-vs-preserving-annual-flows">Preserving durations vs preserving annual flows</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Probability-Rescaling.html#Atomica-models">Atomica models</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Probability-Rescaling.html#Conclusions">Conclusions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Scenarios.html">Scenarios</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Scenarios.html#Parameter-scenarios">Parameter scenarios</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Scenarios.html#Using-the-ParameterScenario-class">Using the <code class="docutils literal notranslate"><span class="pre">ParameterScenario</span></code> class</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Scenarios.html#Scenario-start-year">Scenario start year</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Scenarios.html#Scenario-end-year">Scenario end year</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Scenarios.html#Smoothing">Smoothing</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Scenarios.html#Step-changes">Step changes</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Scenarios.html#Parameter-interpolation-prior-to-the-start-year">Parameter interpolation prior to the start year</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../examples/Scenarios.html#Inspecting-the-ParameterSet">Inspecting the <code class="docutils literal notranslate"><span class="pre">ParameterSet</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Scenarios.html#Modifying-a-ParameterSet">Modifying a <code class="docutils literal notranslate"><span class="pre">ParameterSet</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Scenarios.html#Overwriting-function-parameters">Overwriting function parameters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/Uncertainty.html">Uncertainty</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Uncertainty.html#Specifying-uncertainty">Specifying uncertainty</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Uncertainty.html#Sampling-inputs">Sampling inputs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Uncertainty.html#Analysis">Analysis</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Uncertainty.html#Basic-plotting">Basic plotting</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Uncertainty.html#Comparing-sampled-results">Comparing sampled results</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Uncertainty.html#Distributions-of-differences-between-results">Distributions of differences between results</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Uncertainty.html#Cascade-ensembles">Cascade ensembles</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../examples/Uncertainty.html#Virtual-stages">Virtual stages</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Uncertainty.html#Memory-limited-environments">Memory-limited environments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Uncertainty.html#Parallization">Parallization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/Uncertainty.html#Experimental-plots">Experimental plots</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../examples/override_cost_coverage/override_cost_coverage.html">Overriding coverage calculations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../examples/override_cost_coverage/override_cost_coverage.html#Add-a-new-population-type">Add a new population type</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../examples/override_cost_coverage/override_cost_coverage.html#Overwriting-coverage">Overwriting coverage</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Tutorials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/T1-Defining-a-model.html">T1 - Defining a model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T1-Defining-a-model.html#Generating-a-databook">Generating a databook</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T1-Defining-a-model.html#Exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/T2-Calibration.html">T2 - Calibration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T2-Calibration.html#Calibration-tips">Calibration tips</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/T3-Multiple-populations.html">T3 - Multiple populations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T3-Multiple-populations.html#Transfers">Transfers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T3-Multiple-populations.html#Interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T3-Multiple-populations.html#Exercises">Exercises</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/T4-Characteristics.html">T4 - Characteristics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/T5-Junctions.html">T5 - Junctions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T5-Junctions.html#Exercise">Exercise</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/T6-Programs.html">T6 - Programs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T6-Programs.html#Reconciliation">Reconciliation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T6-Programs.html#Common-intervention-types">Common intervention types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../tutorial/T6-Programs.html#Vaccines">Vaccines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorial/T6-Programs.html#Diagnosis-screening-program">Diagnosis screening program</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorial/T6-Programs.html#Diagnosis">Diagnosis</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorial/T6-Programs.html#Screening-with-confirmatory-test">Screening with confirmatory test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorial/T6-Programs.html#One-off-treatment">One-off treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tutorial/T6-Programs.html#Sustained-treatment">Sustained treatment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/T6-Programs.html#Exercise">Exercise</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../library/index.html">Model library</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../library/cervicalcancer.html">Cervical cancer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/cervicalcancer.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/cervicalcancer.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-source">Compartment: Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-without-cervical-cancer">Compartment: Without cervical cancer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-screened">Compartment: Screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-treated">Compartment: Treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-dead-other">Compartment: Dead (other)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#compartment-dead-cervical-cancer">Compartment: Dead (cervical cancer)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/cervicalcancer.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#characteristic-population-size">Characteristic: Population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#characteristic-estimated-number-of-women-with-cervical-cancer">Characteristic: Estimated number of women with cervical cancer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#characteristic-estimated-number-of-women-with-cervical-cancer-who-have-ever-been-screened">Characteristic: Estimated number of women with cervical cancer who have ever been screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#characteristic-estimated-number-of-women-with-cervical-cancer-who-have-ever-been-diagnosed">Characteristic: Estimated number of women with cervical cancer who have ever been diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#characteristic-estimated-number-of-women-being-treated-for-cervical-cancer">Characteristic: Estimated number of women being treated for cervical cancer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/cervicalcancer.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-annual-number-of-births">Parameter: Annual number of births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-estimated-number-of-new-cervical-cancer-cases-annually">Parameter: Estimated number of new cervical cancer cases annually</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-acquisition-rate">Parameter: Acquisition rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-annual-number-screened">Parameter: Annual number screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-screening-yield">Parameter: Screening yield</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-annual-number-screened-positive">Parameter: Annual number screened positive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-screening-sensitivity">Parameter: Screening sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-probability-of-a-positive-confirmation-following-screening">Parameter: Probability of a positive confirmation following screening</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-mortality-rate">Parameter: Mortality rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#parameter-mortality-rate-for-those-with-untreated-cervical-cancer">Parameter: Mortality rate for those with untreated cervical cancer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/cervicalcancer.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/cervicalcancer.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/cervicalcancer.html#cascade-cervical-cancer-cascade">Cascade: Cervical cancer cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/diabetes.html">Diabetes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/diabetes.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/diabetes.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-source">Compartment: Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-susceptible">Compartment: Susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-unaware-uncomplicated">Compartment: Unaware &amp; uncomplicated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-unaware-vascular-damage">Compartment: Unaware &amp; vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-screened-uncomplicated">Compartment: Screened &amp; uncomplicated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-screened-vascular-damage">Compartment: Screened &amp; vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-diagnosed-uncomplicated">Compartment: Diagnosed &amp; uncomplicated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-diagnosed-vascular-damage">Compartment: Diagnosed &amp; vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-successful-treatment-uncomplicated">Compartment: Successful treatment &amp; uncomplicated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-successful-treatment-vascular-damage">Compartment: Successful treatment &amp; vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-treatment-failure-uncomplicated">Compartment: Treatment failure &amp; uncomplicated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-treatment-failure-vascular-damage">Compartment: Treatment failure &amp; vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-dead-diabetes">Compartment: Dead (diabetes)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#compartment-dead-other">Compartment: Dead (other)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/diabetes.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-population-size">Characteristic: Population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-all-people-with-t2dm">Characteristic: All people with T2DM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-people-screened-for-t2dm">Characteristic: People screened for T2DM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-people-diagnosed-with-t2dm">Characteristic: People diagnosed with T2DM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-people-treated-for-t2dm">Characteristic: People treated for T2DM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-people-with-hba1c-control">Characteristic: People with HbA1c control</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-proportion-screened-for-t2dm">Characteristic: Proportion screened for T2DM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-proportion-diagnosed-with-t2dm">Characteristic: Proportion diagnosed with T2DM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-proportion-treated-for-t2dm">Characteristic: Proportion treated for T2DM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#characteristic-proportion-with-hba1c-control">Characteristic: Proportion with HbA1c control</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/diabetes.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-annual-number-of-births">Parameter: Annual number of births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-estimated-number-of-new-diabetes-cases-annually">Parameter: Estimated number of new diabetes cases annually</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-acquisition-rate">Parameter: Acquisition rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-time-before-progression-to-vascular-damage">Parameter: Time before progression to vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-annual-number-screened">Parameter: Annual number screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-yield-among-those-screened">Parameter: Yield among those screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-annual-number-screened-positive">Parameter: Annual number screened positive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-screening-sensitivity">Parameter: Screening sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-diagnosis-sensitivity">Parameter: Diagnosis sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-treatment-failure-rate">Parameter: Treatment failure rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-proportion-of-those-experiencing-treatment-failure-who-are-offered-support">Parameter: Proportion of those experiencing treatment failure who are offered support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-death-rate-for-diabetes-with-vascular-damage">Parameter: Death rate for diabetes with vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#parameter-background-mortality-rate">Parameter: Background mortality rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/diabetes.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/diabetes.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#cascade-diabetes-care-cascade">Cascade: Diabetes care cascade</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#cascade-diabetes-care-cascade-vascular-damage">Cascade: Diabetes care cascade - vascular damage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/diabetes.html#cascade-diabetes-care-cascade-uncomplicated-cases">Cascade: Diabetes care cascade - uncomplicated cases</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/dt.html">Diagnosis-Treated</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/dt.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/dt.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#compartment-diagnosed-not-treated">Compartment: Diagnosed, not treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#compartment-treated">Compartment: Treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/dt.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#characteristic-all-diagnosed">Characteristic: All diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/dt.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#parameter-annual-number-lost-to-follow-up">Parameter: Annual number lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#parameter-proportion-of-those-on-treatment-lost-to-follow-up">Parameter: Proportion of those on treatment lost-to-follow-up</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/dt.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/dt.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/dt.html#cascade-cascade">Cascade: Cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/hiv.html">HIV without dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#compartment-linked-to-care">Compartment: Linked to care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#compartment-treated">Compartment: Treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#compartment-lost-to-follow-up">Compartment: Lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#compartment-virally-suppressed-comp">Compartment: Virally suppressed (comp)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#characteristic-all-plhiv">Characteristic: All PLHIV</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#characteristic-aware-of-their-status">Characteristic: Aware of their status</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#characteristic-ever-in-care">Characteristic: Ever in care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#characteristic-currently-in-care">Characteristic: Currently in care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#characteristic-virally-suppressed">Characteristic: Virally suppressed</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-diagnosis-rate">Parameter: Diagnosis rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-average-time-taken-to-be-linked-to-care-years">Parameter: Average time taken to be linked to care (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-time-after-initiating-art-to-achieve-viral-suppression-years">Parameter: Time after initiating ART to achieve viral suppression (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#parameter-treatment-failure-rate">Parameter: Treatment failure rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv.html#cascade-main">Cascade: main</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/hiv_dyn.html">HIV with dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv_dyn.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv_dyn.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-source">Compartment: Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-susceptible">Compartment: Susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-linked-to-care">Compartment: Linked to care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-treated">Compartment: Treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-lost-to-follow-up">Compartment: Lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-virally-suppressed-comp">Compartment: Virally suppressed (comp)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-dead-hiv-aids">Compartment: Dead (HIV/AIDS)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#compartment-dead-other">Compartment: Dead (other)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv_dyn.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#characteristic-population-size">Characteristic: Population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#characteristic-all-plhiv">Characteristic: All PLHIV</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#characteristic-aware-of-their-status">Characteristic: Aware of their status</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#characteristic-ever-in-care">Characteristic: Ever in care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#characteristic-currently-in-care">Characteristic: Currently in care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#characteristic-virally-suppressed">Characteristic: Virally suppressed</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv_dyn.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-annual-number-of-births">Parameter: Annual number of births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-estimated-number-of-new-hiv-infections-annually">Parameter: Estimated number of new HIV infections annually</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-acquisition-rate">Parameter: Acquisition rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-annual-number-of-tests-done">Parameter: Annual number of tests done</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-test-yield">Parameter: Test yield</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-annual-number-tested-positive">Parameter: Annual number tested positive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-test-sensitivity">Parameter: Test sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-average-time-taken-to-be-linked-to-care-years">Parameter: Average time taken to be linked to care (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-time-after-initiating-art-to-achieve-viral-suppression-years">Parameter: Time after initiating ART to achieve viral suppression (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-treatment-failure-rate">Parameter: Treatment failure rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-death-rate-for-those-with-untreated-hiv">Parameter: Death rate for those with untreated HIV</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-death-rate-for-those-with-on-unsuppressive-art">Parameter: Death rate for those with on unsuppressive ART</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-death-rate-for-those-with-on-suppressive-art">Parameter: Death rate for those with on suppressive ART</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#parameter-background-mortality-rate">Parameter: Background mortality rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv_dyn.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hiv_dyn.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hiv_dyn.html#cascade-hiv-care-cascade">Cascade: HIV care cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/hypertension.html">Hypertension</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#compartment-screened">Compartment: Screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#compartment-treated">Compartment: Treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#compartment-controlled">Compartment: Controlled</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#characteristic-all-people-with-condition">Characteristic: All people with condition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#characteristic-screened-people">Characteristic: Screened people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#characteristic-diagnosed-people">Characteristic: Diagnosed people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#characteristic-blood-pressure-controlled">Characteristic: Blood pressure controlled</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-annual-number-screened">Parameter: Annual number screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-screening-rate">Parameter: Screening rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-diagnosis-rate">Parameter: Diagnosis rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-time-after-initiating-treatment-to-achieve-bp-control-years">Parameter: Time after initiating treatment to achieve BP control (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#parameter-treatment-failure-rate">Parameter: Treatment failure rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension.html#cascade-main">Cascade: main</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/hypertension_dyn.html">Hypertension with dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension_dyn.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension_dyn.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-source">Compartment: Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-no-hypertension">Compartment: No hypertension</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-screened-not-diagnosed">Compartment: Screened, not diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-diagnosed-not-treated">Compartment: Diagnosed, not treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-treated-not-controlled">Compartment: Treated, not controlled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-controlled">Compartment: Controlled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-dead-hypertension">Compartment: Dead (hypertension)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#compartment-dead-other">Compartment: Dead (other)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension_dyn.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#characteristic-population-size">Characteristic: Population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#characteristic-all-people-with-condition">Characteristic: All people with condition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#characteristic-screened-people">Characteristic: Screened people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#characteristic-diagnosed-people">Characteristic: Diagnosed people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#characteristic-blood-pressure-controlled">Characteristic: Blood pressure controlled</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension_dyn.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-annual-number-of-births">Parameter: Annual number of births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-estimated-number-of-new-cases-annually">Parameter: Estimated number of new cases annually</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-acquisition-rate">Parameter: Acquisition rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-annual-number-screened">Parameter: Annual number screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-target-population-for-screening-programs">Parameter: Target population for screening programs</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-screening-coverage-shares">Parameter: Screening coverage shares</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-screening-yield">Parameter: Screening yield</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-annual-number-screened-positive">Parameter: Annual number screened positive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-time-after-initiating-treatment-to-achieve-bp-control-years">Parameter: Time after initiating treatment to achieve BP control (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-treatment-failure-rate">Parameter: Treatment failure rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-death-rate-for-those-with-untreated-hypertension">Parameter: Death rate for those with untreated hypertension</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#parameter-background-mortality-rate">Parameter: Background mortality rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension_dyn.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/hypertension_dyn.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/hypertension_dyn.html#cascade-hypertension-care-cascade">Cascade: Hypertension care cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/service.html">Service modalities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/service.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/service.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#compartment-source">Compartment: Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#compartment-unaware-of-own-need">Compartment: Unaware of own need</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#compartment-aware-but-not-linked-to-services">Compartment: Aware but not linked to services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#compartment-linked-to-service-provider">Compartment: Linked to service provider</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#compartment-receiving-services">Compartment: Receiving services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#compartment-successful-outcome">Compartment: Successful outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#compartment-dead">Compartment: Dead</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/service.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-all-people">Characteristic: All people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-people-aware-of-need">Characteristic: People aware of need</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-people-linked-to-services">Characteristic: People linked to services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-people-receiving-services">Characteristic: People receiving services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-people-with-successful-outcomes">Characteristic: People with successful outcomes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-proportion-aware-of-need">Characteristic: Proportion aware of need</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-proportion-linked-to-services">Characteristic: Proportion linked to services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-proportion-receiving-services">Characteristic: Proportion receiving services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#characteristic-proportion-with-successful-outcomes">Characteristic: Proportion with successful outcomes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/service.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#parameter-number-of-new-cases-annual">Parameter: Number of new cases (annual)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#parameter-number-becoming-aware-of-need-annual">Parameter: Number becoming aware of need (annual)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#parameter-number-linked-to-services-annual">Parameter: Number linked to services (annual)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#parameter-number-initiated-onto-services-annual">Parameter: Number initiated onto services (annual)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#parameter-proportion-of-those-without-successful-outcomes-who-are-offered-further-support">Parameter: Proportion of those without successful outcomes who are offered further support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#parameter-probability-of-successful-outcome-among-those-receiving-services">Parameter: Probability of successful outcome among those receiving services</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#parameter-background-mortality-rate">Parameter: Background mortality rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/service.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/service.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/service.html#cascade-main">Cascade: main</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/sir.html">SIR model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/sir.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/sir.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#compartment-susceptible">Compartment: Susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#compartment-infected">Compartment: Infected</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#compartment-recovered">Compartment: Recovered</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#compartment-dead">Compartment: Dead</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/sir.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-total-number-of-entities">Characteristic: Total number of entities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-prevalence">Characteristic: Prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-number-ever-infected">Characteristic: Number ever infected</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-number-infected-or-susceptible">Characteristic: Number infected or susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-number-not-at-risk-of-death">Characteristic: Number not at risk of death</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-proportion-ever-infected">Characteristic: Proportion ever infected</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-proportion-infected-or-susceptible">Characteristic: Proportion infected or susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#characteristic-proportion-not-at-risk-of-death">Characteristic: Proportion not at risk of death</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/sir.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#parameter-transmission-probability-per-contact">Parameter: Transmission probability per contact</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#parameter-number-of-contacts-annually">Parameter: Number of contacts annually</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#parameter-average-duration-of-infections-years">Parameter: Average duration of infections (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#parameter-death-rate-for-infected-people">Parameter: Death rate for infected people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#parameter-death-rate-for-susceptible-people">Parameter: Death rate for susceptible people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#parameter-force-of-infection">Parameter: Force of infection</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/sir.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/sir.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/sir.html#cascade-main">Cascade: main</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/tb.html">TB full model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-initialization-population-size">Compartment: Initialization population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-susceptible">Compartment: Susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-vaccinated">Compartment: Vaccinated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-early-latent-untreated-diagnosable">Compartment: Early latent untreated (diagnosable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-early-latent-on-treatment">Compartment: Early latent on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-latent-early-treatment-outcome">Compartment: Junction: Latent early treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-late-latent-untreated-diagnosable">Compartment: Late latent untreated (diagnosable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-late-latent-on-treatment">Compartment: Late latent on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-latent-late-treatment-outcome">Compartment: Junction: Latent late treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-susceptible-diagnosis-restricted">Compartment: Susceptible (diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-early-latent-untreated-diagnosis-restricted">Compartment: Early latent untreated (diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-late-latent-untreated-diagnosis-restricted">Compartment: Late latent untreated (diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-smear-disaggregator-for-new-active">Compartment: Junction: Smear disaggregator for new active</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-strain-disaggregator-for-new-smear-positive">Compartment: Junction: Strain disaggregator for new smear positive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-ds-undiagnosed">Compartment: SP-DS undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-ds-diagnosed-but-not-on-treatment">Compartment: SP-DS diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-ds-on-treatment">Compartment: SP-DS on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-sp-ds-treatment-outcome">Compartment: Junction: SP-DS treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-mdr-undiagnosed">Compartment: SP-MDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-mdr-diagnosed-but-not-on-treatment">Compartment: SP-MDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-mdr-on-treatment">Compartment: SP-MDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-sp-mdr-treatment-outcome">Compartment: Junction: SP-MDR treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-xdr-undiagnosed">Compartment: SP-XDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-xdr-diagnosed-but-not-on-treatment">Compartment: SP-XDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sp-xdr-on-treatment">Compartment: SP-XDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-sp-xdr-treatment-outcome">Compartment: Junction: SP-XDR treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-strain-disaggregator-for-new-smear-negative">Compartment: Junction: Strain disaggregator for new smear negative</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-ds-undiagnosed">Compartment: SN-DS undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-ds-diagnosed-but-not-on-treatment">Compartment: SN-DS diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-ds-on-treatment">Compartment: SN-DS on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-sn-ds-treatment-outcome">Compartment: Junction: SN-DS treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-mdr-undiagnosed">Compartment: SN-MDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-mdr-diagnosed-but-not-on-treatment">Compartment: SN-MDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-mdr-on-treatment">Compartment: SN-MDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-sn-mdr-treatment-outcome">Compartment: Junction: SN-MDR treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-xdr-undiagnosed">Compartment: SN-XDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-xdr-diagnosed-but-not-on-treatment">Compartment: SN-XDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sn-xdr-on-treatment">Compartment: SN-XDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-sn-xdr-treatment-outcome">Compartment: Junction: SN-XDR treatment outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-completed-treatment-active">Compartment: Completed treatment (active)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-source-origin-of-births">Compartment: Source: Origin of births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-source-origin-of-immigration">Compartment: Source: Origin of immigration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-junction-infection-status-of-immigrants">Compartment: Junction: Infection status of immigrants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sink-cumulative-tb-deaths-over-simulation">Compartment: Sink: Cumulative TB deaths over simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sink-cumulative-non-tb-deaths-over-simulation">Compartment: Sink: Cumulative non-TB deaths over simulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#compartment-sink-cumulative-emigration-over-simulation">Compartment: Sink: Cumulative emigration over simulation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-latent-tb-infections-on-treatment">Characteristic: Latent TB infections on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-diagnosis-restricted-latent-infections">Characteristic: Suspected diagnosis restricted latent infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-undiagnosed-latent-infections">Characteristic: Suspected undiagnosed latent infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-early-latent-infections">Characteristic: Suspected early latent infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-late-latent-infections">Characteristic: Suspected late latent infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-latent-infections">Characteristic: Suspected latent infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-known-sp-ds-infections">Characteristic: Known SP-DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-known-sp-mdr-infections">Characteristic: Known SP-MDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-known-sp-xdr-infections">Characteristic: Known SP-XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-known-sn-ds-infections">Characteristic: Known SN-DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-known-sn-mdr-infections">Characteristic: Known SN-MDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-known-sn-xdr-infections">Characteristic: Known SN-XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-known-active-tb-infections">Characteristic: Known active TB infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-diagnosed-number-of-living-people-that-developed-active-tb">Characteristic: Diagnosed number of living people that developed active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-ds-infections">Characteristic: Suspected SP-DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-md-infections">Characteristic: Suspected SP-MD infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-xdr-infections">Characteristic: Suspected SP-XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-ds-infections">Characteristic: Suspected SN-DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-mdr-infections">Characteristic: Suspected SN-MDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-xdr-infections">Characteristic: Suspected SN-XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-infections">Characteristic: Suspected SP infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-infections">Characteristic: Suspected SN infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-estimated-number-of-people-with-ds-tb">Characteristic: Estimated number of people with DS TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-estimated-number-of-people-with-mdr-tb">Characteristic: Estimated number of people with MDR TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-estimated-number-of-people-with-xdr-tb">Characteristic: Estimated number of people with XDR TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-estimated-number-of-people-with-dr-tb">Characteristic: Estimated number of people with DR TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-estimated-number-of-people-with-active-tb">Characteristic: Estimated number of people with active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-estimated-number-of-living-people-that-developed-active-tb">Characteristic: Estimated number of living people that developed active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-population-size">Characteristic: Population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sp-ds-infections">Characteristic: Suspected untreated SP-DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sp-mdr-infections">Characteristic: Suspected untreated SP-MDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sp-xdr-infections">Characteristic: Suspected untreated SP-XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sn-ds-infections">Characteristic: Suspected untreated SN-DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sn-mdr-infections">Characteristic: Suspected untreated SN-MDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sn-xdr-infections">Characteristic: Suspected untreated SN-XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sp-ds-prevalence">Characteristic: Suspected untreated SP-DS prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sp-mdr-prevalence">Characteristic: Suspected untreated SP-MDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sp-xdr-prevalence">Characteristic: Suspected untreated SP-XDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sn-ds-prevalence">Characteristic: Suspected untreated SN-DS prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sn-mdr-prevalence">Characteristic: Suspected untreated SN-MDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-untreated-sn-xdr-prevalence">Characteristic: Suspected untreated SN-XDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-ltbi-prevalence">Characteristic: Suspected LTBI prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-ds-prevalence">Characteristic: Suspected SP-DS prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-mdr-prevalence">Characteristic: Suspected SP-MDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-xdr-prevalence">Characteristic: Suspected SP-XDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-ds-prevalence">Characteristic: Suspected SN-DS prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-mdr-prevalence">Characteristic: Suspected SN-MDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-xdr-prevalence">Characteristic: Suspected SN-XDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sp-prevalence">Characteristic: Suspected SP prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-sn-prevalence">Characteristic: Suspected SN prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-ds-prevalence">Characteristic: Suspected DS prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-dr-prevalence">Characteristic: Suspected DR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-mdr-prevalence">Characteristic: Suspected MDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-xdr-prevalence">Characteristic: Suspected XDR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-active-tb-prevalence">Characteristic: Suspected active TB prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-undiagnosed-ds-infections">Characteristic: Suspected undiagnosed DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-undiagnosed-mdr-infections">Characteristic: Suspected undiagnosed MDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-suspected-undiagnosed-xdr-infections">Characteristic: Suspected undiagnosed XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-diagnosed-ds-infections">Characteristic: Diagnosed DS infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-diagnosed-mdr-infections">Characteristic: Diagnosed MDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-diagnosed-xdr-infections">Characteristic: Diagnosed XDR infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-ds-cases-on-treatment">Characteristic: DS cases on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-mdr-cases-on-treatment">Characteristic: MDR cases on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-xdr-cases-on-treatment">Characteristic: XDR cases on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-active-tb-cases-on-treatment">Characteristic: Active TB cases on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-number-of-living-people-that-have-recovered-from-active-tb-in-the-previous-2-years">Characteristic: Number of living people that have recovered from active TB in the previous 2 years</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-diagnosis-sufficiency-known-versus-suspected-infections">Characteristic: Diagnosis sufficiency (known versus suspected infections)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#characteristic-treatment-sufficiency-on-treatment-versus-known-infections">Characteristic: Treatment sufficiency (on-treatment versus known infections)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-the-population-with-active-tb">Parameter: Initialization proportion of the population with active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-the-population-with-latent-tb">Parameter: Initialization proportion of the population with latent TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-latent-tb-cases-that-are-early-latent">Parameter: Initialization proportion of latent TB cases that are early latent</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-latent-tb-cases-that-are-on-treatment">Parameter: Initialization proportion of latent TB cases that are on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-active-tb-cases-that-are-diagnosed">Parameter: Initialization proportion of active TB cases that are diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-diagnosed-tb-cases-that-are-on-treatment">Parameter: Initialization proportion of diagnosed TB cases that are on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-the-population-that-have-previously-been-vaccinated">Parameter: Initialization proportion of the population that have previously been vaccinated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-of-the-population-that-have-previously-been-infected-with-tb">Parameter: Initialization proportion of the population that have previously been infected with TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-active-infections-proportion-of-population-that-are-sp">Parameter: New active infections: proportion of population that are SP</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-active-infections-proportion-of-population-that-are-sn">Parameter: New active infections: proportion of population that are SN</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-sp-infections-proportion-of-population-that-are-sp-ds">Parameter: New SP infections: proportion of population that are SP-DS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-sp-infections-proportion-of-population-that-are-sp-mdr">Parameter: New SP infections: proportion of population that are SP-MDR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-sp-infections-proportion-of-population-that-are-sp-xdr">Parameter: New SP infections: proportion of population that are SP-XDR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-sn-infections-proportion-of-population-that-are-sn-ds">Parameter: New SN infections: proportion of population that are SN-DS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-sn-infections-proportion-of-population-that-are-sn-mdr">Parameter: New SN infections: proportion of population that are SN-MDR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-new-sn-infections-proportion-of-population-that-are-sn-xdr">Parameter: New SN infections: proportion of population that are SN-XDR</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-infection-vulnerability-factor-relative-population-susceptibility">Parameter: Infection vulnerability factor (relative population susceptibility)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-infection-vulnerability-factor-vaccinated-versus-susceptible">Parameter: Infection vulnerability factor (vaccinated versus susceptible)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-infection-vulnerability-factor-recovered-versus-susceptible">Parameter: Infection vulnerability factor (recovered versus susceptible)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-infectiousness">Parameter: SP-DS infectiousness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-relative-infectiousness-sn-versus-sp">Parameter: Relative infectiousness (SN versus SP)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-relative-infectiousness-mdr-versus-ds">Parameter: Relative infectiousness (MDR versus DS)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-relative-infectiousness-xdr-versus-ds">Parameter: Relative infectiousness (XDR versus DS)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-early-latent-untreated-diagnosable">Parameter: Initialization proportion: Early latent untreated (diagnosable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-early-latent-on-treatment">Parameter: Initialization proportion: Early latent on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-late-latent-untreated-diagnosable">Parameter: Initialization proportion: Late latent untreated (diagnosable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-late-latent-on-treatment">Parameter: Initialization proportion: Late latent on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-early-latent-untreated-diagnosis-restricted">Parameter: Initialization proportion: Early latent untreated (diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-late-latent-untreated-diagnosis-restricted">Parameter: Initialization proportion: Late latent untreated (diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-ds-undiagnosed">Parameter: Initialization proportion: SP-DS undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-ds-diagnosed-but-not-on-treatment">Parameter: Initialization proportion: SP-DS diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-ds-on-treatment">Parameter: Initialization proportion: SP-DS on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-mdr-undiagnosed">Parameter: Initialization proportion: SP-MDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-mdr-diagnosed-but-not-on-treatment">Parameter: Initialization proportion: SP-MDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-mdr-on-treatment">Parameter: Initialization proportion: SP-MDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-xdr-undiagnosed">Parameter: Initialization proportion: SP-XDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-xdr-diagnosed-but-not-on-treatment">Parameter: Initialization proportion: SP-XDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sp-xdr-on-treatment">Parameter: Initialization proportion: SP-XDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-ds-undiagnosed">Parameter: Initialization proportion: SN-DS undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-ds-diagnosed-but-not-on-treatment">Parameter: Initialization proportion: SN-DS diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-ds-on-treatment">Parameter: Initialization proportion: SN-DS on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-mdr-undiagnosed">Parameter: Initialization proportion: SN-MDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-mdr-diagnosed-but-not-on-treatment">Parameter: Initialization proportion: SN-MDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-mdr-on-treatment">Parameter: Initialization proportion: SN-MDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-xdr-undiagnosed">Parameter: Initialization proportion: SN-XDR undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-xdr-diagnosed-but-not-on-treatment">Parameter: Initialization proportion: SN-XDR diagnosed but not on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-sn-xdr-on-treatment">Parameter: Initialization proportion: SN-XDR on treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-completed-treatment-active">Parameter: Initialization proportion: Completed treatment (active)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-vaccinated">Parameter: Initialization proportion: Vaccinated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-susceptible">Parameter: Initialization proportion: Susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-initialization-proportion-susceptible-diagnosis-restricted">Parameter: Initialization proportion: Susceptible (diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-number-of-births">Parameter: Number of births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-non-tb-deaths">Parameter: Non-TB deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-number-of-new-immigrants">Parameter: Number of new immigrants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-number-of-departing-emigrants">Parameter: Number of departing emigrants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-number-of-vaccinations-administered">Parameter: Number of vaccinations administered</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-treatment-initiations-through-mass-screening">Parameter: LTBI treatment initiations through mass screening</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-treatment-initiations-through-contact-tracing">Parameter: LTBI treatment initiations through contact tracing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-treatment-average-duration-of-full-course">Parameter: LTBI treatment average duration of full course</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-treatment-proportion-of-lost-to-follow-up">Parameter: LTBI treatment proportion of lost to follow up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-treatment-proportion-of-successful-completions">Parameter: LTBI treatment proportion of successful completions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-treatment-average-duration-until-outcome">Parameter: LTBI treatment average duration until outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-ltbi-annual-number-initiating-treatment">Parameter: Early-LTBI annual number initiating treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-ltbi-diagnosis-restricted-annual-number-initiating-treatment">Parameter: Early-LTBI (diagnosis restricted) annual number initiating treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-late-ltbi-annual-number-initiating-treatment">Parameter: Late-LTBI annual number initiating treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-ltbi-treatment-abandonment-rate">Parameter: Early-LTBI treatment abandonment rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-ltbi-treatment-success-rate">Parameter: Early-LTBI treatment success rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-late-ltbi-treatment-abandonment-rate">Parameter: Late-LTBI treatment abandonment rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-late-ltbi-treatment-success-rate">Parameter: Late-LTBI treatment success rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-latency-departure-rate">Parameter: Early latency departure rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-late-latency-departure-rate">Parameter: Late latency departure rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-probability-of-early-active-versus-early-late-progression">Parameter: Probability of early-active versus early-late progression</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-late-ltbi-progression-rate-diagnosable">Parameter: Early-late LTBI progression rate (diagnosable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-late-ltbi-progression-rate-diagnosis-restricted">Parameter: Early-late LTBI progression rate (diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-active-progression-rate-early-diagnosable">Parameter: LTBI-active progression rate (early diagnosable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-active-progression-rate-early-diagnosis-restricted">Parameter: LTBI-active progression rate (early diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-active-progression-rate-late-diagnosable">Parameter: LTBI-active progression rate (late diagnosable)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ltbi-active-progression-rate-late-diagnosis-restricted">Parameter: LTBI-active progression rate (late diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-infectiousness">Parameter: SP-MDR infectiousness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-infectiousness">Parameter: SP-XDR infectiousness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-infectiousness">Parameter: SN-DS infectiousness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-infectiousness">Parameter: SN-MDR infectiousness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-infectiousness">Parameter: SN-XDR infectiousness</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-force-of-infection-from-sp-prevalence">Parameter: Force of infection from SP prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-force-of-infection-from-sn-prevalence">Parameter: Force of infection from SN prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-force-of-infection-imparted-by-population">Parameter: Force of infection imparted by population</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-force-of-infection-experienced-by-population">Parameter: Force of infection experienced by population</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-infection-rate-susceptible-to-diagnosable-latent">Parameter: Infection rate (susceptible to diagnosable latent)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-infection-rate-vaccinated-to-diagnosis-restricted-latent">Parameter: Infection rate (vaccinated to diagnosis restricted latent)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-reinfection-rate-susceptible-to-diagnosis-restricted-for-diagnosis-restricted">Parameter: Reinfection rate (susceptible to diagnosis restricted for diagnosis restricted)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-relapse-rate-for-completed-treatment-active-cases">Parameter: Relapse rate for completed treatment (active) cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-full-recovery-rate-for-completed-treatment-active-cases">Parameter: Full recovery rate for completed treatment (active) cases</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-proportion-of-new-immigrants-with-ltbi">Parameter: Proportion of new immigrants with LTBI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-early-latent-proportion-of-new-immigrants">Parameter: Early latent proportion of new immigrants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-late-latent-proportion-of-new-immigrants">Parameter: Late latent proportion of new immigrants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-proportion-of-new-immigrants-with-active-tb-infections">Parameter: Proportion of new immigrants with active TB infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-susceptible-proportion-of-immigrants">Parameter: Susceptible proportion of immigrants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-diagnosis-notifications">Parameter: SP-DS diagnosis notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-diagnosis-notifications">Parameter: SP-MDR diagnosis notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-diagnosis-notifications">Parameter: SP-XDR diagnosis notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-diagnosis-notifications">Parameter: SN-DS diagnosis notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-diagnosis-notifications">Parameter: SN-MDR diagnosis notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-diagnosis-notifications">Parameter: SN-XDR diagnosis notifications</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-number-of-initiations">Parameter: DS treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-treatment-number-of-initiations">Parameter: SP-DS treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-treatment-number-of-initiations">Parameter: SN-DS treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-average-duration-of-completed-treatment">Parameter: DS treatment average duration of completed treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: DS treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: DS treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-proportion-failed-escalation-to-mdr-require-re-diagnosis">Parameter: DS treatment proportion failed (escalation to MDR, require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-proportion-of-treatments-completed-success">Parameter: DS treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-proportion-of-deaths">Parameter: DS treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-ds-treatment-average-duration-until-outcome">Parameter: DS treatment average duration until outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: SP-DS treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: SP-DS treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-treatment-proportion-failed-escalation-to-mdr-require-re-diagnosis">Parameter: SP-DS treatment proportion failed (escalation to MDR, require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-treatment-proportion-of-treatments-completed-success">Parameter: SP-DS treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-treatment-proportion-of-deaths">Parameter: SP-DS treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: SN-DS treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: SN-DS treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-treatment-proportion-failed-escalation-to-mdr-require-re-diagnosis">Parameter: SN-DS treatment proportion failed (escalation to MDR, require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-treatment-proportion-of-treatments-completed-success">Parameter: SN-DS treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-treatment-proportion-of-deaths">Parameter: SN-DS treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-number-of-initiations">Parameter: MDR treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-treatment-number-of-initiations">Parameter: SP-MDR treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-treatment-number-of-initiations">Parameter: SN-MDR treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-average-duration-of-completed-treatment">Parameter: MDR treatment average duration of completed treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: MDR treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: MDR treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-proportion-failed-escalation-to-xdr-require-re-diagnosis">Parameter: MDR treatment proportion failed (escalation to XDR, require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-proportion-of-treatments-completed-success">Parameter: MDR treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-proportion-of-deaths">Parameter: MDR treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-mdr-treatment-average-duration-until-outcome">Parameter: MDR treatment average duration until outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: SP-MDR treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: SP-MDR treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-treatment-proportion-failed-escalation-to-xdr-require-re-diagnosis">Parameter: SP-MDR treatment proportion failed (escalation to XDR, require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-treatment-proportion-of-treatments-completed-success">Parameter: SP-MDR treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-treatment-proportion-of-deaths">Parameter: SP-MDR treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: SN-MDR treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: SN-MDR treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-treatment-proportion-failed-escalation-to-xdr-require-re-diagnosis">Parameter: SN-MDR treatment proportion failed (escalation to XDR, require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-treatment-proportion-of-treatments-completed-success">Parameter: SN-MDR treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-treatment-proportion-of-deaths">Parameter: SN-MDR treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-xdr-treatment-number-of-initiations">Parameter: XDR treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-treatment-number-of-initiations">Parameter: SP-XDR treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-treatment-number-of-initiations">Parameter: SN-XDR treatment number of initiations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-xdr-treatment-average-duration-of-completed-treatment">Parameter: XDR treatment average duration of completed treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-xdr-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: XDR treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-xdr-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: XDR treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-xdr-treatment-proportion-of-treatments-completed-success">Parameter: XDR treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-xdr-treatment-proportion-of-deaths">Parameter: XDR treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-xdr-treatment-average-duration-until-outcome">Parameter: XDR treatment average duration until outcome</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: SP-XDR treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: SP-XDR treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-treatment-proportion-of-treatments-completed-success">Parameter: SP-XDR treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-treatment-proportion-of-deaths">Parameter: SP-XDR treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-treatment-proportion-of-loss-to-follow-up-require-re-diagnosis">Parameter: SN-XDR treatment proportion of loss to follow up (require re-diagnosis)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-treatment-proportion-failed-no-escalation-no-need-to-re-diagnose">Parameter: SN-XDR treatment proportion failed (no escalation, no need to re-diagnose)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-treatment-proportion-of-treatments-completed-success">Parameter: SN-XDR treatment proportion of treatments completed + success</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-treatment-proportion-of-deaths">Parameter: SN-XDR treatment proportion of deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-natural-recovery-rate">Parameter: SP-DS natural recovery rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-natural-recovery-rate">Parameter: SP-MDR natural recovery rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-natural-recovery-rate">Parameter: SP-XDR natural recovery rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-natural-recovery-rate">Parameter: SN-DS natural recovery rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-natural-recovery-rate">Parameter: SN-MDR natural recovery rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-natural-recovery-rate">Parameter: SN-XDR natural recovery rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-ds-death-rate-untreated">Parameter: SP-DS death rate (untreated)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-mdr-death-rate-untreated">Parameter: SP-MDR death rate (untreated)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sp-xdr-death-rate-untreated">Parameter: SP-XDR death rate (untreated)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-ds-death-rate-untreated">Parameter: SN-DS death rate (untreated)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-mdr-death-rate-untreated">Parameter: SN-MDR death rate (untreated)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-sn-xdr-death-rate-untreated">Parameter: SN-XDR death rate (untreated)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-disutility-weight-for-active-tb">Parameter: Disutility weight for active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-yld-rate">Parameter: YLD rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-estimated-number-of-years-of-life-remaining">Parameter: Estimated number of years of life remaining</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-yll-rate">Parameter: YLL rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#parameter-dalys">Parameter: DALYs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb.html#interactions">Interactions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#interaction-preference-weighting-for-one-population-interacting-with-another">Interaction: Preference weighting for one population interacting with another</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb.html#plots">Plots</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-population-size">Plot: Population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-latent-infections">Plot: Latent infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-active-tb">Plot: Active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-active-ds-tb">Plot: Active DS-TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-active-mdr-tb">Plot: Active MDR-TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-active-xdr-tb">Plot: Active XDR-TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-tb-infections">Plot: New active TB infections</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-activated-tb-infections-inc-relapse-and-immigration">Plot: Activated TB infections inc. relapse and immigration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-smear-negative-active-tb">Plot: Smear negative active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-smear-positive-active-tb">Plot: Smear positive active TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-latent-diagnoses">Plot: Latent diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-tb-diagnoses">Plot: New active TB diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-latent-treatment">Plot: Latent treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-active-treatment">Plot: Active treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-tb-related-deaths">Plot: TB-related deaths</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-latent-prevalence">Plot: Latent prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-active-prevalence">Plot: Active prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-dr-prevalence">Plot: DR prevalence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-sp-ds-diagnoses">Plot: New active SP-DS diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-sp-mdr-diagnoses">Plot: New active SP-MDR diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-sp-xdr-diagnoses">Plot: New active SP-XDR diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-sn-ds-diagnoses">Plot: New active SN-DS diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-sn-mdr-diagnoses">Plot: New active SN-MDR diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-new-active-sn-xdr-diagnoses">Plot: New active SN-XDR diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-ds-number-initiating-treatment">Plot: DS number initiating treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-mdr-number-initiating-treatment">Plot: MDR number initiating treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#plot-xdr-number-initiating-treatment">Plot: XDR number initiating treatment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#cascade-tb-treatment-including-recovered">Cascade: TB treatment (including recovered)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#cascade-sp-treatment">Cascade: SP treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb.html#cascade-sn-treatment">Cascade: SN treatment</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/tb_simple.html">TB simple model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#compartment-notified-and-treated">Compartment: Notified and treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#compartment-lost-to-follow-up">Compartment: Lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#compartment-successfully-treated-comp">Compartment: Successfully treated (comp)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#characteristic-tb-burden">Characteristic: TB burden</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#characteristic-notified">Characteristic: Notified</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#characteristic-in-care">Characteristic: In care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#characteristic-treated">Characteristic: Treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#characteristic-successfully-treated">Characteristic: Successfully treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-annual-number-of-tests-done">Parameter: Annual number of tests done</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-test-yield">Parameter: Test yield</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-annual-number-tested-positive">Parameter: Annual number tested positive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-test-sensitivity">Parameter: Test sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-time-after-initiating-treatment-to-treatment-success-years">Parameter: Time after initiating treatment to treatment success (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#parameter-treatment-failure-rate">Parameter: Treatment failure rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple.html#cascade-tb-care-cascade">Cascade: TB care cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/tb_simple_dyn.html">TB simple with dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple_dyn.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-source">Compartment: Source</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-susceptible">Compartment: Susceptible</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-vaccinated">Compartment: Vaccinated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-notified-and-treated">Compartment: Notified and treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-lost-to-follow-up">Compartment: Lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-successfully-treated-comp">Compartment: Successfully treated (comp)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-dead-tb">Compartment: Dead (TB)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#compartment-dead-other">Compartment: Dead (other)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple_dyn.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#characteristic-population-size">Characteristic: Population size</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#characteristic-tb-burden">Characteristic: TB burden</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#characteristic-notified">Characteristic: Notified</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#characteristic-in-care">Characteristic: In care</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#characteristic-treated">Characteristic: Treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#characteristic-successfully-treated">Characteristic: Successfully treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-annual-number-of-births">Parameter: Annual number of births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-estimated-number-of-new-tb-cases-annually">Parameter: Estimated number of new TB cases annually</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-acquisition-rate">Parameter: Acquisition rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-natural-recovery-rate">Parameter: Natural recovery rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-annual-number-vaccinated">Parameter: Annual number vaccinated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-vaccination-rate">Parameter: Vaccination rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-annual-number-of-tests-done">Parameter: Annual number of tests done</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-test-yield">Parameter: Test yield</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-annual-number-tested-positive">Parameter: Annual number tested positive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-test-sensitivity">Parameter: Test sensitivity</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-time-after-initiating-treatment-to-treatment-success-years">Parameter: Time after initiating treatment to treatment success (years)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-treatment-failure-rate">Parameter: Treatment failure rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-death-rate-for-those-with-untreated-tb">Parameter: Death rate for those with untreated TB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-death-rate-for-those-unsuccessfully-treated">Parameter: Death rate for those unsuccessfully treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-death-rate-for-those-successfully-treated">Parameter: Death rate for those successfully treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#parameter-background-mortality-rate">Parameter: Background mortality rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple_dyn.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/tb_simple_dyn.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/tb_simple_dyn.html#cascade-tb-care-cascade">Cascade: TB care cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/udt.html">UDT model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#compartment-treated">Compartment: Treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#characteristic-all-people-with-condition">Characteristic: All people with condition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#characteristic-diagnosed-people">Characteristic: Diagnosed people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#parameter-diagnosis-rate">Parameter: Diagnosis rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#parameter-annual-number-lost-to-follow-up">Parameter: Annual number lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt.html#cascade-cascade">Cascade: Cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/udt_dyn.html">UDT model with dynamics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt_dyn.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt_dyn.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#compartment-births">Compartment: Births</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#compartment-treated">Compartment: Treated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#compartment-dead">Compartment: dead</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt_dyn.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#characteristic-all-people-with-condition">Characteristic: All people with condition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#characteristic-diagnosed-people">Characteristic: Diagnosed people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt_dyn.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-diagnosis-rate">Parameter: Diagnosis rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-annual-number-lost-to-follow-up">Parameter: Annual number lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-birth-rate">Parameter: Birth rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-untreated-death-rate">Parameter: Untreated death rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#parameter-treated-death-rate">Parameter: Treated death rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt_dyn.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/udt_dyn.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/udt_dyn.html#cascade-cascade">Cascade: Cascade</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../library/usdt.html">USDT model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../library/usdt.html#contents">Contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/usdt.html#compartments">Compartments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#compartment-undiagnosed">Compartment: Undiagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#compartment-screened">Compartment: Screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#compartment-diagnosed">Compartment: Diagnosed</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#compartment-treated">Compartment: Treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/usdt.html#characteristics">Characteristics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#characteristic-all-people-with-condition">Characteristic: All people with condition</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#characteristic-screened-people">Characteristic: Screened people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#characteristic-diagnosed-people">Characteristic: Diagnosed people</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#characteristic-currently-treated">Characteristic: Currently treated</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/usdt.html#parameters">Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-annual-number-screened">Parameter: Annual number screened</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-screening-rate">Parameter: Screening rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-annual-number-of-new-diagnoses">Parameter: Annual number of new diagnoses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-diagnosis-rate">Parameter: Diagnosis rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-annual-number-newly-initiated-onto-treatment">Parameter: Annual number newly initiated onto treatment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-initiation-rate">Parameter: Initiation rate</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-annual-number-lost-to-follow-up">Parameter: Annual number lost to follow-up</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#parameter-loss-to-follow-up-rate">Parameter: Loss-to-follow-up rate</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../library/usdt.html#interactions">Interactions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../library/usdt.html#cascades">Cascades</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../library/usdt.html#cascade-main">Cascade: main</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../_autosummary/atomica.html">atomica</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.calibration.html">atomica.calibration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.calibration.calibrate.html">atomica.calibration.calibrate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.calibration.calibrate.html#atomica.calibration.calibrate"><code class="docutils literal notranslate"><span class="pre">calibrate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.cascade.html">atomica.cascade</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.cascade_summary.html">atomica.cascade.cascade_summary</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.cascade_summary.html#atomica.cascade.cascade_summary"><code class="docutils literal notranslate"><span class="pre">cascade_summary()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.get_cascade_data.html">atomica.cascade.get_cascade_data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.get_cascade_data.html#atomica.cascade.get_cascade_data"><code class="docutils literal notranslate"><span class="pre">get_cascade_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.get_cascade_vals.html">atomica.cascade.get_cascade_vals</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.get_cascade_vals.html#atomica.cascade.get_cascade_vals"><code class="docutils literal notranslate"><span class="pre">get_cascade_vals()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_cascade.html">atomica.cascade.plot_cascade</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_cascade.html#atomica.cascade.plot_cascade"><code class="docutils literal notranslate"><span class="pre">plot_cascade()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_multi_cascade.html">atomica.cascade.plot_multi_cascade</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_multi_cascade.html#atomica.cascade.plot_multi_cascade"><code class="docutils literal notranslate"><span class="pre">plot_multi_cascade()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_single_cascade.html">atomica.cascade.plot_single_cascade</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_single_cascade.html#atomica.cascade.plot_single_cascade"><code class="docutils literal notranslate"><span class="pre">plot_single_cascade()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_single_cascade_series.html">atomica.cascade.plot_single_cascade_series</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.plot_single_cascade_series.html#atomica.cascade.plot_single_cascade_series"><code class="docutils literal notranslate"><span class="pre">plot_single_cascade_series()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.sanitize_cascade.html">atomica.cascade.sanitize_cascade</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.sanitize_cascade.html#atomica.cascade.sanitize_cascade"><code class="docutils literal notranslate"><span class="pre">sanitize_cascade()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.sanitize_pops.html">atomica.cascade.sanitize_pops</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.sanitize_pops.html#atomica.cascade.sanitize_pops"><code class="docutils literal notranslate"><span class="pre">sanitize_pops()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.validate_cascade.html">atomica.cascade.validate_cascade</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.validate_cascade.html#atomica.cascade.validate_cascade"><code class="docutils literal notranslate"><span class="pre">validate_cascade()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html">atomica.cascade.CascadeEnsemble</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.add"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.add()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.baseline"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.baseline</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.boxplot"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.boxplot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.get_vals"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.get_vals()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.mapping_function"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.mapping_function</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.n_samples"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.n_samples</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.outputs"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.outputs</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.plot_bars"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.plot_bars()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.plot_distribution"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.plot_distribution()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.plot_multi_cascade"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.plot_multi_cascade()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.plot_series"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.plot_series()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.pops"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.pops</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.results"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.results</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.run_sims"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.run_sims()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.samples"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.samples</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.set_baseline"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.set_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.tvec"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.tvec</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.cascade.CascadeEnsemble.html#atomica.cascade.CascadeEnsemble.update"><code class="docutils literal notranslate"><span class="pre">CascadeEnsemble.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.cascade.InvalidCascade.html">atomica.cascade.InvalidCascade</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.cascade.InvalidCascade.html#atomica.cascade.InvalidCascade"><code class="docutils literal notranslate"><span class="pre">InvalidCascade</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.data.html">atomica.data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html">atomica.data.ProjectData</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData"><code class="docutils literal notranslate"><span class="pre">ProjectData</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.add_interaction"><code class="docutils literal notranslate"><span class="pre">ProjectData.add_interaction()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.add_pop"><code class="docutils literal notranslate"><span class="pre">ProjectData.add_pop()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.add_transfer"><code class="docutils literal notranslate"><span class="pre">ProjectData.add_transfer()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.change_tvec"><code class="docutils literal notranslate"><span class="pre">ProjectData.change_tvec()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.end_year"><code class="docutils literal notranslate"><span class="pre">ProjectData.end_year</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.from_spreadsheet"><code class="docutils literal notranslate"><span class="pre">ProjectData.from_spreadsheet()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.get_tdve_page"><code class="docutils literal notranslate"><span class="pre">ProjectData.get_tdve_page()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.get_ts"><code class="docutils literal notranslate"><span class="pre">ProjectData.get_ts()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.interpops"><code class="docutils literal notranslate"><span class="pre">ProjectData.interpops</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.new"><code class="docutils literal notranslate"><span class="pre">ProjectData.new()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.pops"><code class="docutils literal notranslate"><span class="pre">ProjectData.pops</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.remove_interaction"><code class="docutils literal notranslate"><span class="pre">ProjectData.remove_interaction()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.remove_transfer"><code class="docutils literal notranslate"><span class="pre">ProjectData.remove_transfer()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.rename_pop"><code class="docutils literal notranslate"><span class="pre">ProjectData.rename_pop()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.rename_transfer"><code class="docutils literal notranslate"><span class="pre">ProjectData.rename_transfer()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.save"><code class="docutils literal notranslate"><span class="pre">ProjectData.save()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.start_year"><code class="docutils literal notranslate"><span class="pre">ProjectData.start_year</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.tables"><code class="docutils literal notranslate"><span class="pre">ProjectData.tables()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.tdve"><code class="docutils literal notranslate"><span class="pre">ProjectData.tdve</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.tdve_pages"><code class="docutils literal notranslate"><span class="pre">ProjectData.tdve_pages</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.to_spreadsheet"><code class="docutils literal notranslate"><span class="pre">ProjectData.to_spreadsheet()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.to_workbook"><code class="docutils literal notranslate"><span class="pre">ProjectData.to_workbook()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.transfers"><code class="docutils literal notranslate"><span class="pre">ProjectData.transfers</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.tvec"><code class="docutils literal notranslate"><span class="pre">ProjectData.tvec</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.data.ProjectData.html#atomica.data.ProjectData.validate"><code class="docutils literal notranslate"><span class="pre">ProjectData.validate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.data.InvalidDatabook.html">atomica.data.InvalidDatabook</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.data.InvalidDatabook.html#atomica.data.InvalidDatabook"><code class="docutils literal notranslate"><span class="pre">InvalidDatabook</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.demos.html">atomica.demos</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.demos.demo.html">atomica.demos.demo</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.demos.demo.html#atomica.demos.demo"><code class="docutils literal notranslate"><span class="pre">demo()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.demos.make_demo_scenarios.html">atomica.demos.make_demo_scenarios</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.demos.make_demo_scenarios.html#atomica.demos.make_demo_scenarios"><code class="docutils literal notranslate"><span class="pre">make_demo_scenarios()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.excel.html">atomica.excel</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.apply_widths.html">atomica.excel.apply_widths</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.apply_widths.html#atomica.excel.apply_widths"><code class="docutils literal notranslate"><span class="pre">apply_widths()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.cell_get_number.html">atomica.excel.cell_get_number</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.cell_get_number.html#atomica.excel.cell_get_number"><code class="docutils literal notranslate"><span class="pre">cell_get_number()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.cell_get_string.html">atomica.excel.cell_get_string</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.cell_get_string.html#atomica.excel.cell_get_string"><code class="docutils literal notranslate"><span class="pre">cell_get_string()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.copy_sheet.html">atomica.excel.copy_sheet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.copy_sheet.html#atomica.excel.copy_sheet"><code class="docutils literal notranslate"><span class="pre">copy_sheet()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.read_dataframes.html">atomica.excel.read_dataframes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.read_dataframes.html#atomica.excel.read_dataframes"><code class="docutils literal notranslate"><span class="pre">read_dataframes()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.read_tables.html">atomica.excel.read_tables</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.read_tables.html#atomica.excel.read_tables"><code class="docutils literal notranslate"><span class="pre">read_tables()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.standard_formats.html">atomica.excel.standard_formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.standard_formats.html#atomica.excel.standard_formats"><code class="docutils literal notranslate"><span class="pre">standard_formats()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.transfer_comments.html">atomica.excel.transfer_comments</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.transfer_comments.html#atomica.excel.transfer_comments"><code class="docutils literal notranslate"><span class="pre">transfer_comments()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.update_widths.html">atomica.excel.update_widths</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.update_widths.html#atomica.excel.update_widths"><code class="docutils literal notranslate"><span class="pre">update_widths()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.validate_category.html">atomica.excel.validate_category</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.validate_category.html#atomica.excel.validate_category"><code class="docutils literal notranslate"><span class="pre">validate_category()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html">atomica.excel.TimeDependentConnections</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.assumption_heading"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.assumption_heading</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.attributes"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.attributes</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.from_tables"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.from_tables()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.ts_attributes"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.ts_attributes</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.write"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.write()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.write_assumption"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.write_assumption</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.write_uncertainty"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.write_uncertainty</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentConnections.html#atomica.excel.TimeDependentConnections.write_units"><code class="docutils literal notranslate"><span class="pre">TimeDependentConnections.write_units</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html">atomica.excel.TimeDependentValuesEntry</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.assumption_heading"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.assumption_heading</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.comment"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.comment</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.from_rows"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.from_rows()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.has_data"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.has_data</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.name"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.ts_attributes"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.ts_attributes</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.tvec"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.tvec</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.write"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.write()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.write_assumption"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.write_assumption</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.write_uncertainty"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.write_uncertainty</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.excel.TimeDependentValuesEntry.html#atomica.excel.TimeDependentValuesEntry.write_units"><code class="docutils literal notranslate"><span class="pre">TimeDependentValuesEntry.write_units</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.framework.html">atomica.framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.framework.generate_framework_doc.html">atomica.framework.generate_framework_doc</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.framework.generate_framework_doc.html#atomica.framework.generate_framework_doc"><code class="docutils literal notranslate"><span class="pre">generate_framework_doc()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html">atomica.framework.ProjectFramework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework"><code class="docutils literal notranslate"><span class="pre">ProjectFramework</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.cascades"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.cascades</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.characs"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.characs</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.comps"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.comps</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.created"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.created</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_charac"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_charac()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_charac_includes"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_charac_includes()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_comp"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_comp()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_databook_units"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_databook_units()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_interaction"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_interaction()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_label"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_label()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_par"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_par()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.get_variable"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.get_variable()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.gitinfo"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.gitinfo</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.interactions"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.interactions</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.modified"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.modified</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.name"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.pars"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.pars</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.pop_types"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.pop_types</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.save"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.save()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.sheets"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.sheets</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.spreadsheet"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.spreadsheet</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.to_spreadsheet"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.to_spreadsheet()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.uid"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.uid</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.framework.ProjectFramework.html#atomica.framework.ProjectFramework.version"><code class="docutils literal notranslate"><span class="pre">ProjectFramework.version</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.framework.InvalidFramework.html">atomica.framework.InvalidFramework</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.framework.InvalidFramework.html#atomica.framework.InvalidFramework"><code class="docutils literal notranslate"><span class="pre">InvalidFramework</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.function_parser.html">atomica.function_parser</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.function_parser.parse_function.html">atomica.function_parser.parse_function</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.function_parser.parse_function.html#atomica.function_parser.parse_function"><code class="docutils literal notranslate"><span class="pre">parse_function()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.function_parser.sdiv.html">atomica.function_parser.sdiv</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.function_parser.sdiv.html#atomica.function_parser.sdiv"><code class="docutils literal notranslate"><span class="pre">sdiv()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.function_parser.vector_max.html">atomica.function_parser.vector_max</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.function_parser.vector_max.html#atomica.function_parser.vector_max"><code class="docutils literal notranslate"><span class="pre">vector_max()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.function_parser.vector_min.html">atomica.function_parser.vector_min</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.function_parser.vector_min.html#atomica.function_parser.vector_min"><code class="docutils literal notranslate"><span class="pre">vector_min()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.migration.html">atomica.migration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.migration.all_frameworks.html">atomica.migration.all_frameworks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.migration.all_frameworks.html#atomica.migration.all_frameworks"><code class="docutils literal notranslate"><span class="pre">all_frameworks()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.migration.all_progsets.html">atomica.migration.all_progsets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.migration.all_progsets.html#atomica.migration.all_progsets"><code class="docutils literal notranslate"><span class="pre">all_progsets()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.migration.all_results.html">atomica.migration.all_results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.migration.all_results.html#atomica.migration.all_results"><code class="docutils literal notranslate"><span class="pre">all_results()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.migration.migrate.html">atomica.migration.migrate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.migration.migrate.html#atomica.migration.migrate"><code class="docutils literal notranslate"><span class="pre">migrate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.migration.migration.html">atomica.migration.migration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.migration.migration.html#atomica.migration.migration"><code class="docutils literal notranslate"><span class="pre">migration()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.migration.register_migration.html">atomica.migration.register_migration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.migration.register_migration.html#atomica.migration.register_migration"><code class="docutils literal notranslate"><span class="pre">register_migration()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.migration.Migration.html">atomica.migration.Migration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.migration.Migration.html#atomica.migration.Migration"><code class="docutils literal notranslate"><span class="pre">Migration</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.model.html">atomica.model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.run_model.html">atomica.model.run_model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.run_model.html#atomica.model.run_model"><code class="docutils literal notranslate"><span class="pre">run_model()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html">atomica.model.Characteristic</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic"><code class="docutils literal notranslate"><span class="pre">Characteristic</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.id"><code class="docutils literal notranslate"><span class="pre">Characteristic.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.name"><code class="docutils literal notranslate"><span class="pre">Characteristic.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.plot"><code class="docutils literal notranslate"><span class="pre">Characteristic.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.pop"><code class="docutils literal notranslate"><span class="pre">Characteristic.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.preallocate"><code class="docutils literal notranslate"><span class="pre">Characteristic.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.set_dynamic"><code class="docutils literal notranslate"><span class="pre">Characteristic.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.units"><code class="docutils literal notranslate"><span class="pre">Characteristic.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.update"><code class="docutils literal notranslate"><span class="pre">Characteristic.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html">atomica.model.Compartment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment"><code class="docutils literal notranslate"><span class="pre">Compartment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.connect"><code class="docutils literal notranslate"><span class="pre">Compartment.connect()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.id"><code class="docutils literal notranslate"><span class="pre">Compartment.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.name"><code class="docutils literal notranslate"><span class="pre">Compartment.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.outflow"><code class="docutils literal notranslate"><span class="pre">Compartment.outflow</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.plot"><code class="docutils literal notranslate"><span class="pre">Compartment.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.pop"><code class="docutils literal notranslate"><span class="pre">Compartment.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.preallocate"><code class="docutils literal notranslate"><span class="pre">Compartment.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.resolve_outflows"><code class="docutils literal notranslate"><span class="pre">Compartment.resolve_outflows()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.set_dynamic"><code class="docutils literal notranslate"><span class="pre">Compartment.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.units"><code class="docutils literal notranslate"><span class="pre">Compartment.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.update"><code class="docutils literal notranslate"><span class="pre">Compartment.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html">atomica.model.JunctionCompartment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.balance"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.balance()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.connect"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.connect()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.duration_group"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.duration_group</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.id"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.initial_flush"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.initial_flush()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.name"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.outflow"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.outflow</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.plot"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.pop"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.preallocate"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.resolve_outflows"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.resolve_outflows()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.set_dynamic"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.units"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.update"><code class="docutils literal notranslate"><span class="pre">JunctionCompartment.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html">atomica.model.Link</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link"><code class="docutils literal notranslate"><span class="pre">Link</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.create"><code class="docutils literal notranslate"><span class="pre">Link.create()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.id"><code class="docutils literal notranslate"><span class="pre">Link.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.name"><code class="docutils literal notranslate"><span class="pre">Link.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.plot"><code class="docutils literal notranslate"><span class="pre">Link.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.pop"><code class="docutils literal notranslate"><span class="pre">Link.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.preallocate"><code class="docutils literal notranslate"><span class="pre">Link.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.set_dynamic"><code class="docutils literal notranslate"><span class="pre">Link.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.units"><code class="docutils literal notranslate"><span class="pre">Link.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.update"><code class="docutils literal notranslate"><span class="pre">Link.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html">atomica.model.Model</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model"><code class="docutils literal notranslate"><span class="pre">Model</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.build"><code class="docutils literal notranslate"><span class="pre">Model.build()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.dt"><code class="docutils literal notranslate"><span class="pre">Model.dt</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.flush_junctions"><code class="docutils literal notranslate"><span class="pre">Model.flush_junctions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.get_pop"><code class="docutils literal notranslate"><span class="pre">Model.get_pop()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.process"><code class="docutils literal notranslate"><span class="pre">Model.process()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.relink"><code class="docutils literal notranslate"><span class="pre">Model.relink()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.t"><code class="docutils literal notranslate"><span class="pre">Model.t</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.unlink"><code class="docutils literal notranslate"><span class="pre">Model.unlink()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.update_comps"><code class="docutils literal notranslate"><span class="pre">Model.update_comps()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.update_links"><code class="docutils literal notranslate"><span class="pre">Model.update_links()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.update_pars"><code class="docutils literal notranslate"><span class="pre">Model.update_pars()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html">atomica.model.Parameter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter"><code class="docutils literal notranslate"><span class="pre">Parameter</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.constrain"><code class="docutils literal notranslate"><span class="pre">Parameter.constrain()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.deps"><code class="docutils literal notranslate"><span class="pre">Parameter.deps</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.derivative"><code class="docutils literal notranslate"><span class="pre">Parameter.derivative</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.fcn_str"><code class="docutils literal notranslate"><span class="pre">Parameter.fcn_str</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.id"><code class="docutils literal notranslate"><span class="pre">Parameter.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.limits"><code class="docutils literal notranslate"><span class="pre">Parameter.limits</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.links"><code class="docutils literal notranslate"><span class="pre">Parameter.links</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.name"><code class="docutils literal notranslate"><span class="pre">Parameter.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.plot"><code class="docutils literal notranslate"><span class="pre">Parameter.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.pop"><code class="docutils literal notranslate"><span class="pre">Parameter.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.pop_aggregation"><code class="docutils literal notranslate"><span class="pre">Parameter.pop_aggregation</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.preallocate"><code class="docutils literal notranslate"><span class="pre">Parameter.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.scale_factor"><code class="docutils literal notranslate"><span class="pre">Parameter.scale_factor</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.set_dynamic"><code class="docutils literal notranslate"><span class="pre">Parameter.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.set_fcn"><code class="docutils literal notranslate"><span class="pre">Parameter.set_fcn()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.skip_function"><code class="docutils literal notranslate"><span class="pre">Parameter.skip_function</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.timescale"><code class="docutils literal notranslate"><span class="pre">Parameter.timescale</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.units"><code class="docutils literal notranslate"><span class="pre">Parameter.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.update"><code class="docutils literal notranslate"><span class="pre">Parameter.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html">atomica.model.Population</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population"><code class="docutils literal notranslate"><span class="pre">Population</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.build"><code class="docutils literal notranslate"><span class="pre">Population.build()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.charac_lookup"><code class="docutils literal notranslate"><span class="pre">Population.charac_lookup</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.characs"><code class="docutils literal notranslate"><span class="pre">Population.characs</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.comp_lookup"><code class="docutils literal notranslate"><span class="pre">Population.comp_lookup</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.comps"><code class="docutils literal notranslate"><span class="pre">Population.comps</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.get_charac"><code class="docutils literal notranslate"><span class="pre">Population.get_charac()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.get_comp"><code class="docutils literal notranslate"><span class="pre">Population.get_comp()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.get_links"><code class="docutils literal notranslate"><span class="pre">Population.get_links()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.get_par"><code class="docutils literal notranslate"><span class="pre">Population.get_par()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.get_variable"><code class="docutils literal notranslate"><span class="pre">Population.get_variable()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.initialize_compartments"><code class="docutils literal notranslate"><span class="pre">Population.initialize_compartments()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.label"><code class="docutils literal notranslate"><span class="pre">Population.label</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.link_lookup"><code class="docutils literal notranslate"><span class="pre">Population.link_lookup</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.links"><code class="docutils literal notranslate"><span class="pre">Population.links</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.name"><code class="docutils literal notranslate"><span class="pre">Population.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.par_lookup"><code class="docutils literal notranslate"><span class="pre">Population.par_lookup</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.pars"><code class="docutils literal notranslate"><span class="pre">Population.pars</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.popsize"><code class="docutils literal notranslate"><span class="pre">Population.popsize()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.type"><code class="docutils literal notranslate"><span class="pre">Population.type</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html">atomica.model.ResidualJunctionCompartment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.balance"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.balance()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.connect"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.connect()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.duration_group"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.duration_group</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.id"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.initial_flush"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.initial_flush()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.name"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.outflow"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.outflow</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.plot"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.pop"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.preallocate"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.resolve_outflows"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.resolve_outflows()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.set_dynamic"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.units"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.update"><code class="docutils literal notranslate"><span class="pre">ResidualJunctionCompartment.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html">atomica.model.SinkCompartment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment"><code class="docutils literal notranslate"><span class="pre">SinkCompartment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.connect"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.connect()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.id"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.name"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.outflow"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.outflow</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.plot"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.pop"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.preallocate"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.resolve_outflows"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.resolve_outflows()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.set_dynamic"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.units"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.update"><code class="docutils literal notranslate"><span class="pre">SinkCompartment.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html">atomica.model.SourceCompartment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment"><code class="docutils literal notranslate"><span class="pre">SourceCompartment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.connect"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.connect()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.id"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.name"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.outflow"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.outflow</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.plot"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.pop"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.preallocate"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.resolve_outflows"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.resolve_outflows()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.set_dynamic"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.units"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.update"><code class="docutils literal notranslate"><span class="pre">SourceCompartment.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html">atomica.model.TimedCompartment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment"><code class="docutils literal notranslate"><span class="pre">TimedCompartment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.connect"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.connect()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.flush_link"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.flush_link</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.id"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.name"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.outflow"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.outflow</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.parameter"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.parameter</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.plot"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.pop"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.preallocate"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.resolve_outflows"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.resolve_outflows()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.set_dynamic"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.units"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.update"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.update()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.vals"><code class="docutils literal notranslate"><span class="pre">TimedCompartment.vals</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html">atomica.model.TimedLink</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink"><code class="docutils literal notranslate"><span class="pre">TimedLink</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.create"><code class="docutils literal notranslate"><span class="pre">TimedLink.create()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.id"><code class="docutils literal notranslate"><span class="pre">TimedLink.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.name"><code class="docutils literal notranslate"><span class="pre">TimedLink.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.plot"><code class="docutils literal notranslate"><span class="pre">TimedLink.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.pop"><code class="docutils literal notranslate"><span class="pre">TimedLink.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.preallocate"><code class="docutils literal notranslate"><span class="pre">TimedLink.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.set_dynamic"><code class="docutils literal notranslate"><span class="pre">TimedLink.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.units"><code class="docutils literal notranslate"><span class="pre">TimedLink.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.update"><code class="docutils literal notranslate"><span class="pre">TimedLink.update()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.vals"><code class="docutils literal notranslate"><span class="pre">TimedLink.vals</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html">atomica.model.Variable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable"><code class="docutils literal notranslate"><span class="pre">Variable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.id"><code class="docutils literal notranslate"><span class="pre">Variable.id</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.name"><code class="docutils literal notranslate"><span class="pre">Variable.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.plot"><code class="docutils literal notranslate"><span class="pre">Variable.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.pop"><code class="docutils literal notranslate"><span class="pre">Variable.pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.preallocate"><code class="docutils literal notranslate"><span class="pre">Variable.preallocate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.set_dynamic"><code class="docutils literal notranslate"><span class="pre">Variable.set_dynamic()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.units"><code class="docutils literal notranslate"><span class="pre">Variable.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.update"><code class="docutils literal notranslate"><span class="pre">Variable.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.BadInitialization.html">atomica.model.BadInitialization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.BadInitialization.html#atomica.model.BadInitialization"><code class="docutils literal notranslate"><span class="pre">BadInitialization</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.model.ModelError.html">atomica.model.ModelError</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.model.ModelError.html#atomica.model.ModelError"><code class="docutils literal notranslate"><span class="pre">ModelError</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.optimization.html">atomica.optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.constrain_sum_bounded.html">atomica.optimization.constrain_sum_bounded</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.constrain_sum_bounded.html#atomica.optimization.constrain_sum_bounded"><code class="docutils literal notranslate"><span class="pre">constrain_sum_bounded()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.optimize.html">atomica.optimization.optimize</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.optimize.html#atomica.optimization.optimize"><code class="docutils literal notranslate"><span class="pre">optimize()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.Adjustable.html">atomica.optimization.Adjustable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.Adjustable.html#atomica.optimization.Adjustable"><code class="docutils literal notranslate"><span class="pre">Adjustable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Adjustable.html#atomica.optimization.Adjustable.get_hard_bounds"><code class="docutils literal notranslate"><span class="pre">Adjustable.get_hard_bounds()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.Adjustment.html">atomica.optimization.Adjustment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.Adjustment.html#atomica.optimization.Adjustment"><code class="docutils literal notranslate"><span class="pre">Adjustment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Adjustment.html#atomica.optimization.Adjustment.adjustables"><code class="docutils literal notranslate"><span class="pre">Adjustment.adjustables</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Adjustment.html#atomica.optimization.Adjustment.get_initialization"><code class="docutils literal notranslate"><span class="pre">Adjustment.get_initialization()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtLeastMeasurable.html">atomica.optimization.AtLeastMeasurable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtLeastMeasurable.html#atomica.optimization.AtLeastMeasurable"><code class="docutils literal notranslate"><span class="pre">AtLeastMeasurable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtLeastMeasurable.html#atomica.optimization.AtLeastMeasurable.get_baseline"><code class="docutils literal notranslate"><span class="pre">AtLeastMeasurable.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtLeastMeasurable.html#atomica.optimization.AtLeastMeasurable.get_objective_val"><code class="docutils literal notranslate"><span class="pre">AtLeastMeasurable.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtMostMeasurable.html">atomica.optimization.AtMostMeasurable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtMostMeasurable.html#atomica.optimization.AtMostMeasurable"><code class="docutils literal notranslate"><span class="pre">AtMostMeasurable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtMostMeasurable.html#atomica.optimization.AtMostMeasurable.get_baseline"><code class="docutils literal notranslate"><span class="pre">AtMostMeasurable.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.AtMostMeasurable.html#atomica.optimization.AtMostMeasurable.get_objective_val"><code class="docutils literal notranslate"><span class="pre">AtMostMeasurable.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.Constraint.html">atomica.optimization.Constraint</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.Constraint.html#atomica.optimization.Constraint"><code class="docutils literal notranslate"><span class="pre">Constraint</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Constraint.html#atomica.optimization.Constraint.constrain_instructions"><code class="docutils literal notranslate"><span class="pre">Constraint.constrain_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Constraint.html#atomica.optimization.Constraint.get_hard_constraint"><code class="docutils literal notranslate"><span class="pre">Constraint.get_hard_constraint()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.DecreaseByMeasurable.html">atomica.optimization.DecreaseByMeasurable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.DecreaseByMeasurable.html#atomica.optimization.DecreaseByMeasurable"><code class="docutils literal notranslate"><span class="pre">DecreaseByMeasurable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.DecreaseByMeasurable.html#atomica.optimization.DecreaseByMeasurable.get_baseline"><code class="docutils literal notranslate"><span class="pre">DecreaseByMeasurable.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.DecreaseByMeasurable.html#atomica.optimization.DecreaseByMeasurable.get_objective_val"><code class="docutils literal notranslate"><span class="pre">DecreaseByMeasurable.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.ExponentialSpendingAdjustment.html">atomica.optimization.ExponentialSpendingAdjustment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.ExponentialSpendingAdjustment.html#atomica.optimization.ExponentialSpendingAdjustment"><code class="docutils literal notranslate"><span class="pre">ExponentialSpendingAdjustment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.ExponentialSpendingAdjustment.html#atomica.optimization.ExponentialSpendingAdjustment.adjustables"><code class="docutils literal notranslate"><span class="pre">ExponentialSpendingAdjustment.adjustables</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.ExponentialSpendingAdjustment.html#atomica.optimization.ExponentialSpendingAdjustment.get_initialization"><code class="docutils literal notranslate"><span class="pre">ExponentialSpendingAdjustment.get_initialization()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.IncreaseByMeasurable.html">atomica.optimization.IncreaseByMeasurable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.IncreaseByMeasurable.html#atomica.optimization.IncreaseByMeasurable"><code class="docutils literal notranslate"><span class="pre">IncreaseByMeasurable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.IncreaseByMeasurable.html#atomica.optimization.IncreaseByMeasurable.get_baseline"><code class="docutils literal notranslate"><span class="pre">IncreaseByMeasurable.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.IncreaseByMeasurable.html#atomica.optimization.IncreaseByMeasurable.get_objective_val"><code class="docutils literal notranslate"><span class="pre">IncreaseByMeasurable.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeConversionRate.html">atomica.optimization.MaximizeCascadeConversionRate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeConversionRate.html#atomica.optimization.MaximizeCascadeConversionRate"><code class="docutils literal notranslate"><span class="pre">MaximizeCascadeConversionRate</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeConversionRate.html#atomica.optimization.MaximizeCascadeConversionRate.get_baseline"><code class="docutils literal notranslate"><span class="pre">MaximizeCascadeConversionRate.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeConversionRate.html#atomica.optimization.MaximizeCascadeConversionRate.get_objective_val"><code class="docutils literal notranslate"><span class="pre">MaximizeCascadeConversionRate.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeStage.html">atomica.optimization.MaximizeCascadeStage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeStage.html#atomica.optimization.MaximizeCascadeStage"><code class="docutils literal notranslate"><span class="pre">MaximizeCascadeStage</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeStage.html#atomica.optimization.MaximizeCascadeStage.get_baseline"><code class="docutils literal notranslate"><span class="pre">MaximizeCascadeStage.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeCascadeStage.html#atomica.optimization.MaximizeCascadeStage.get_objective_val"><code class="docutils literal notranslate"><span class="pre">MaximizeCascadeStage.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeMeasurable.html">atomica.optimization.MaximizeMeasurable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeMeasurable.html#atomica.optimization.MaximizeMeasurable"><code class="docutils literal notranslate"><span class="pre">MaximizeMeasurable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeMeasurable.html#atomica.optimization.MaximizeMeasurable.get_baseline"><code class="docutils literal notranslate"><span class="pre">MaximizeMeasurable.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MaximizeMeasurable.html#atomica.optimization.MaximizeMeasurable.get_objective_val"><code class="docutils literal notranslate"><span class="pre">MaximizeMeasurable.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.Measurable.html">atomica.optimization.Measurable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.Measurable.html#atomica.optimization.Measurable"><code class="docutils literal notranslate"><span class="pre">Measurable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Measurable.html#atomica.optimization.Measurable.get_baseline"><code class="docutils literal notranslate"><span class="pre">Measurable.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Measurable.html#atomica.optimization.Measurable.get_objective_val"><code class="docutils literal notranslate"><span class="pre">Measurable.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.MinimizeMeasurable.html">atomica.optimization.MinimizeMeasurable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.MinimizeMeasurable.html#atomica.optimization.MinimizeMeasurable"><code class="docutils literal notranslate"><span class="pre">MinimizeMeasurable</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MinimizeMeasurable.html#atomica.optimization.MinimizeMeasurable.get_baseline"><code class="docutils literal notranslate"><span class="pre">MinimizeMeasurable.get_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.MinimizeMeasurable.html#atomica.optimization.MinimizeMeasurable.get_objective_val"><code class="docutils literal notranslate"><span class="pre">MinimizeMeasurable.get_objective_val()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html">atomica.optimization.Optimization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization"><code class="docutils literal notranslate"><span class="pre">Optimization</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.compute_objective"><code class="docutils literal notranslate"><span class="pre">Optimization.compute_objective()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.constrain_instructions"><code class="docutils literal notranslate"><span class="pre">Optimization.constrain_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.get_adjustment"><code class="docutils literal notranslate"><span class="pre">Optimization.get_adjustment()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.get_baselines"><code class="docutils literal notranslate"><span class="pre">Optimization.get_baselines()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.get_hard_constraints"><code class="docutils literal notranslate"><span class="pre">Optimization.get_hard_constraints()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.get_initialization"><code class="docutils literal notranslate"><span class="pre">Optimization.get_initialization()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.maxiters"><code class="docutils literal notranslate"><span class="pre">Optimization.maxiters</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.maxtime"><code class="docutils literal notranslate"><span class="pre">Optimization.maxtime</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.method"><code class="docutils literal notranslate"><span class="pre">Optimization.method</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.Optimization.html#atomica.optimization.Optimization.update_instructions"><code class="docutils literal notranslate"><span class="pre">Optimization.update_instructions()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.PairedLinearSpendingAdjustment.html">atomica.optimization.PairedLinearSpendingAdjustment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.PairedLinearSpendingAdjustment.html#atomica.optimization.PairedLinearSpendingAdjustment"><code class="docutils literal notranslate"><span class="pre">PairedLinearSpendingAdjustment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.PairedLinearSpendingAdjustment.html#atomica.optimization.PairedLinearSpendingAdjustment.adjustables"><code class="docutils literal notranslate"><span class="pre">PairedLinearSpendingAdjustment.adjustables</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.PairedLinearSpendingAdjustment.html#atomica.optimization.PairedLinearSpendingAdjustment.get_initialization"><code class="docutils literal notranslate"><span class="pre">PairedLinearSpendingAdjustment.get_initialization()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingAdjustment.html">atomica.optimization.SpendingAdjustment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingAdjustment.html#atomica.optimization.SpendingAdjustment"><code class="docutils literal notranslate"><span class="pre">SpendingAdjustment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingAdjustment.html#atomica.optimization.SpendingAdjustment.adjustables"><code class="docutils literal notranslate"><span class="pre">SpendingAdjustment.adjustables</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingAdjustment.html#atomica.optimization.SpendingAdjustment.get_initialization"><code class="docutils literal notranslate"><span class="pre">SpendingAdjustment.get_initialization()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingPackageAdjustment.html">atomica.optimization.SpendingPackageAdjustment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingPackageAdjustment.html#atomica.optimization.SpendingPackageAdjustment"><code class="docutils literal notranslate"><span class="pre">SpendingPackageAdjustment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingPackageAdjustment.html#atomica.optimization.SpendingPackageAdjustment.adjust_total_spend"><code class="docutils literal notranslate"><span class="pre">SpendingPackageAdjustment.adjust_total_spend</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingPackageAdjustment.html#atomica.optimization.SpendingPackageAdjustment.adjustables"><code class="docutils literal notranslate"><span class="pre">SpendingPackageAdjustment.adjustables</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.SpendingPackageAdjustment.html#atomica.optimization.SpendingPackageAdjustment.get_initialization"><code class="docutils literal notranslate"><span class="pre">SpendingPackageAdjustment.get_initialization()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.StartTimeAdjustment.html">atomica.optimization.StartTimeAdjustment</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.StartTimeAdjustment.html#atomica.optimization.StartTimeAdjustment"><code class="docutils literal notranslate"><span class="pre">StartTimeAdjustment</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.StartTimeAdjustment.html#atomica.optimization.StartTimeAdjustment.adjustables"><code class="docutils literal notranslate"><span class="pre">StartTimeAdjustment.adjustables</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.StartTimeAdjustment.html#atomica.optimization.StartTimeAdjustment.get_initialization"><code class="docutils literal notranslate"><span class="pre">StartTimeAdjustment.get_initialization()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.TotalSpendConstraint.html">atomica.optimization.TotalSpendConstraint</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.TotalSpendConstraint.html#atomica.optimization.TotalSpendConstraint"><code class="docutils literal notranslate"><span class="pre">TotalSpendConstraint</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.TotalSpendConstraint.html#atomica.optimization.TotalSpendConstraint.constrain_instructions"><code class="docutils literal notranslate"><span class="pre">TotalSpendConstraint.constrain_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.optimization.TotalSpendConstraint.html#atomica.optimization.TotalSpendConstraint.get_hard_constraint"><code class="docutils literal notranslate"><span class="pre">TotalSpendConstraint.get_hard_constraint()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.FailedConstraint.html">atomica.optimization.FailedConstraint</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.FailedConstraint.html#atomica.optimization.FailedConstraint"><code class="docutils literal notranslate"><span class="pre">FailedConstraint</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.InvalidInitialConditions.html">atomica.optimization.InvalidInitialConditions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.InvalidInitialConditions.html#atomica.optimization.InvalidInitialConditions"><code class="docutils literal notranslate"><span class="pre">InvalidInitialConditions</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.optimization.UnresolvableConstraint.html">atomica.optimization.UnresolvableConstraint</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.optimization.UnresolvableConstraint.html#atomica.optimization.UnresolvableConstraint"><code class="docutils literal notranslate"><span class="pre">UnresolvableConstraint</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.parameters.html">atomica.parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.parameters.Initialization.html">atomica.parameters.Initialization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.parameters.Initialization.html#atomica.parameters.Initialization"><code class="docutils literal notranslate"><span class="pre">Initialization</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Initialization.html#atomica.parameters.Initialization.apply"><code class="docutils literal notranslate"><span class="pre">Initialization.apply()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Initialization.html#atomica.parameters.Initialization.from_excel"><code class="docutils literal notranslate"><span class="pre">Initialization.from_excel()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Initialization.html#atomica.parameters.Initialization.from_result"><code class="docutils literal notranslate"><span class="pre">Initialization.from_result()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Initialization.html#atomica.parameters.Initialization.hash_y_factors"><code class="docutils literal notranslate"><span class="pre">Initialization.hash_y_factors()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.parameters.Parameter.html">atomica.parameters.Parameter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.parameters.Parameter.html#atomica.parameters.Parameter"><code class="docutils literal notranslate"><span class="pre">Parameter</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Parameter.html#atomica.parameters.Parameter.has_values"><code class="docutils literal notranslate"><span class="pre">Parameter.has_values()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Parameter.html#atomica.parameters.Parameter.interpolate"><code class="docutils literal notranslate"><span class="pre">Parameter.interpolate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Parameter.html#atomica.parameters.Parameter.pops"><code class="docutils literal notranslate"><span class="pre">Parameter.pops</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Parameter.html#atomica.parameters.Parameter.sample"><code class="docutils literal notranslate"><span class="pre">Parameter.sample()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.Parameter.html#atomica.parameters.Parameter.smooth"><code class="docutils literal notranslate"><span class="pre">Parameter.smooth()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html">atomica.parameters.ParameterSet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet"><code class="docutils literal notranslate"><span class="pre">ParameterSet</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.all_pars"><code class="docutils literal notranslate"><span class="pre">ParameterSet.all_pars()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.apply_initialization"><code class="docutils literal notranslate"><span class="pre">ParameterSet.apply_initialization()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.calibration_spreadsheet"><code class="docutils literal notranslate"><span class="pre">ParameterSet.calibration_spreadsheet()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.get_par"><code class="docutils literal notranslate"><span class="pre">ParameterSet.get_par()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.initialization"><code class="docutils literal notranslate"><span class="pre">ParameterSet.initialization</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.load_calibration"><code class="docutils literal notranslate"><span class="pre">ParameterSet.load_calibration()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.make_constant"><code class="docutils literal notranslate"><span class="pre">ParameterSet.make_constant()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.sample"><code class="docutils literal notranslate"><span class="pre">ParameterSet.sample()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.save_calibration"><code class="docutils literal notranslate"><span class="pre">ParameterSet.save_calibration()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.parameters.ParameterSet.html#atomica.parameters.ParameterSet.y_factors"><code class="docutils literal notranslate"><span class="pre">ParameterSet.y_factors</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.plotting.html">atomica.plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.plot_bars.html">atomica.plotting.plot_bars</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.plot_bars.html#atomica.plotting.plot_bars"><code class="docutils literal notranslate"><span class="pre">plot_bars()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.plot_legend.html">atomica.plotting.plot_legend</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.plot_legend.html#atomica.plotting.plot_legend"><code class="docutils literal notranslate"><span class="pre">plot_legend()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.plot_series.html">atomica.plotting.plot_series</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.plot_series.html#atomica.plotting.plot_series"><code class="docutils literal notranslate"><span class="pre">plot_series()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.relabel_legend.html">atomica.plotting.relabel_legend</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.relabel_legend.html#atomica.plotting.relabel_legend"><code class="docutils literal notranslate"><span class="pre">relabel_legend()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.reorder_legend.html">atomica.plotting.reorder_legend</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.reorder_legend.html#atomica.plotting.reorder_legend"><code class="docutils literal notranslate"><span class="pre">reorder_legend()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.save_figs.html">atomica.plotting.save_figs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.save_figs.html#atomica.plotting.save_figs"><code class="docutils literal notranslate"><span class="pre">save_figs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html">atomica.plotting.PlotData</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData"><code class="docutils literal notranslate"><span class="pre">PlotData</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.__getitem__"><code class="docutils literal notranslate"><span class="pre">PlotData.__getitem__()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.accumulate"><code class="docutils literal notranslate"><span class="pre">PlotData.accumulate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.interpolate"><code class="docutils literal notranslate"><span class="pre">PlotData.interpolate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.programs"><code class="docutils literal notranslate"><span class="pre">PlotData.programs()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.set_colors"><code class="docutils literal notranslate"><span class="pre">PlotData.set_colors()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.time_aggregate"><code class="docutils literal notranslate"><span class="pre">PlotData.time_aggregate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.PlotData.html#atomica.plotting.PlotData.tvals"><code class="docutils literal notranslate"><span class="pre">PlotData.tvals()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html">atomica.plotting.Series</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series"><code class="docutils literal notranslate"><span class="pre">Series</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series.data_label"><code class="docutils literal notranslate"><span class="pre">Series.data_label</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series.data_pop"><code class="docutils literal notranslate"><span class="pre">Series.data_pop</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series.interpolate"><code class="docutils literal notranslate"><span class="pre">Series.interpolate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series.timescale"><code class="docutils literal notranslate"><span class="pre">Series.timescale</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series.unit_string"><code class="docutils literal notranslate"><span class="pre">Series.unit_string</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.plotting.Series.html#atomica.plotting.Series.units"><code class="docutils literal notranslate"><span class="pre">Series.units</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.programs.html">atomica.programs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.programs.Covout.html">atomica.programs.Covout</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.programs.Covout.html#atomica.programs.Covout"><code class="docutils literal notranslate"><span class="pre">Covout</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Covout.html#atomica.programs.Covout.compute_impact_interaction"><code class="docutils literal notranslate"><span class="pre">Covout.compute_impact_interaction()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Covout.html#atomica.programs.Covout.get_outcome"><code class="docutils literal notranslate"><span class="pre">Covout.get_outcome()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Covout.html#atomica.programs.Covout.n_progs"><code class="docutils literal notranslate"><span class="pre">Covout.n_progs</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Covout.html#atomica.programs.Covout.sample"><code class="docutils literal notranslate"><span class="pre">Covout.sample()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Covout.html#atomica.programs.Covout.update_outcomes"><code class="docutils literal notranslate"><span class="pre">Covout.update_outcomes()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html">atomica.programs.Program</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program"><code class="docutils literal notranslate"><span class="pre">Program</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.baseline_spend"><code class="docutils literal notranslate"><span class="pre">Program.baseline_spend</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.capacity_constraint"><code class="docutils literal notranslate"><span class="pre">Program.capacity_constraint</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.coverage"><code class="docutils literal notranslate"><span class="pre">Program.coverage</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.get_capacity"><code class="docutils literal notranslate"><span class="pre">Program.get_capacity()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.get_prop_covered"><code class="docutils literal notranslate"><span class="pre">Program.get_prop_covered()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.get_spend"><code class="docutils literal notranslate"><span class="pre">Program.get_spend()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.is_one_off"><code class="docutils literal notranslate"><span class="pre">Program.is_one_off</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.label"><code class="docutils literal notranslate"><span class="pre">Program.label</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.name"><code class="docutils literal notranslate"><span class="pre">Program.name</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.sample"><code class="docutils literal notranslate"><span class="pre">Program.sample()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.saturation"><code class="docutils literal notranslate"><span class="pre">Program.saturation</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.spend_data"><code class="docutils literal notranslate"><span class="pre">Program.spend_data</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.target_comps"><code class="docutils literal notranslate"><span class="pre">Program.target_comps</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.target_pops"><code class="docutils literal notranslate"><span class="pre">Program.target_pops</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.Program.html#atomica.programs.Program.unit_cost"><code class="docutils literal notranslate"><span class="pre">Program.unit_cost</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramInstructions.html">atomica.programs.ProgramInstructions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramInstructions.html#atomica.programs.ProgramInstructions"><code class="docutils literal notranslate"><span class="pre">ProgramInstructions</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramInstructions.html#atomica.programs.ProgramInstructions.scale_alloc"><code class="docutils literal notranslate"><span class="pre">ProgramInstructions.scale_alloc()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html">atomica.programs.ProgramSet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet"><code class="docutils literal notranslate"><span class="pre">ProgramSet</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.add_comp"><code class="docutils literal notranslate"><span class="pre">ProgramSet.add_comp()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.add_par"><code class="docutils literal notranslate"><span class="pre">ProgramSet.add_par()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.add_pop"><code class="docutils literal notranslate"><span class="pre">ProgramSet.add_pop()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.add_program"><code class="docutils literal notranslate"><span class="pre">ProgramSet.add_program()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.from_spreadsheet"><code class="docutils literal notranslate"><span class="pre">ProgramSet.from_spreadsheet()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.get_alloc"><code class="docutils literal notranslate"><span class="pre">ProgramSet.get_alloc()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.get_capacities"><code class="docutils literal notranslate"><span class="pre">ProgramSet.get_capacities()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.get_outcomes"><code class="docutils literal notranslate"><span class="pre">ProgramSet.get_outcomes()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.get_prop_coverage"><code class="docutils literal notranslate"><span class="pre">ProgramSet.get_prop_coverage()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.new"><code class="docutils literal notranslate"><span class="pre">ProgramSet.new()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.remove_comp"><code class="docutils literal notranslate"><span class="pre">ProgramSet.remove_comp()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.remove_par"><code class="docutils literal notranslate"><span class="pre">ProgramSet.remove_par()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.remove_pop"><code class="docutils literal notranslate"><span class="pre">ProgramSet.remove_pop()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.remove_program"><code class="docutils literal notranslate"><span class="pre">ProgramSet.remove_program()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.sample"><code class="docutils literal notranslate"><span class="pre">ProgramSet.sample()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.to_spreadsheet"><code class="docutils literal notranslate"><span class="pre">ProgramSet.to_spreadsheet()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.to_workbook"><code class="docutils literal notranslate"><span class="pre">ProgramSet.to_workbook()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.programs.ProgramSet.html#atomica.programs.ProgramSet.validate"><code class="docutils literal notranslate"><span class="pre">ProgramSet.validate()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.programs.InvalidProgramBook.html">atomica.programs.InvalidProgramBook</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.programs.InvalidProgramBook.html#atomica.programs.InvalidProgramBook"><code class="docutils literal notranslate"><span class="pre">InvalidProgramBook</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.project.html">atomica.project</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html">atomica.project.Project</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project"><code class="docutils literal notranslate"><span class="pre">Project</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.calibrate"><code class="docutils literal notranslate"><span class="pre">Project.calibrate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.create_databook"><code class="docutils literal notranslate"><span class="pre">Project.create_databook()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.load"><code class="docutils literal notranslate"><span class="pre">Project.load()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.load_databook"><code class="docutils literal notranslate"><span class="pre">Project.load_databook()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.load_progbook"><code class="docutils literal notranslate"><span class="pre">Project.load_progbook()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.make_parset"><code class="docutils literal notranslate"><span class="pre">Project.make_parset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.make_progbook"><code class="docutils literal notranslate"><span class="pre">Project.make_progbook()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.make_scenario"><code class="docutils literal notranslate"><span class="pre">Project.make_scenario()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.optim"><code class="docutils literal notranslate"><span class="pre">Project.optim()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.parset"><code class="docutils literal notranslate"><span class="pre">Project.parset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.parsets"><code class="docutils literal notranslate"><span class="pre">Project.parsets</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.progset"><code class="docutils literal notranslate"><span class="pre">Project.progset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.result"><code class="docutils literal notranslate"><span class="pre">Project.result()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.run_optimization"><code class="docutils literal notranslate"><span class="pre">Project.run_optimization()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.run_sampled_sims"><code class="docutils literal notranslate"><span class="pre">Project.run_sampled_sims()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.run_scenarios"><code class="docutils literal notranslate"><span class="pre">Project.run_scenarios()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.run_sim"><code class="docutils literal notranslate"><span class="pre">Project.run_sim()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.save"><code class="docutils literal notranslate"><span class="pre">Project.save()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.scen"><code class="docutils literal notranslate"><span class="pre">Project.scen()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.Project.html#atomica.project.Project.update_settings"><code class="docutils literal notranslate"><span class="pre">Project.update_settings()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.project.ProjectSettings.html">atomica.project.ProjectSettings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.project.ProjectSettings.html#atomica.project.ProjectSettings"><code class="docutils literal notranslate"><span class="pre">ProjectSettings</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.ProjectSettings.html#atomica.project.ProjectSettings.tvec"><code class="docutils literal notranslate"><span class="pre">ProjectSettings.tvec</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.project.ProjectSettings.html#atomica.project.ProjectSettings.update_time_vector"><code class="docutils literal notranslate"><span class="pre">ProjectSettings.update_time_vector()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.reconciliation.html">atomica.reconciliation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.reconciliation.reconcile.html">atomica.reconciliation.reconcile</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.reconciliation.reconcile.html#atomica.reconciliation.reconcile"><code class="docutils literal notranslate"><span class="pre">reconcile()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.results.html">atomica.results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.results.export_results.html">atomica.results.export_results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.results.export_results.html#atomica.results.export_results"><code class="docutils literal notranslate"><span class="pre">export_results()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html">atomica.results.Ensemble</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble"><code class="docutils literal notranslate"><span class="pre">Ensemble</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.add"><code class="docutils literal notranslate"><span class="pre">Ensemble.add()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.baseline"><code class="docutils literal notranslate"><span class="pre">Ensemble.baseline</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.boxplot"><code class="docutils literal notranslate"><span class="pre">Ensemble.boxplot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.mapping_function"><code class="docutils literal notranslate"><span class="pre">Ensemble.mapping_function</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.n_samples"><code class="docutils literal notranslate"><span class="pre">Ensemble.n_samples</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.outputs"><code class="docutils literal notranslate"><span class="pre">Ensemble.outputs</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.plot_bars"><code class="docutils literal notranslate"><span class="pre">Ensemble.plot_bars()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.plot_distribution"><code class="docutils literal notranslate"><span class="pre">Ensemble.plot_distribution()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.plot_series"><code class="docutils literal notranslate"><span class="pre">Ensemble.plot_series()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.pops"><code class="docutils literal notranslate"><span class="pre">Ensemble.pops</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.results"><code class="docutils literal notranslate"><span class="pre">Ensemble.results</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.run_sims"><code class="docutils literal notranslate"><span class="pre">Ensemble.run_sims()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.samples"><code class="docutils literal notranslate"><span class="pre">Ensemble.samples</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.set_baseline"><code class="docutils literal notranslate"><span class="pre">Ensemble.set_baseline()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.tvec"><code class="docutils literal notranslate"><span class="pre">Ensemble.tvec</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Ensemble.html#atomica.results.Ensemble.update"><code class="docutils literal notranslate"><span class="pre">Ensemble.update()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html">atomica.results.Result</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result"><code class="docutils literal notranslate"><span class="pre">Result</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.charac_names"><code class="docutils literal notranslate"><span class="pre">Result.charac_names()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.check_for_nans"><code class="docutils literal notranslate"><span class="pre">Result.check_for_nans()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.comp_names"><code class="docutils literal notranslate"><span class="pre">Result.comp_names()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.dt"><code class="docutils literal notranslate"><span class="pre">Result.dt</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.export_raw"><code class="docutils literal notranslate"><span class="pre">Result.export_raw()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.framework"><code class="docutils literal notranslate"><span class="pre">Result.framework</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.get_alloc"><code class="docutils literal notranslate"><span class="pre">Result.get_alloc()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.get_coverage"><code class="docutils literal notranslate"><span class="pre">Result.get_coverage()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.get_equivalent_alloc"><code class="docutils literal notranslate"><span class="pre">Result.get_equivalent_alloc()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.get_variable"><code class="docutils literal notranslate"><span class="pre">Result.get_variable()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.link_names"><code class="docutils literal notranslate"><span class="pre">Result.link_names()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.par_names"><code class="docutils literal notranslate"><span class="pre">Result.par_names()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.plot"><code class="docutils literal notranslate"><span class="pre">Result.plot()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.pop_labels"><code class="docutils literal notranslate"><span class="pre">Result.pop_labels</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.t"><code class="docutils literal notranslate"><span class="pre">Result.t</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.results.Result.html#atomica.results.Result.used_programs"><code class="docutils literal notranslate"><span class="pre">Result.used_programs</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.scenarios.html">atomica.scenarios</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html">atomica.scenarios.BudgetScenario</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario"><code class="docutils literal notranslate"><span class="pre">BudgetScenario</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario.active"><code class="docutils literal notranslate"><span class="pre">BudgetScenario.active</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario.get_instructions"><code class="docutils literal notranslate"><span class="pre">BudgetScenario.get_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario.get_parset"><code class="docutils literal notranslate"><span class="pre">BudgetScenario.get_parset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario.get_progset"><code class="docutils literal notranslate"><span class="pre">BudgetScenario.get_progset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario.parsetname"><code class="docutils literal notranslate"><span class="pre">BudgetScenario.parsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario.progsetname"><code class="docutils literal notranslate"><span class="pre">BudgetScenario.progsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.BudgetScenario.html#atomica.scenarios.BudgetScenario.run"><code class="docutils literal notranslate"><span class="pre">BudgetScenario.run()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html">atomica.scenarios.CombinedScenario</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario"><code class="docutils literal notranslate"><span class="pre">CombinedScenario</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.active"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.active</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.get_instructions"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.get_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.get_parset"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.get_parset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.get_progset"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.get_progset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.interpolation"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.interpolation</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.parsetname"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.parsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.progsetname"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.progsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.run"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.run()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CombinedScenario.html#atomica.scenarios.CombinedScenario.scenario_values"><code class="docutils literal notranslate"><span class="pre">CombinedScenario.scenario_values</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html">atomica.scenarios.CoverageScenario</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario"><code class="docutils literal notranslate"><span class="pre">CoverageScenario</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario.active"><code class="docutils literal notranslate"><span class="pre">CoverageScenario.active</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario.get_instructions"><code class="docutils literal notranslate"><span class="pre">CoverageScenario.get_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario.get_parset"><code class="docutils literal notranslate"><span class="pre">CoverageScenario.get_parset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario.get_progset"><code class="docutils literal notranslate"><span class="pre">CoverageScenario.get_progset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario.parsetname"><code class="docutils literal notranslate"><span class="pre">CoverageScenario.parsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario.progsetname"><code class="docutils literal notranslate"><span class="pre">CoverageScenario.progsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.CoverageScenario.html#atomica.scenarios.CoverageScenario.run"><code class="docutils literal notranslate"><span class="pre">CoverageScenario.run()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html">atomica.scenarios.ParameterScenario</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario"><code class="docutils literal notranslate"><span class="pre">ParameterScenario</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.active"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.active</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.add"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.add()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.get_instructions"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.get_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.get_parset"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.get_parset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.get_progset"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.get_progset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.interpolation"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.interpolation</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.parsetname"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.parsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.progsetname"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.progsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.run"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.run()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.ParameterScenario.html#atomica.scenarios.ParameterScenario.scenario_values"><code class="docutils literal notranslate"><span class="pre">ParameterScenario.scenario_values</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html">atomica.scenarios.Scenario</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario"><code class="docutils literal notranslate"><span class="pre">Scenario</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario.active"><code class="docutils literal notranslate"><span class="pre">Scenario.active</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario.get_instructions"><code class="docutils literal notranslate"><span class="pre">Scenario.get_instructions()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario.get_parset"><code class="docutils literal notranslate"><span class="pre">Scenario.get_parset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario.get_progset"><code class="docutils literal notranslate"><span class="pre">Scenario.get_progset()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario.parsetname"><code class="docutils literal notranslate"><span class="pre">Scenario.parsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario.progsetname"><code class="docutils literal notranslate"><span class="pre">Scenario.progsetname</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.scenarios.Scenario.html#atomica.scenarios.Scenario.run"><code class="docutils literal notranslate"><span class="pre">Scenario.run()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.system.html">atomica.system</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.system.atomica_path.html">atomica.system.atomica_path</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.system.atomica_path.html#atomica.system.atomica_path"><code class="docutils literal notranslate"><span class="pre">atomica_path()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.system.FrameworkSettings.html">atomica.system.FrameworkSettings</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.system.FrameworkSettings.html#atomica.system.FrameworkSettings"><code class="docutils literal notranslate"><span class="pre">FrameworkSettings</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.system.NotFoundError.html">atomica.system.NotFoundError</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.system.NotFoundError.html#atomica.system.NotFoundError"><code class="docutils literal notranslate"><span class="pre">NotFoundError</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.utils.html">atomica.utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.datetime_to_year.html">atomica.utils.datetime_to_year</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.datetime_to_year.html#atomica.utils.datetime_to_year"><code class="docutils literal notranslate"><span class="pre">datetime_to_year()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.evaluate_plot_string.html">atomica.utils.evaluate_plot_string</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.evaluate_plot_string.html#atomica.utils.evaluate_plot_string"><code class="docutils literal notranslate"><span class="pre">evaluate_plot_string()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.format_duration.html">atomica.utils.format_duration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.format_duration.html#atomica.utils.format_duration"><code class="docutils literal notranslate"><span class="pre">format_duration()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.nested_loop.html">atomica.utils.nested_loop</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.nested_loop.html#atomica.utils.nested_loop"><code class="docutils literal notranslate"><span class="pre">nested_loop()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.parallel_progress.html">atomica.utils.parallel_progress</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.parallel_progress.html#atomica.utils.parallel_progress"><code class="docutils literal notranslate"><span class="pre">parallel_progress()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.parent_dir.html">atomica.utils.parent_dir</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.parent_dir.html#atomica.utils.parent_dir"><code class="docutils literal notranslate"><span class="pre">parent_dir()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.start_logging.html">atomica.utils.start_logging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.start_logging.html#atomica.utils.start_logging"><code class="docutils literal notranslate"><span class="pre">start_logging()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.stop_logging.html">atomica.utils.stop_logging</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.stop_logging.html#atomica.utils.stop_logging"><code class="docutils literal notranslate"><span class="pre">stop_logging()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html">atomica.utils.NDict</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict"><code class="docutils literal notranslate"><span class="pre">NDict</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.__add__"><code class="docutils literal notranslate"><span class="pre">NDict.__add__()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.append"><code class="docutils literal notranslate"><span class="pre">NDict.append()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.clear"><code class="docutils literal notranslate"><span class="pre">NDict.clear()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.copy"><code class="docutils literal notranslate"><span class="pre">NDict.copy()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.dict_items"><code class="docutils literal notranslate"><span class="pre">NDict.dict_items()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.dict_keys"><code class="docutils literal notranslate"><span class="pre">NDict.dict_keys()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.dict_values"><code class="docutils literal notranslate"><span class="pre">NDict.dict_values()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.disp"><code class="docutils literal notranslate"><span class="pre">NDict.disp()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.enumitems"><code class="docutils literal notranslate"><span class="pre">NDict.enumitems()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.enumkeys"><code class="docutils literal notranslate"><span class="pre">NDict.enumkeys()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.enumvals"><code class="docutils literal notranslate"><span class="pre">NDict.enumvals()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.enumvalues"><code class="docutils literal notranslate"><span class="pre">NDict.enumvalues()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.export"><code class="docutils literal notranslate"><span class="pre">NDict.export()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.filter"><code class="docutils literal notranslate"><span class="pre">NDict.filter()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.filtervals"><code class="docutils literal notranslate"><span class="pre">NDict.filtervals()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.findbykey"><code class="docutils literal notranslate"><span class="pre">NDict.findbykey()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.findbyval"><code class="docutils literal notranslate"><span class="pre">NDict.findbyval()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.findkeys"><code class="docutils literal notranslate"><span class="pre">NDict.findkeys()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.fromeach"><code class="docutils literal notranslate"><span class="pre">NDict.fromeach()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.fromkeys"><code class="docutils literal notranslate"><span class="pre">NDict.fromkeys()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.get"><code class="docutils literal notranslate"><span class="pre">NDict.get()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.getnested"><code class="docutils literal notranslate"><span class="pre">NDict.getnested()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.index"><code class="docutils literal notranslate"><span class="pre">NDict.index()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.insert"><code class="docutils literal notranslate"><span class="pre">NDict.insert()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.items"><code class="docutils literal notranslate"><span class="pre">NDict.items()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.iteritems"><code class="docutils literal notranslate"><span class="pre">NDict.iteritems()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.iternested"><code class="docutils literal notranslate"><span class="pre">NDict.iternested()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.keys"><code class="docutils literal notranslate"><span class="pre">NDict.keys()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.make"><code class="docutils literal notranslate"><span class="pre">NDict.make()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.makefrom"><code class="docutils literal notranslate"><span class="pre">NDict.makefrom()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.makenested"><code class="docutils literal notranslate"><span class="pre">NDict.makenested()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.map"><code class="docutils literal notranslate"><span class="pre">NDict.map()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.pop"><code class="docutils literal notranslate"><span class="pre">NDict.pop()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.popitem"><code class="docutils literal notranslate"><span class="pre">NDict.popitem()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.promote"><code class="docutils literal notranslate"><span class="pre">NDict.promote()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.remove"><code class="docutils literal notranslate"><span class="pre">NDict.remove()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.rename"><code class="docutils literal notranslate"><span class="pre">NDict.rename()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.reverse"><code class="docutils literal notranslate"><span class="pre">NDict.reverse()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.reversed"><code class="docutils literal notranslate"><span class="pre">NDict.reversed()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.setdefault"><code class="docutils literal notranslate"><span class="pre">NDict.setdefault()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.setitem"><code class="docutils literal notranslate"><span class="pre">NDict.setitem()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.setnested"><code class="docutils literal notranslate"><span class="pre">NDict.setnested()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.sort"><code class="docutils literal notranslate"><span class="pre">NDict.sort()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.sorted"><code class="docutils literal notranslate"><span class="pre">NDict.sorted()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.toeach"><code class="docutils literal notranslate"><span class="pre">NDict.toeach()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.update"><code class="docutils literal notranslate"><span class="pre">NDict.update()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.valind"><code class="docutils literal notranslate"><span class="pre">NDict.valind()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.NDict.html#atomica.utils.NDict.values"><code class="docutils literal notranslate"><span class="pre">NDict.values()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.NamedItem.html">atomica.utils.NamedItem</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.NamedItem.html#atomica.utils.NamedItem"><code class="docutils literal notranslate"><span class="pre">NamedItem</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.Quiet.html">atomica.utils.Quiet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.Quiet.html#atomica.utils.Quiet"><code class="docutils literal notranslate"><span class="pre">Quiet</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html">atomica.utils.TimeSeries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries"><code class="docutils literal notranslate"><span class="pre">TimeSeries</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.assumption"><code class="docutils literal notranslate"><span class="pre">TimeSeries.assumption</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.copy"><code class="docutils literal notranslate"><span class="pre">TimeSeries.copy()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.get"><code class="docutils literal notranslate"><span class="pre">TimeSeries.get()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.get_arrays"><code class="docutils literal notranslate"><span class="pre">TimeSeries.get_arrays()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.has_data"><code class="docutils literal notranslate"><span class="pre">TimeSeries.has_data</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.has_time_data"><code class="docutils literal notranslate"><span class="pre">TimeSeries.has_time_data</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.insert"><code class="docutils literal notranslate"><span class="pre">TimeSeries.insert()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.interpolate"><code class="docutils literal notranslate"><span class="pre">TimeSeries.interpolate()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.remove"><code class="docutils literal notranslate"><span class="pre">TimeSeries.remove()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.remove_after"><code class="docutils literal notranslate"><span class="pre">TimeSeries.remove_after()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.remove_before"><code class="docutils literal notranslate"><span class="pre">TimeSeries.remove_before()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.remove_between"><code class="docutils literal notranslate"><span class="pre">TimeSeries.remove_between()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.sample"><code class="docutils literal notranslate"><span class="pre">TimeSeries.sample()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.sigma"><code class="docutils literal notranslate"><span class="pre">TimeSeries.sigma</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.t"><code class="docutils literal notranslate"><span class="pre">TimeSeries.t</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.units"><code class="docutils literal notranslate"><span class="pre">TimeSeries.units</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="../../_autosummary/atomica.utils.TimeSeries.html#atomica.utils.TimeSeries.vals"><code class="docutils literal notranslate"><span class="pre">TimeSeries.vals</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/atomica.version.html">atomica.version</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Atomica</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">atomica.model</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for atomica.model</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Implements the Atomica computational graph</span>

<span class="sd">Fundamentally, models in Atomica can be represented as a graph, with</span>
<span class="sd">nodes corresponding to compartments, and edges corresponding to transitions/links.</span>
<span class="sd">This module implements the graph representation of the Framework in a form that can</span>
<span class="sd">be numerically integrated. It also implements the methods to actually perform the integration.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">.system</span> <span class="kn">import</span> <span class="n">NotFoundError</span>
<span class="kn">from</span> <span class="nn">.system</span> <span class="kn">import</span> <span class="n">logger</span>
<span class="kn">from</span> <span class="nn">.system</span> <span class="kn">import</span> <span class="n">FrameworkSettings</span> <span class="k">as</span> <span class="n">FS</span>
<span class="kn">from</span> <span class="nn">.results</span> <span class="kn">import</span> <span class="n">Result</span>
<span class="kn">from</span> <span class="nn">.function_parser</span> <span class="kn">import</span> <span class="n">parse_function</span>
<span class="kn">from</span> <span class="nn">.version</span> <span class="kn">import</span> <span class="n">version</span><span class="p">,</span> <span class="n">gitinfo</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">import</span> <span class="nn">sciris</span> <span class="k">as</span> <span class="nn">sc</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">.programs</span> <span class="kn">import</span> <span class="n">ProgramSet</span><span class="p">,</span> <span class="n">ProgramInstructions</span>
<span class="kn">from</span> <span class="nn">.parameters</span> <span class="kn">import</span> <span class="n">Parameter</span> <span class="k">as</span> <span class="n">ParsetParameter</span>
<span class="kn">from</span> <span class="nn">.parameters</span> <span class="kn">import</span> <span class="n">ParameterSet</span> <span class="k">as</span> <span class="n">ParameterSet</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">model_settings</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">model_settings</span><span class="p">[</span><span class="s2">&quot;tolerance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-6</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;BadInitialization&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ModelError&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Variable&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Compartment&quot;</span><span class="p">,</span>
    <span class="s2">&quot;JunctionCompartment&quot;</span><span class="p">,</span>
    <span class="s2">&quot;ResidualJunctionCompartment&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SourceCompartment&quot;</span><span class="p">,</span>
    <span class="s2">&quot;SinkCompartment&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TimedCompartment&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Characteristic&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Parameter&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Link&quot;</span><span class="p">,</span>
    <span class="s2">&quot;TimedLink&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Population&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Model&quot;</span><span class="p">,</span>
    <span class="s2">&quot;run_model&quot;</span><span class="p">,</span>
<span class="p">]</span>


<div class="viewcode-block" id="BadInitialization">
<a class="viewcode-back" href="../../_autosummary/atomica.model.BadInitialization.html#atomica.model.BadInitialization">[docs]</a>
<span class="k">class</span> <span class="nc">BadInitialization</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Error for invalid conditions</span>

<span class="sd">    This error gets raised if the simulation exited due to a bad initialization, specifically</span>
<span class="sd">    due to negative initial popsizes or an excessive residual. This commonly happens if the</span>
<span class="sd">    initial conditions are being programatically varied and thus may be an expected error.</span>
<span class="sd">    This error can then be caught and dealt with appropriately. For example:</span>

<span class="sd">    - calibration will catch this error and instruct ASD to reject the proposed parameters</span>
<span class="sd">    - ``Ensemble.run_sims`` catches this error and tries another sample</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span></div>



<div class="viewcode-block" id="ModelError">
<a class="viewcode-back" href="../../_autosummary/atomica.model.ModelError.html#atomica.model.ModelError">[docs]</a>
<span class="k">class</span> <span class="nc">ModelError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Exception type for general model errors</span>

<span class="sd">    This error gets raised for generic errors arising during integration</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">pass</span></div>



<div class="viewcode-block" id="Variable">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable">[docs]</a>
<span class="k">class</span> <span class="nc">Variable</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Integration object to manage compartments, characteristics, parameters, and links</span>

<span class="sd">    This is a lightweight abstract class to store arrays of values at each simulation time step. It includes</span>
<span class="sd">    functionality that is common to all integration objects, and defines the interface to be implemented</span>
<span class="sd">    by derived classes.</span>

<span class="sd">        :param pop: A :class:`Population` instance. This allows references back to the population containing an object</span>
<span class="sd">                    (which facilitates a number of operations such as those that require the population&#39;s size)</span>
<span class="sd">        :param id: ID is a tuple that uniquely identifies the Variable within a model.</span>
<span class="sd">                    By convention, this is a ``population:code_name`` tuple</span>
<span class="sd">                    (but in the case of links, there are additional terms)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>  <span class="c1">#: Unique identifier for the integration object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># : Array of time values. This should be a reference to the base array stored in a :class:`model` object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># : Time step size</span>
        <span class="k">if</span> <span class="s2">&quot;vals&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># If a derived class implements a @property method for `vals`, then don&#39;t instantiate it as an attribute</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># : The fundamental values stored by this object</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;unknown&quot;</span>  <span class="c1">#: The units for the quantity, used for plotting and for validation. Note that the default ``&#39;unknown&#39;`` units are distinct to dimensionless units, which have value ``&#39;&#39;``</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pop</span> <span class="o">=</span> <span class="n">pop</span>  <span class="c1">#: Reference back to the Population containing this object</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Variable code name</span>

<span class="sd">        This is implemented as a property method because the ``id`` of the ``Variable`` is a</span>
<span class="sd">        tuple containing the population name and the variable code name, so this property</span>
<span class="sd">        method returns just the variable code name portion. That way, storage does not need</span>
<span class="sd">        to be duplicated.</span>

<span class="sd">        :return: A code name</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<div class="viewcode-block" id="Variable.preallocate">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.preallocate">[docs]</a>
    <span class="k">def</span> <span class="nf">preallocate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tvec</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Preallocate data storage</span>

<span class="sd">        This method gets called just before integration, once the final sizes of the arrays are known.</span>
<span class="sd">        Performance is improved by preallocating the arrays. The ``tvec`` attribute is assigned</span>
<span class="sd">        as-is, so it is typically a reference to the array stored in the parent ``Model`` object. Thus,</span>
<span class="sd">        there is no duplication of storage there, and ``Variable.tvec`` is mainly for convenience when</span>
<span class="sd">        interpolating or plotting.</span>

<span class="sd">        This method may be overloaded in derived classes to preallocate other variables specific</span>
<span class="sd">        to those classes.</span>

<span class="sd">        :param tvec: An array of time values</span>
<span class="sd">        :param dt: Time step size</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">tvec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">tvec</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span></div>


<div class="viewcode-block" id="Variable.plot">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.plot">[docs]</a>
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Produce a time series plot</span>

<span class="sd">        This is a quick function to make a basic line plot of this ``Variable``. Mainly</span>
<span class="sd">        intended for debugging. Production-ready plots should be generated using the</span>
<span class="sd">        plotting library functions instead</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Year&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">units</span><span class="p">))</span></div>


<div class="viewcode-block" id="Variable.update">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.update">[docs]</a>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the value at a given time index</span>

<span class="sd">        This method performs any required computations to update the value</span>
<span class="sd">        of the variable at a given time index. For example, Parameters may require</span>
<span class="sd">        their update function to be called, while characteristics need their</span>
<span class="sd">        source compartments to be added up.</span>

<span class="sd">        This method generally must be overloaded in derived classes e.g. :meth:`Parameter.update`</span>

<span class="sd">        :param ti: Time index to update</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span></div>


<div class="viewcode-block" id="Variable.set_dynamic">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Variable.html#atomica.model.Variable.set_dynamic">[docs]</a>
    <span class="k">def</span> <span class="nf">set_dynamic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make the variable a dependency</span>

<span class="sd">        For Compartments and Links, this does nothing. For Characteristics and</span>
<span class="sd">        Parameters, it will set the dynamic flag, but in addition, any validation constraints e.g. a Parameter</span>
<span class="sd">        that depends on Links cannot itself be dynamic, will be enforced.</span>

<span class="sd">        This method generally must be overloaded in derived classes e.g. :meth:`Parameter.set_dynamic`</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span></div>


    <span class="k">def</span> <span class="nf">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span>

    <span class="k">def</span> <span class="nf">relink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pop</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> &quot;</span><span class="si">%s</span><span class="s1">&quot; </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shortcut to access .vals attribute</span>

<span class="sd">        This simplifies syntax for the most common operations on Variable objects, but most importantly,</span>
<span class="sd">        enables derived classes that implement a ``@property`` method for ``vals`` to also overload the</span>
<span class="sd">        indexing.</span>

<span class="sd">        e.g. ``alive[ti]`` or ``b_rate[ti]``</span>

<span class="sd">        :param key: Indexer passed directly to the numpy array ``self.vals[key]``</span>
<span class="sd">        :return: A float or array of floats the same size as ``key``</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shortcut to set .vals attribute</span>

<span class="sd">        This method assigns values to the `.vals` attribute e.g., ``sus[ti] = 0`` instead of</span>
<span class="sd">        ``sus.vals[ti] = 0``. Importantly, this allows the derived class to overload ``__getitem__``</span>
<span class="sd">        if ``vals`` is a property method instead of an actual array.</span>

<span class="sd">        :param key: Indexer passed directly to the numpy array ``self.vals[item]``</span>
<span class="sd">        :param value: Value to assign to the result of the indexing operation</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div>



<div class="viewcode-block" id="Compartment">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment">[docs]</a>
<span class="k">class</span> <span class="nc">Compartment</span><span class="p">(</span><span class="n">Variable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class to wrap up data for one compartment within a cascade network.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">Variable</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="o">=</span><span class="n">pop</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;Number of people&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inlinks</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_outflow</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Variable</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inlinks</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inlinks</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">relink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">):</span>
        <span class="n">Variable</span><span class="o">.</span><span class="n">relink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span> <span class="o">=</span> <span class="p">[</span><span class="n">objs</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inlinks</span> <span class="o">=</span> <span class="p">[</span><span class="n">objs</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inlinks</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">outflow</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the outflow at all times</span>

<span class="sd">        :return: The sum of outgoing links at all time indices</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Return the outflow at each timestep - for a junction, this is equal to the number</span>
        <span class="c1"># of people that were in the junction</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">vals</span>
        <span class="k">return</span> <span class="n">x</span>

    <span class="c1"># Function below is a reference implementation but isn&#39;t used or needed anywhere yet</span>
    <span class="c1"># Keeping it here just in case it&#39;s useful later</span>
    <span class="c1">#</span>
    <span class="c1"># def inflow(self, ti:int=None):</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#     Return the inflow at specified times</span>
    <span class="c1">#</span>
    <span class="c1">#     :param ti: Optionally specify a time index. Default is all times</span>
    <span class="c1">#     :return: If `ti` is None, an array the same size as `self.t`. Otherwise, returns a float</span>
    <span class="c1">#</span>
    <span class="c1">#     &quot;&quot;&quot;</span>
    <span class="c1">#</span>
    <span class="c1">#     if ti is None:</span>
    <span class="c1">#         ti = np.arange(0, len(self.t))</span>
    <span class="c1">#         x = np.zeros(self.t.shape)</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         x = 0</span>
    <span class="c1">#</span>
    <span class="c1">#     for link in self.inlinks:</span>
    <span class="c1">#         x += link[ti]</span>
    <span class="c1">#</span>
    <span class="c1">#     return x</span>

    <span class="k">def</span> <span class="nf">expected_duration</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="c1"># Returns the expected number of years that an individual is expected to remain</span>
        <span class="c1"># in this compartment for, if the outgoing flow rates are maintained</span>
        <span class="k">if</span> <span class="n">ti</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ti</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">))</span>

        <span class="n">outflow_probability</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Outflow probability at this timestep</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">:</span>
            <span class="n">par</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">parameter</span>
            <span class="n">transition</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_DURATION</span><span class="p">:</span>
                <span class="n">outflow_probability</span> <span class="o">+=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="p">(</span><span class="n">transition</span> <span class="o">*</span> <span class="n">par</span><span class="o">.</span><span class="n">timescale</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="ow">in</span> <span class="p">{</span><span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_PROBABILITY</span><span class="p">,</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_RATE</span><span class="p">}:</span>
                <span class="n">outflow_probability</span> <span class="o">+=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">transition</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="n">par</span><span class="o">.</span><span class="n">timescale</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_NUMBER</span><span class="p">:</span>
                <span class="n">outflow_probability</span> <span class="o">+=</span> <span class="n">par</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="bp">self</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_PROPORTION</span><span class="p">:</span>
                <span class="n">outflow_probability</span> <span class="o">+=</span> <span class="n">par</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="s2">&quot;Unknown parameter units&quot;</span><span class="p">)</span>

        <span class="n">remain_probability</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">outflow_probability</span>

        <span class="c1"># This is the algorithm - we calculate the probability of leaving after a specific number of time steps, and then</span>
        <span class="c1"># take the expectation value. The example below shows a discrete numerical calculation as well as a closed-form</span>
        <span class="c1"># approximation which is what actually gets used</span>
        <span class="c1"># remain_probability = 0.99</span>
        <span class="c1"># x = np.arange(0,1000)</span>
        <span class="c1"># y = (remain_probability**x)*(1-remain_probability)</span>
        <span class="c1"># numerical = np.sum((x+1) * y) * self.dt # x+1 because if we leave at the first timestep, we are considered to have stayed for dt units of time</span>
        <span class="c1"># analytic = (1 - (1. / np.log(remain_probability) ** 2) * (remain_probability - 1)) * self.dt</span>
        <span class="c1"># print(&#39;numerical=%.2f, analytic=%.2f&#39; % (numerical,analytic))</span>

        <span class="n">dur</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">remain_probability</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">remain_probability</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        <span class="k">return</span> <span class="n">dur</span>

    <span class="k">def</span> <span class="nf">expected_outflow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">):</span>
        <span class="c1"># After 1 year, where are people expected to be? If people would leave in less than a year,</span>
        <span class="c1"># then the numbers correspond to when the compartment is empty</span>
        <span class="n">popsize</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>  <span class="c1"># This is the number of people who are leaving</span>

        <span class="n">outflow</span> <span class="o">=</span> <span class="p">{</span><span class="n">link</span><span class="o">.</span><span class="n">dest</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">popsize</span> <span class="o">*</span> <span class="n">link</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">}</span>
        <span class="n">rescale</span> <span class="o">=</span> <span class="n">popsize</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">([</span><span class="n">y</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">outflow</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">outflow</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">outflow</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="o">*=</span> <span class="n">rescale</span>
        <span class="n">outflow</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">popsize</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">([</span><span class="n">y</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">outflow</span><span class="o">.</span><span class="n">items</span><span class="p">()])</span>

        <span class="k">return</span> <span class="n">outflow</span>

<div class="viewcode-block" id="Compartment.resolve_outflows">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.resolve_outflows">[docs]</a>
    <span class="k">def</span> <span class="nf">resolve_outflows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resolve outgoing links and convert to number</span>

<span class="sd">        For the base class, rescale outgoing links so that the compartment won&#39;t go negative</span>

<span class="sd">        :param ti: Time index at which to update link outflows</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">outflow</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">:</span>
            <span class="n">outflow</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">_cache</span>

        <span class="k">if</span> <span class="n">outflow</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">rescale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">outflow</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rescale</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">n</span> <span class="o">=</span> <span class="n">rescale</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_outflow</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">:</span>
            <span class="n">link</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">_cache</span> <span class="o">*</span> <span class="n">n</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cached_outflow</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span></div>


<div class="viewcode-block" id="Compartment.update">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.update">[docs]</a>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update compartment value</span>

<span class="sd">        A compartment update passes in the time to assign (ti). We have</span>

<span class="sd">        x(ti) = x(ti-1) + inflow(ti-1) - outflow(ti-1)</span>

<span class="sd">        Thus, need to initialize the value and then resolve all inflows and outflows</span>
<span class="sd">        Junctions have already been flushed and thus do not need to be updated in this step</span>

<span class="sd">        :param ti:</span>
<span class="sd">        :return:</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">tr</span> <span class="o">=</span> <span class="n">ti</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">tr</span><span class="p">]</span>
        <span class="n">v</span> <span class="o">-=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_outflow</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inlinks</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">tr</span><span class="p">]</span>

        <span class="c1"># Guard against populations becoming negative due to numerical artifacts</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>


<div class="viewcode-block" id="Compartment.connect">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Compartment.html#atomica.model.Compartment.connect">[docs]</a>
    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">par</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct link out of this compartment</span>

<span class="sd">        :param dest: A ``Compartment`` instance</span>
<span class="sd">        :param par: The parameter that the Link will be associated with</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">Link</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">,</span> <span class="n">parameter</span><span class="o">=</span><span class="n">par</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="n">dest</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="JunctionCompartment">
<a class="viewcode-back" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment">[docs]</a>
<span class="k">class</span> <span class="nc">JunctionCompartment</span><span class="p">(</span><span class="n">Compartment</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">duration_group</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        A TimedCompartment has a duration group by virtue of having a `.parameter` attribute and a flush link.</span>
<span class="sd">        A junction might belong to a duration group by having inflows and outflows exclusively from that group.</span>
<span class="sd">        However, it might not be directly attached to any timed compartments, if the connections are entirely</span>
<span class="sd">        via upstream and downstream junctions. Junctions also do not have flush links. Therefore, we record</span>
<span class="sd">        membership in the duration group by specifying the name of the parameter in the (indirect) upstream</span>
<span class="sd">        and downstream compartments.</span>

<span class="sd">        Note that having connections to timed compartments does not itself indicate membership in the duration</span>
<span class="sd">        group - the junction is only a member if all of the upstream and downstream compartments belong to the</span>
<span class="sd">        same duration group. The duration group is determined in framework validation and stored in the framework.</span>

<span class="sd">        :param pop:</span>
<span class="sd">        :param name:</span>
<span class="sd">        :param duration_group: Optionally specify a duration group</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">duration_group</span> <span class="o">=</span> <span class="n">duration_group</span>  <span class="c1">#: Store the name of the duration group, if the junction belongs to one</span>

<div class="viewcode-block" id="JunctionCompartment.connect">
<a class="viewcode-back" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.connect">[docs]</a>
    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">par</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct link out of this compartment</span>

<span class="sd">        For junctions, outgoing links are normal links unless the junction belongs to a duration group.</span>
<span class="sd">        If the junction belongs to a duration group, then the output links should all be :class:`TimedLink` instances.</span>

<span class="sd">        :param dest: A ``Compartment`` instance</span>
<span class="sd">        :param par: The parameter that the Link will be associated with</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration_group</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">TimedCompartment</span><span class="p">)</span> <span class="ow">and</span> <span class="n">dest</span><span class="o">.</span><span class="n">duration_group</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration_group</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">JunctionCompartment</span><span class="p">)</span> <span class="ow">and</span> <span class="n">dest</span><span class="o">.</span><span class="n">duration_group</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration_group</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="s2">&quot;Mismatched junction duration groups - the framework has not been validated correctly&quot;</span><span class="p">)</span>
            <span class="n">TimedLink</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">,</span> <span class="n">parameter</span><span class="o">=</span><span class="n">par</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="n">dest</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Link</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">,</span> <span class="n">parameter</span><span class="o">=</span><span class="n">par</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="n">dest</span><span class="p">)</span></div>


<div class="viewcode-block" id="JunctionCompartment.resolve_outflows">
<a class="viewcode-back" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.resolve_outflows">[docs]</a>
    <span class="k">def</span> <span class="nf">resolve_outflows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resolve outgoing links and convert to number</span>

<span class="sd">        For junctions, links are updated in a separate step because the logic is different - instead</span>
<span class="sd">        of the value of links coming from parameters, they come from the inflow into the junction.</span>
<span class="sd">        We cannot update the junctions in the same step as compartments because while the junction</span>
<span class="sd">        subgraphs must be acyclic, the entire system may contain cycles. Therefore it is not possible</span>
<span class="sd">        to determine a topological ordering for the entire system. The system is solvable because for</span>
<span class="sd">        normal compartments, only one transition per timestep is allowed. But regardless, this prevents</span>
<span class="sd">        using graph analysis to determine an execution order for the entire system that would allow</span>
<span class="sd">        junction computation in the same step.</span>

<span class="sd">        :param ti: Time index to resolve outflows</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div>


<div class="viewcode-block" id="JunctionCompartment.update">
<a class="viewcode-back" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.update">[docs]</a>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the junction at given time index</span>

<span class="sd">        For compartments the ``update`` methods steps them forward in time. However, for junctions the</span>
<span class="sd">        value never needs to be stepped forward, because it&#39;s always zero. Thus, this function does nothing.</span>

<span class="sd">        :param ti: Time index to update</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">pass</span></div>


<div class="viewcode-block" id="JunctionCompartment.preallocate">
<a class="viewcode-back" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.preallocate">[docs]</a>
    <span class="k">def</span> <span class="nf">preallocate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tvec</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Preallocate junction values</span>

<span class="sd">        Junction preallocation pre-fills the values with zeros, since the junction must be empty</span>
<span class="sd">        at all times.</span>

<span class="sd">        :param tvec: An array of time values</span>
<span class="sd">        :param dt: Time step size</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">preallocate</span><span class="p">(</span><span class="n">tvec</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>  <span class="c1">#: Junction compartments are always empty (note the first entry may be given a nonzero value after compartment initialization and before the initial flush)</span></div>


<div class="viewcode-block" id="JunctionCompartment.balance">
<a class="viewcode-back" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.balance">[docs]</a>
    <span class="k">def</span> <span class="nf">balance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Balance junction inflows and outflows</span>

<span class="sd">        This is the primary update for a junction - where outflows are adjusted so that they</span>
<span class="sd">        equal the inflows. It&#39;s analogous to `resolve_outflows` as a primary update method, but</span>
<span class="sd">        it takes place at a separate integration stage (once the outflows for normal compartments</span>
<span class="sd">        have been finalized, as these outputs serve as the junction inputs in that same timestep)</span>
<span class="sd">        After this method is called, all outflows should equal inflows</span>

<span class="sd">        The parameter workflow is simplified because all links flowing out of junctions must be</span>
<span class="sd">        in &#39;proportion&#39; units, so they can be looked up and used directly.</span>

<span class="sd">        :param ti: Time index to update (scalar only, as this function is only called during integration)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># First, work out the total inflow that needs to pass through the junction</span>
        <span class="n">net_inflow</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration_group</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inlinks</span><span class="p">:</span>
                <span class="n">net_inflow</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span>  <span class="c1"># If part of a duration group, get the flow from TimedLink._vals</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inlinks</span><span class="p">:</span>
                <span class="n">net_inflow</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>  <span class="c1"># If not part of a duration group, get scalar flow from Link.vals</span>

        <span class="c1"># Next, get the total outflow. Note that the parameters are guaranteed to be in proportion units here</span>
        <span class="n">outflow_fractions</span> <span class="o">=</span> <span class="p">[</span><span class="n">link</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">]</span>
        <span class="n">total_outflow</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">outflow_fractions</span><span class="p">)</span>

        <span class="c1"># Finally, assign the inflow to the outflow proportionately accounting for the total outflow downscaling</span>
        <span class="k">for</span> <span class="n">frac</span><span class="p">,</span> <span class="n">link</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">outflow_fractions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration_group</span><span class="p">:</span>
                <span class="n">link</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="n">net_inflow</span> <span class="o">*</span> <span class="n">frac</span> <span class="o">/</span> <span class="n">total_outflow</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">link</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="n">net_inflow</span> <span class="o">*</span> <span class="n">frac</span> <span class="o">/</span> <span class="n">total_outflow</span></div>


<div class="viewcode-block" id="JunctionCompartment.initial_flush">
<a class="viewcode-back" href="../../_autosummary/atomica.model.JunctionCompartment.html#atomica.model.JunctionCompartment.initial_flush">[docs]</a>
    <span class="k">def</span> <span class="nf">initial_flush</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform an initial junction flush</span>

<span class="sd">        If the junction was initialized with a nonzero value, then the initial people need to be flushed.</span>
<span class="sd">        This is distinct from balancing, because the source of the people is the junction itself, rather</span>
<span class="sd">        than the incoming links.</span>

<span class="sd">        In this step, we need to actually update the value of the downstream compartments, rather than</span>
<span class="sd">        updating the link values - the links get rebalanced again based on the parameters after the</span>
<span class="sd">        initial flush has been completed</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Work out the outflow fractions</span>
            <span class="n">outflow_fractions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">link</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">])</span>
            <span class="n">outflow_fractions</span> <span class="o">/=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">outflow_fractions</span><span class="p">)</span>

            <span class="c1"># Assign the inflow directly to the outflow compartments</span>
            <span class="c1"># This is done using the [] indexing on the downstream compartment so it is agnostic</span>
            <span class="c1"># to the downstream compartment type</span>
            <span class="k">for</span> <span class="n">frac</span><span class="p">,</span> <span class="n">link</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">outflow_fractions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">):</span>
                <span class="n">link</span><span class="o">.</span><span class="n">dest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">frac</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>
</div>



<div class="viewcode-block" id="ResidualJunctionCompartment">
<a class="viewcode-back" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment">[docs]</a>
<span class="k">class</span> <span class="nc">ResidualJunctionCompartment</span><span class="p">(</span><span class="n">JunctionCompartment</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Junction with a residual outflow</span>

<span class="sd">    A residual outflow junction has a single additional outflow link</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="ResidualJunctionCompartment.balance">
<a class="viewcode-back" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.balance">[docs]</a>
    <span class="k">def</span> <span class="nf">balance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Balance junction inflows and outflows</span>

<span class="sd">        For a ResidualJunctionCompartment, if the outflows sum to less than 1, rather than</span>
<span class="sd">        scaling them up proportionately, the residual is assigned to the residual link.</span>

<span class="sd">        :param ti: Time index to update (scalar only, as this function is only called during integration)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># First, work out the total inflow that needs to pass through the junction</span>
        <span class="n">net_inflow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration_group</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inlinks</span><span class="p">:</span>
                <span class="n">net_inflow</span> <span class="o">=</span> <span class="n">net_inflow</span> <span class="o">+</span> <span class="n">link</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span>  <span class="c1"># If part of a duration group, get the flow from TimedLink._vals. nb. using += doesn&#39;t work with some array size combinations</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inlinks</span><span class="p">:</span>
                <span class="n">net_inflow</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>  <span class="c1"># If not part of a duration group, get scalar flow from Link.vals</span>

        <span class="n">outflow_fractions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">link</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">parameter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">outflow_fractions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">outflow_fractions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">total_outflow</span> <span class="o">=</span> <span class="n">outflow_fractions</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">total_outflow</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">outflow_fractions</span> <span class="o">/=</span> <span class="n">total_outflow</span>

        <span class="c1"># Calculate outflows</span>
        <span class="n">outflow</span> <span class="o">=</span> <span class="n">net_inflow</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">outflow_fractions</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># Finally, assign the inflow to the outflow proportionately accounting for the total outflow downscaling</span>
        <span class="k">for</span> <span class="n">frac</span><span class="p">,</span> <span class="n">link</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">outflow_fractions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">parameter</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">total_outflow</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">flow</span> <span class="o">=</span> <span class="n">net_inflow</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">outflow</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Sum after multiplying by outflow fractions to reduce numerical precision errors and enforce conserved quantities more accurately</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">flow</span> <span class="o">=</span> <span class="n">net_inflow</span> <span class="o">*</span> <span class="n">frac</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration_group</span><span class="p">:</span>
                <span class="n">link</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="n">flow</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">link</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="n">flow</span></div>


<div class="viewcode-block" id="ResidualJunctionCompartment.initial_flush">
<a class="viewcode-back" href="../../_autosummary/atomica.model.ResidualJunctionCompartment.html#atomica.model.ResidualJunctionCompartment.initial_flush">[docs]</a>
    <span class="k">def</span> <span class="nf">initial_flush</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform an initial junction flush</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Work out the outflow fractions</span>
            <span class="n">outflow_fractions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">link</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">parameter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">outflow_fractions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">outflow_fractions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="n">total_outflow</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">outflow_fractions</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">total_outflow</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">has_residual</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">outflow_fractions</span> <span class="o">/=</span> <span class="n">total_outflow</span>
                <span class="n">has_residual</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># Assign the inflow directly to the outflow compartments</span>
            <span class="c1"># This is done using the [] indexing on the downstream compartment so it is agnostic</span>
            <span class="c1"># to the downstream compartment type</span>

            <span class="c1"># Finally, assign the inflow to the outflow proportionately accounting for the total outflow downscaling</span>
            <span class="k">for</span> <span class="n">frac</span><span class="p">,</span> <span class="n">link</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">outflow_fractions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">parameter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">has_residual</span><span class="p">:</span>
                        <span class="n">link</span><span class="o">.</span><span class="n">dest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">outflow_fractions</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">link</span><span class="o">.</span><span class="n">dest</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">frac</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>
</div>



<div class="viewcode-block" id="SourceCompartment">
<a class="viewcode-back" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment">[docs]</a>
<span class="k">class</span> <span class="nc">SourceCompartment</span><span class="p">(</span><span class="n">Compartment</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Derived class for source compartments</span>

<span class="sd">    Source compartments are unlimited reservoirs, and are subject to limitations like</span>

<span class="sd">    - Unlimited size</span>
<span class="sd">    - No inflows</span>
<span class="sd">    - Only one outflow</span>

<span class="sd">    Therefore, the methods to update these compartments can take some shortcuts not available</span>
<span class="sd">    to normal compartments. These shortcuts are implemented in the overloaded methods here.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="SourceCompartment.preallocate">
<a class="viewcode-back" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.preallocate">[docs]</a>
    <span class="k">def</span> <span class="nf">preallocate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tvec</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">preallocate</span><span class="p">(</span><span class="n">tvec</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>  <span class="c1">#: Source compartments have an unlimited number of people in them. TODO: If this complicates validation, set to 0.0</span></div>


<div class="viewcode-block" id="SourceCompartment.resolve_outflows">
<a class="viewcode-back" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.resolve_outflows">[docs]</a>
    <span class="k">def</span> <span class="nf">resolve_outflows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">:</span>
            <span class="n">link</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="n">link</span><span class="o">.</span><span class="n">_cache</span></div>


<div class="viewcode-block" id="SourceCompartment.update">
<a class="viewcode-back" href="../../_autosummary/atomica.model.SourceCompartment.html#atomica.model.SourceCompartment.update">[docs]</a>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span></div>
</div>



<div class="viewcode-block" id="SinkCompartment">
<a class="viewcode-back" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment">[docs]</a>
<span class="k">class</span> <span class="nc">SinkCompartment</span><span class="p">(</span><span class="n">Compartment</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="SinkCompartment.preallocate">
<a class="viewcode-back" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.preallocate">[docs]</a>
    <span class="k">def</span> <span class="nf">preallocate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tvec</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Preallocate sink compartment</span>

<span class="sd">        A sink compartment is initialized with 0.0 value at the initial timestep</span>

<span class="sd">        :param tvec: Simulation time vector</span>
<span class="sd">        :param dt: Simulation time step</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">preallocate</span><span class="p">(</span><span class="n">tvec</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span></div>


<div class="viewcode-block" id="SinkCompartment.resolve_outflows">
<a class="viewcode-back" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.resolve_outflows">[docs]</a>
    <span class="k">def</span> <span class="nf">resolve_outflows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resolve sink outflows</span>

<span class="sd">        There should not be any outflows, so this function immediately returns</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span></div>


<div class="viewcode-block" id="SinkCompartment.connect">
<a class="viewcode-back" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.connect">[docs]</a>
    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">par</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct link out of sink compartment</span>

<span class="sd">        This method raises an error because sinks cannot have outflows</span>

<span class="sd">        :param dest: A ``Compartment`` instance</span>
<span class="sd">        :param par: The parameter that the Link will be associated with</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="s2">&quot;Sink compartments cannot have outflows&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="SinkCompartment.update">
<a class="viewcode-back" href="../../_autosummary/atomica.model.SinkCompartment.html#atomica.model.SinkCompartment.update">[docs]</a>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update sink compartment value</span>

<span class="sd">        A sink compartment has inputs only</span>

<span class="sd">        :param ti: Time index to update</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">tr</span> <span class="o">=</span> <span class="n">ti</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">tr</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inlinks</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">tr</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span></div>
</div>



<div class="viewcode-block" id="TimedCompartment">
<a class="viewcode-back" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment">[docs]</a>
<span class="k">class</span> <span class="nc">TimedCompartment</span><span class="p">(</span><span class="n">Compartment</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">parameter</span><span class="p">:</span> <span class="n">ParsetParameter</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Instantiate the TimedCompartment</span>

<span class="sd">        Preallocation takes place before the compartment values are initialized. Therefore, we need to</span>
<span class="sd">        calculate the duration here, hence there is a need to take in the parset here.</span>

<span class="sd">        :param pop: A ``Population`` instance (the instance that will store this compartment)</span>
<span class="sd">        :param name: The name of the compartment</span>
<span class="sd">        :param parameter: The parameter that will supply the duration (to be read after the parameter function is evaluated, if applicable)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">Compartment</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="o">=</span><span class="n">pop</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: Primary storage, a matrix of size (duration x timesteps). The first row is the one that people leave from, the last row is the one that people arrive in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">parameter</span>  <span class="c1">#: The parameter to read the duration from - this needs to be done after parameters are precomputed though, in case the duration is coming from a (constant) function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flush_link</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: Reference to the timed outflow link that flushes the compartment. Note that this needs to be set externally because Links are instantiated after Compartments</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">duration_group</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">name</span>

    <span class="k">def</span> <span class="nf">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Compartment</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flush_link</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flush_link</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flush_link</span><span class="o">.</span><span class="n">id</span>

    <span class="k">def</span> <span class="nf">relink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">):</span>
        <span class="c1"># Given a dictionary of objects, restore the internal references</span>
        <span class="n">Compartment</span><span class="o">.</span><span class="n">relink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">flush_link</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flush_link</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">flush_link</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vals</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compartment size</span>

<span class="sd">        This returns the compartment size at all times, obtained by summing over the people in each time bin</span>

<span class="sd">        :return: A numpy array with the compartment size</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve compartment size at given time index</span>

<span class="sd">        By only adding the requested timesteps, this approach is faster than accessing ``vals`` first i.e.</span>

<span class="sd">        &gt;&gt;&gt; self.vals[ti]</span>
<span class="sd">        &gt;&gt;&gt; self[ti] # &lt;-- Faster</span>

<span class="sd">        :param ti: Time index/indices</span>
<span class="sd">        :return: Total compartment size at given time index/indices</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Assign to values assuming constant arrival rate</span>

<span class="sd">        This method takes in the total population size at time(s) ``ti``, and assigns them equally</span>
<span class="sd">        to all of the time bins in the compartment. Currently, this is only expected to be needed</span>
<span class="sd">        during initialization, so for maximum safety, this method will raise an error if any other</span>
<span class="sd">        times are used. This is because setting the value will destroy any information about the</span>
<span class="sd">        distribution of times. This constraint could be safely relaxed if it&#39;s needed for a specific</span>
<span class="sd">        purpose, but otherwise it&#39;s safer not to permit it.</span>

<span class="sd">        :param ti: Time indices to assign. Currently, only `0` is allowed</span>
<span class="sd">        :param value: The value to assign to times `ti`</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ti</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">promotetoarray</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">promotetoarray</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ti</span><span class="o">.</span><span class="n">size</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">ti</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="s2">&quot;For safety, explicitly setting the compartment size for a TimedCompartment can currently only be done for the initial conditions. This requirement can be likely be relaxed if needed for a particular use case&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)))</span>

<div class="viewcode-block" id="TimedCompartment.preallocate">
<a class="viewcode-back" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.preallocate">[docs]</a>
    <span class="k">def</span> <span class="nf">preallocate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tvec</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Preallocate data storage</span>

<span class="sd">        :param tvec: An array of time values</span>
<span class="sd">        :param dt: Time step size</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Preallocating the keyring matrix rounds the duration down</span>
        <span class="c1"># That way, if the duration is less than the step size, the compartment will</span>
        <span class="c1"># be emptied every timestep</span>
        <span class="c1"># Note that the effective duration is _entirely_ driven by the number of rows in `self._vals`</span>
        <span class="c1"># because the logic is simply - flush the topmost row, shift the array by 1, inflow goes in the bottom row</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">tvec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">vals</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;Duration parameter value cannot vary over time&quot;</span>
        <span class="n">duration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">timescale</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">scale_factor</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">max</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">duration</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)),</span> <span class="n">tvec</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>  <span class="c1"># Fortran/column-major order should be faster for summing over lags to get `vals`</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimedCompartment.resolve_outflows">
<a class="viewcode-back" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.resolve_outflows">[docs]</a>
    <span class="k">def</span> <span class="nf">resolve_outflows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Resolve outgoing links</span>

<span class="sd">        At this point, all links going out of the compartment would have had their ``._cache`` value set to the</span>
<span class="sd">        fraction to transfer. This method converts them to numbers, taking into account the fact that only</span>
<span class="sd">        certain subcompartments are eligible for timed links within the same duration group</span>

<span class="sd">        :param ti: Time index at which to update link outflows</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># First, work out the scale factors as usual</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flush_link</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># At this stage, no outflow goes via the flush link</span>

        <span class="n">total_outflow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">TimedLink</span><span class="p">):</span>
                <span class="n">total_outflow</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">_cache</span>  <span class="c1"># Timed link outflows do not act on the final subcompartment</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">total_outflow</span><span class="p">[:]</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">_cache</span>  <span class="c1"># Normal link outflows do act on the final subcompartment</span>

        <span class="c1"># Rescaling factors for each subcompartment</span>
        <span class="n">rescale</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">divide</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">total_outflow</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">total_outflow</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="n">total_outflow</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">rescale</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span>  <span class="c1"># Rescaled number of people - to multiply by the cache value on each link</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_outflow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># Cache the outflow, because for Links, we accumulate the subcompartment outflow but we need to record the subcompartment outflow separately</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlinks</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">TimedLink</span><span class="p">):</span>
                <span class="n">link</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">link</span><span class="o">.</span><span class="n">_cache</span>
                <span class="n">link</span><span class="o">.</span><span class="n">_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># No flow out of final subcompartment</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_cached_outflow</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">link</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="n">link</span><span class="o">.</span><span class="n">_cache</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_cached_outflow</span> <span class="o">+=</span> <span class="n">n</span> <span class="o">*</span> <span class="n">link</span><span class="o">.</span><span class="n">_cache</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">flush_link</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_outflow</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_cached_outflow</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flush_link</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span></div>


<div class="viewcode-block" id="TimedCompartment.update">
<a class="viewcode-back" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.update">[docs]</a>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update compartment value</span>

<span class="sd">        This compartment update goes from ``ti-1`` to ``ti``. As part of this, the counts for each</span>
<span class="sd">        duration are rolled over.</span>

<span class="sd">        :param ti: Time index to step to</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">tr</span> <span class="o">=</span> <span class="n">ti</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="c1"># First, apply all of the outflows (computed by `resolve_outflows()` at the last timestep)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">tr</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cached_outflow</span>

        <span class="c1"># Then, add in TimedLink inputs (prior to advancing the keyring)</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inlinks</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">TimedLink</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">link</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="c1"># The sizes match exactly, no need to index rows at all</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">tr</span><span class="p">]</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">link</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="c1"># This compartment has a longer duration, so only insert the rows we&#39;ve got</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:</span> <span class="n">link</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ti</span><span class="p">]</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">tr</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># This compartment has a shorter duration, so first insert the values we&#39;ve got</span>
                    <span class="c1"># then sum up and add the extra values to the initial subcompartment</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tr</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">_vals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:,</span> <span class="n">tr</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

        <span class="c1"># Advance the keyring</span>
        <span class="c1"># If this TimedCompartment has only one row, then anyone coming in via TimedLinks will be placed directly</span>
        <span class="c1"># in the final subcompartment (which is also the initial subcompartment). We are assuming that the cached</span>
        <span class="c1"># outflow correctly emptied everyone in the flush compartment so don&#39;t check that the final subcompartment</span>
        <span class="c1"># is empty because people could have been added to it in this timestep</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="n">ti</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># Zero out the inflow (otherwise, it just replicates previous value)</span>

        <span class="c1"># Now, resolve other inputs for which durations are not preserved</span>
        <span class="c1"># Regardless of whether they are TimedLinks or not, they should go into the initial subcompartment</span>
        <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inlinks</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">link</span><span class="p">,</span> <span class="n">TimedLink</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">+=</span> <span class="n">link</span><span class="p">[</span><span class="n">tr</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="TimedCompartment.connect">
<a class="viewcode-back" href="../../_autosummary/atomica.model.TimedCompartment.html#atomica.model.TimedCompartment.connect">[docs]</a>
    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">par</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct link out of this compartment</span>

<span class="sd">        For TimedCompartments, outgoing links are TimedLinks if the downstream compartment belongs to the same</span>
<span class="sd">        duration group. For this purpose, a junction can be part of a duration group if all of the downstream</span>
<span class="sd">        junction outputs are in this compartment&#39;s duration group.</span>

<span class="sd">        :param dest: A ``Compartment`` instance</span>
<span class="sd">        :param par: The parameter that the Link will be associated with</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">TimedCompartment</span><span class="p">)</span> <span class="ow">and</span> <span class="n">dest</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">JunctionCompartment</span><span class="p">)</span> <span class="ow">and</span> <span class="n">dest</span><span class="o">.</span><span class="n">duration_group</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
            <span class="c1"># Note that comparing the name rather than the instance ID will allow duration-preserving transfers where a difference instance of the same parameter is present in the dest population</span>
            <span class="n">new_link</span> <span class="o">=</span> <span class="n">TimedLink</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">,</span> <span class="n">parameter</span><span class="o">=</span><span class="n">par</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="n">dest</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Note that if the duration group doesn&#39;t match, then a Link rather than a TimedLink will be instantiated</span>
            <span class="n">new_link</span> <span class="o">=</span> <span class="n">Link</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">,</span> <span class="n">parameter</span><span class="o">=</span><span class="n">par</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">dest</span><span class="o">=</span><span class="n">dest</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">par</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span><span class="p">:</span>
            <span class="c1"># If we are connecting up the timed parameter, also assign it to the flush link</span>
            <span class="c1"># We also need to break the connection between the parameter and the link</span>
            <span class="c1"># so that the parameter doesn&#39;t try to update the link during `update_pars()`</span>
            <span class="k">assert</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_link</span><span class="p">,</span> <span class="n">TimedLink</span><span class="p">),</span> <span class="s2">&quot;Cannot flush into the same duration group&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flush_link</span> <span class="o">=</span> <span class="n">new_link</span>
            <span class="n">new_link</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">par</span><span class="o">.</span><span class="n">links</span> <span class="o">=</span> <span class="p">[]</span></div>
</div>



<div class="viewcode-block" id="Characteristic">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic">[docs]</a>
<span class="k">class</span> <span class="nc">Characteristic</span><span class="p">(</span><span class="n">Variable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A characteristic represents a grouping of compartments.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="c1"># includes is a list of Compartments, whose values are summed</span>
        <span class="c1"># the denominator is another Characteristic that normalizes this one</span>
        <span class="c1"># All passed by reference so minimal performance impact</span>
        <span class="n">Variable</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="o">=</span><span class="n">pop</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;Number of people&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">includes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># The following flag indicates if another variable depends on this one.</span>
        <span class="c1"># This indicates a value needs computation during integration.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_dynamic</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="Characteristic.preallocate">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.preallocate">[docs]</a>
    <span class="k">def</span> <span class="nf">preallocate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tvec</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Preallocate data storage</span>

<span class="sd">        :param tvec: An array of time values</span>
<span class="sd">        :param dt: Time step size</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">tvec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_dynamic</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">tvec</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">get_included_comps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">includes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">inc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">includes</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inc</span><span class="p">,</span> <span class="n">Characteristic</span><span class="p">):</span>
                <span class="n">includes</span> <span class="o">+=</span> <span class="n">inc</span><span class="o">.</span><span class="n">get_included_comps</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">includes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">inc</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">includes</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vals</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">includes</span><span class="p">:</span>
                <span class="n">vals</span> <span class="o">+=</span> <span class="n">comp</span><span class="o">.</span><span class="n">vals</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">denom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="o">.</span><span class="n">vals</span>
                <span class="n">vals_zero</span> <span class="o">=</span> <span class="n">vals</span> <span class="o">&lt;</span> <span class="n">model_settings</span><span class="p">[</span><span class="s2">&quot;tolerance&quot;</span><span class="p">]</span>
                <span class="n">vals</span><span class="p">[</span><span class="n">denom</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="n">denom</span><span class="p">[</span><span class="n">denom</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
                <span class="n">vals</span><span class="p">[</span><span class="n">vals_zero</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="n">vals</span><span class="p">[(</span><span class="n">denom</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">vals_zero</span><span class="p">)]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

            <span class="k">return</span> <span class="n">vals</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span>

<div class="viewcode-block" id="Characteristic.set_dynamic">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.set_dynamic">[docs]</a>
    <span class="k">def</span> <span class="nf">set_dynamic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_dynamic</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">inc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">includes</span><span class="p">:</span>
            <span class="n">inc</span><span class="o">.</span><span class="n">set_dynamic</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="o">.</span><span class="n">set_dynamic</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Variable</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">includes</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">includes</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="o">.</span><span class="n">id</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">relink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">):</span>
        <span class="c1"># Given a dictionary of objects, restore the internal references</span>
        <span class="n">Variable</span><span class="o">.</span><span class="n">relink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">includes</span> <span class="o">=</span> <span class="p">[</span><span class="n">objs</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">includes</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">]</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">add_include</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Compartment</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Characteristic</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">includes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">add_denom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Compartment</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Characteristic</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

<div class="viewcode-block" id="Characteristic.update">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Characteristic.html#atomica.model.Characteristic.update">[docs]</a>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">includes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">+=</span> <span class="n">comp</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">denom</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">denominator</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">denom</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">/=</span> <span class="n">denom</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">model_settings</span><span class="p">[</span><span class="s2">&quot;tolerance&quot;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Given a zero/zero case, make the answer zero.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>  <span class="c1"># Given a non-zero/zero case, keep the answer infinite.</span></div>
</div>



<div class="viewcode-block" id="Parameter">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter">[docs]</a>
<span class="k">class</span> <span class="nc">Parameter</span><span class="p">(</span><span class="n">Variable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Integration object to represent Parameters</span>

<span class="sd">    A parameter is a Variable that can have a value computed via an fcn_str and a list of</span>
<span class="sd">    dependent Variables. This is a Parameter in the cascade.xlsx sense - there is one Parameter object for every item in the</span>
<span class="sd">    Parameters sheet. A parameter that maps to multiple transitions (e.g. ``doth_rate``) will have one parameter</span>
<span class="sd">    and multiple Link instances that depend on the same Parameter instance</span>

<span class="sd">    :param pop: A :class:`Population` instance corresponding to the population that will contain this parameter</span>
<span class="sd">    :param name: The code name for this parameter</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>

        <span class="n">Variable</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="o">=</span><span class="n">pop</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limits</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: Can be a two element vector [min,max]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pop_aggregation</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: If not None, stores list of population aggregation information (special function, which weighting comp/charac and which interaction term to use)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#: This should be set to the product of the population-specific ``y_factor`` and the ``meta_y_factor`` from the ParameterSet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">links</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1">#: References to links that derive from this parameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_source_popsize_cache_time</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># : Internal cache for the time at which the source popsize was previously computed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_source_popsize_cache_val</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># : Internal cache for the last previously computed source popsize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcn_str</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: String representation of parameter function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deps</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1">#: Dict of dependencies containing lists of integration objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fcn</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: Internal cache for parsed parameter function (this will be dropped when pickled)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_precompute</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1">#: If True, the parameter function will be computed in a vector operation prior to integration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_dynamic</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1">#: If True, this parameter has values that need to be updated or assigned during integration. Note that `precompute` and `dynamic` are mutually exclusive</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1">#: If True, the parameter function will be treated as a derivative and the value added on to the end</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dx</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: Internal cache for the value of the derivative at the current timestep</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_function</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: Can optionally be set to a (start,stop) tuple of times. Between these times, the parameter will not be updated so the parset value will be left unchanged</span>

        <span class="c1">#: For transition parameters, the ``vals`` stored by the parameter is effectively a rate. The ``timescale``</span>
        <span class="c1">#: attribute informs the time period corresponding to the units in which the rate has been provided.</span>
        <span class="c1">#: If the units are ``number`` or ``probability`` then the ``timescale`` corresponds to the denominator of the units</span>
        <span class="c1">#: e.g. probability/day (with ``timescale=1/365``).</span>
        <span class="c1">#: If the units are ``duration`` then the timescale stores the units in which the duration has been specified</span>
        <span class="c1">#: e.g. ``duration=1`` with ``timescale=1/52`` is the same as ``duration=7`` with ``timescale=1/365``</span>
        <span class="c1">#: The effective duration used in the simulation is ``duration*timescale`` with units of years (so it will behave correctly if</span>
        <span class="c1">#: one wanted to use 1/365.25 instead of 1/365)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timescale</span> <span class="o">=</span> <span class="mf">1.0</span>

<div class="viewcode-block" id="Parameter.set_fcn">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.set_fcn">[docs]</a>
    <span class="k">def</span> <span class="nf">set_fcn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fcn_str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a function to this parameter</span>

<span class="sd">        This method adds a function to the parameter. The following steps are carried out</span>

<span class="sd">            - The function is parsed and stored in the ``._fcn`` attribute (until the Parameter is pickled)</span>
<span class="sd">            - The dependencies are extracted, and are stored as references to the actual integration objects</span>
<span class="sd">              to increase performance during integration</span>
<span class="sd">            - If this is a transition parameter, then dependencies will have their `dynamic` flag updated</span>

<span class="sd">        :param framework: A py:class:`ProjectFramework` instance, used to identify and retrieve interaction terms</span>
<span class="sd">        :param fcn_str: The string containing the function to add</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="n">sc</span><span class="o">.</span><span class="n">isstring</span><span class="p">(</span><span class="n">fcn_str</span><span class="p">),</span> <span class="s2">&quot;Parameter function must be supplied as a string&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fcn_str</span> <span class="o">=</span> <span class="n">fcn_str</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fcn</span><span class="p">,</span> <span class="n">dep_list</span> <span class="o">=</span> <span class="n">parse_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcn_str</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fcn_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;SRC_POP_AVG&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fcn_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;TGT_POP_AVG&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fcn_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;SRC_POP_SUM&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">fcn_str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;TGT_POP_SUM&quot;</span><span class="p">):</span>
            <span class="c1"># The function is like &#39;SRC_POP_AVG(par_name,interaction_name,charac_name)&#39;</span>
            <span class="c1"># self.pop_aggregation will be [&#39;SRC_POP_AVG&#39;,par_name,interaction_name,charac_object]</span>
            <span class="n">special_function</span><span class="p">,</span> <span class="n">temp_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fcn_str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">)</span>
            <span class="n">function_args</span> <span class="o">=</span> <span class="n">temp_list</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;)&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
            <span class="n">function_args</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">function_args</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pop_aggregation</span> <span class="o">=</span> <span class="p">[</span><span class="n">special_function</span><span class="p">]</span> <span class="o">+</span> <span class="n">function_args</span>
            <span class="c1"># Aggregation dependencies are set externally because they may cross populations - see `Model.build()`</span>
            <span class="c1"># Note that aggregations are computed externally rather than via `Parameter.update`</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dep_name</span> <span class="ow">in</span> <span class="n">dep_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">dep_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;dt&quot;</span><span class="p">]):</span>  <span class="c1"># There are no integration variables associated with the interactions, as they are treated as a special matrix</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">deps</span><span class="p">[</span><span class="n">dep_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="n">dep_name</span><span class="p">)</span>  <span class="c1"># nb. this lookup will fail if the user has a function that depends on a quantity outside this population</span></div>


<div class="viewcode-block" id="Parameter.set_dynamic">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.set_dynamic">[docs]</a>
    <span class="k">def</span> <span class="nf">set_dynamic</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">progset</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mark this parameter as needing evaluation for integration</span>

<span class="sd">        If a parameter has a function and `set_dynamic()` has been called, that means the</span>
<span class="sd">        result of the function is required to drive a transition in the model. In this context,</span>
<span class="sd">        &#39;dynamic&#39; means that the parameter depends on values that are only known during integration</span>
<span class="sd">        (i.e. compartment sizes). It could also depend on compartment sizes indirectly, if</span>
<span class="sd">        it depends on characteristics, or if it depends on parameters that depend on compartments</span>
<span class="sd">        or characteristics. If none of these are true, then the parameter function can be evaluated</span>
<span class="sd">        before integration starts, taking advantage of vector operations.</span>

<span class="sd">        If a parameter is overwritten by a program in this simulation, then its value may change</span>
<span class="sd">        during integration, and we again need to make this parameter dynamic. Note that this doesn&#39;t</span>
<span class="sd">        apply to the parameter *being* overwritten - if it gets overwritten, that has no bearing on</span>
<span class="sd">        when its function gets evaluated. But if a parameter depends on a value that has changed, then</span>
<span class="sd">        the function must be re-evaluated. Technically this only needs to be done after the time index</span>
<span class="sd">        where programs turn on, but it&#39;s simpler just to mark it as dynamic for the entire simulation,</span>
<span class="sd">        the gains aren&#39;t large enough to justify the extra complexity otherwise.</span>

<span class="sd">        :param progset: A ``ProgramSet`` instance (the one contained in the Model containing this Parameter)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fcn_str</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_dynamic</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_precompute</span><span class="p">:</span>
            <span class="c1"># Only parameters with functions need to be made dynamic</span>
            <span class="c1"># If the parameter is marked dynamic or precompute, that means this parameter and any of its</span>
            <span class="c1"># dependencies have already been checked</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_aggregation</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span><span class="p">:</span>
            <span class="c1"># Pop aggregations and derivatives are handled in `update_pars()` so we set the dynamic flag</span>
            <span class="c1"># because the values are modified during integration</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_is_dynamic</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deps</span><span class="p">:</span>  <span class="c1"># If there are no dependencies, then we know that this is precompute-only</span>
            <span class="k">for</span> <span class="n">deps</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">deps</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>  <span class="c1"># deps is {&#39;dep_name&#39;:[dep_objects]}</span>
                <span class="k">for</span> <span class="n">dep</span> <span class="ow">in</span> <span class="n">deps</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dep</span><span class="p">,</span> <span class="n">Link</span><span class="p">):</span>
                        <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameter &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; depends on transition flow &#39;</span><span class="si">{</span><span class="n">dep</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; thus it cannot be a dependency, it must be output only.&quot;</span><span class="p">)</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dep</span><span class="p">,</span> <span class="n">Compartment</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dep</span><span class="p">,</span> <span class="n">Characteristic</span><span class="p">):</span>
                        <span class="n">dep</span><span class="o">.</span><span class="n">set_dynamic</span><span class="p">(</span><span class="n">progset</span><span class="o">=</span><span class="n">progset</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_is_dynamic</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dep</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">):</span>
                        <span class="n">dep</span><span class="o">.</span><span class="n">set_dynamic</span><span class="p">(</span><span class="n">progset</span><span class="o">=</span><span class="n">progset</span><span class="p">)</span>  <span class="c1"># Run `set_dynamic()` on the parameter which will descend further to see if the Parameter depends on comps/characs or on overwritten parameters</span>
                        <span class="k">if</span> <span class="n">dep</span><span class="o">.</span><span class="n">_is_dynamic</span> <span class="ow">or</span> <span class="p">(</span><span class="n">progset</span> <span class="ow">and</span> <span class="n">dep</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">progset</span><span class="o">.</span><span class="n">pars</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">_is_dynamic</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="s2">&quot;Unexpected dependency type&quot;</span><span class="p">)</span>

        <span class="c1"># If not dynamic, then we need to precompute the function because the value is required for a transition</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_dynamic</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_precompute</span> <span class="o">=</span> <span class="kc">True</span></div>


    <span class="k">def</span> <span class="nf">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Variable</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">links</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dep_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">deps</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deps</span><span class="p">[</span><span class="n">dep_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">deps</span><span class="p">[</span><span class="n">dep_name</span><span class="p">]]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fcn</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fcn</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">relink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">):</span>
        <span class="c1"># Given a dictionary of objects, restore the internal references</span>
        <span class="n">Variable</span><span class="o">.</span><span class="n">relink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">links</span> <span class="o">=</span> <span class="p">[</span><span class="n">objs</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deps</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">dep_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">deps</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">deps</span><span class="p">[</span><span class="n">dep_name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">objs</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">deps</span><span class="p">[</span><span class="n">dep_name</span><span class="p">]]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fcn_str</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fcn</span> <span class="o">=</span> <span class="n">parse_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fcn_str</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

<div class="viewcode-block" id="Parameter.constrain">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.constrain">[docs]</a>
    <span class="k">def</span> <span class="nf">constrain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constrain the parameter value to allowed range</span>

<span class="sd">        If ``Parameter.limits`` is not None, then the parameter values at the specified</span>
<span class="sd">        time will be clipped to the limits. If no time index is provided, clipping will</span>
<span class="sd">        be performed on all values in a vectorized operation. Vector clipping is used</span>
<span class="sd">        for data parameters that are not evaluated during integration, while index-specific</span>
<span class="sd">        clipping is used for dependencies that are calculated during integration.</span>

<span class="sd">        :param ti: An integer index, or None (to operate on all time points)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ti</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>


<div class="viewcode-block" id="Parameter.update">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Parameter.html#atomica.model.Parameter.update">[docs]</a>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the value of this Parameter</span>

<span class="sd">        If the parameter contains a function, this entails evaluating the function.</span>
<span class="sd">        Typically this is done at a single time point during integration, or over all</span>
<span class="sd">        time points for precomputing and postcomputing</span>

<span class="sd">        :param ti: An ``int``, or a numpy array with index values. If ``None``, all time values will be used</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fcn</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">ti</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="s2">&quot;Cannot perform a vector update of a derivative parameter (these parameters intrinsically require integration to be computed)&quot;</span><span class="p">)</span>
            <span class="n">ti</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>  <span class="c1"># This corresponds to every time point</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_function</span><span class="p">:</span>
            <span class="c1"># If we don&#39;t want to overwrite the parameter in certain years, those years need to be excluded</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ti</span><span class="p">,</span> <span class="s2">&quot;__len__&quot;</span><span class="p">):</span>
                <span class="c1"># Filter out years outside the excluded range</span>
                <span class="n">ti</span> <span class="o">=</span> <span class="n">ti</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_function</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">|</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_function</span><span class="p">[</span><span class="mi">1</span><span class="p">]))]</span>
                <span class="k">if</span> <span class="n">ti</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># If all times were removed</span>
                    <span class="k">return</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Dealing with a scalar ti</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_function</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_function</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="k">return</span>

        <span class="n">dep_vals</span> <span class="o">=</span> <span class="nb">dict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">deps</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">dep_name</span><span class="p">,</span> <span class="n">deps</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">deps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">dep</span> <span class="ow">in</span> <span class="n">deps</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dep</span><span class="p">,</span> <span class="n">Parameter</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dep</span><span class="p">,</span> <span class="n">Characteristic</span><span class="p">):</span>
                    <span class="n">dep_vals</span><span class="p">[</span><span class="n">dep_name</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dep</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dep</span><span class="p">,</span> <span class="n">Compartment</span><span class="p">):</span>
                    <span class="n">dep_vals</span><span class="p">[</span><span class="n">dep_name</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dep</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dep</span><span class="p">,</span> <span class="n">Link</span><span class="p">):</span>
                    <span class="n">dep_vals</span><span class="p">[</span><span class="n">dep_name</span><span class="p">]</span> <span class="o">+=</span> <span class="n">dep</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">/</span> <span class="n">dep</span><span class="o">.</span><span class="n">dt</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="s2">&quot;Unhandled case&quot;</span><span class="p">)</span>

        <span class="n">dep_vals</span><span class="p">[</span><span class="s2">&quot;t&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>
        <span class="n">dep_vals</span><span class="p">[</span><span class="s2">&quot;dt&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fcn</span><span class="p">(</span><span class="o">**</span><span class="n">dep_vals</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error when calculating the value for parameter: </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">derivative</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dx</span> <span class="o">=</span> <span class="n">v</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span></div>


    <span class="k">def</span> <span class="nf">source_popsize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">):</span>
        <span class="c1"># Get the total number of people covered by this program</span>
        <span class="c1"># i.e. the sum of the source compartments of all links that</span>
        <span class="c1"># derive from this program. If the parameter has no links, return NaN</span>
        <span class="c1"># which disambiguates between a parameter whose source compartments are all</span>
        <span class="c1"># empty, vs a parameter that has no source compartments</span>
        <span class="k">if</span> <span class="n">ti</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source_popsize_cache_time</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_source_popsize_cache_val</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
                    <span class="n">n</span> <span class="o">+=</span> <span class="n">link</span><span class="o">.</span><span class="n">source</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>  <span class="c1"># Use the direct indexing because we don&#39;t know what type of compartment we are operating on</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="s2">&quot;Cannot retrieve source popsize for a non-transition parameter&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_source_popsize_cache_time</span> <span class="o">=</span> <span class="n">ti</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_source_popsize_cache_val</span> <span class="o">=</span> <span class="n">n</span>
            <span class="k">return</span> <span class="n">n</span></div>



<div class="viewcode-block" id="Link">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link">[docs]</a>
<span class="k">class</span> <span class="nc">Link</span><span class="p">(</span><span class="n">Variable</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Link is a Variable that maps to a transition between compartments. As</span>
<span class="sd">    such, it contains an inflow and outflow compartment.  A Link&#39;s value is</span>
<span class="sd">    generally derived from a Parameter, and there may be multiple links that draw values</span>
<span class="sd">    from the same parameter. The value corresponds to the number transferred</span>
<span class="sd">    from the source compartment to the destination compartment in the subsequent timestep.</span>

<span class="sd">    Some links do not have an associated Parameter object because their values are calculated</span>
<span class="sd">    by means other than parameters. For example</span>

<span class="sd">    - Flush links have their values calculated from the source timed compartment</span>
<span class="sd">    - Junction residual links have their values calculated by junction balancing</span>

<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Link.create">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.create">[docs]</a>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">dest</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create and wire up a new link</span>

<span class="sd">        This method instantiates a Link (including of derived types) and also wires it up to</span>
<span class="sd">        the population, parameter, source, and destination compartments. This allows the ``Link``</span>
<span class="sd">        constructor to be used without needing the entire population infrastructure</span>

<span class="sd">        :param pop: A ``Population`` instance that will contain the new ``Link``</span>
<span class="sd">        :param parameter: A ``Parameter`` instance that will supply values for the new ``Link``</span>
<span class="sd">        :param source: A ``Compartment`` instance to transfer from</span>
<span class="sd">        :param dest: A ``Compartment`` instance to transfer to</span>
<span class="sd">        :return: The newly created ``Link`` instance</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Instantiate the link</span>
        <span class="n">new_link</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">pop</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>

        <span class="c1"># Wire it up</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_link</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_link</span><span class="p">)</span>
        <span class="n">new_link</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">outlinks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_link</span><span class="p">)</span>
        <span class="n">new_link</span><span class="o">.</span><span class="n">dest</span><span class="o">.</span><span class="n">inlinks</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_link</span><span class="p">)</span>
        <span class="n">pop</span><span class="o">.</span><span class="n">links</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_link</span><span class="p">)</span>

        <span class="c1"># Add the link to the population&#39;s lookup</span>
        <span class="k">if</span> <span class="n">new_link</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">pop</span><span class="o">.</span><span class="n">link_lookup</span><span class="p">:</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">link_lookup</span><span class="p">[</span><span class="n">new_link</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_link</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">link_lookup</span><span class="p">[</span><span class="n">new_link</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_link</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">new_link</span></div>


    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">dest</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">parameter</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># If the parameter is None then assign a random name</span>
            <span class="n">link_name</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">uuid</span><span class="p">(</span><span class="n">tostring</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Otherwise, name the link after the parameter governing it</span>
            <span class="n">link_name</span> <span class="o">=</span> <span class="n">parameter</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;:flow&quot;</span>

        <span class="n">Variable</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="o">=</span><span class="n">pop</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="p">(</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">source</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">dest</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">link_name</span><span class="p">))</span>  <span class="c1"># A Link is only uniquely identified by (Pop,Source,Dest,Par)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="s2">&quot;Number of people&quot;</span>

        <span class="c1"># Source parameter where unscaled link value is drawn from (a single parameter may have multiple links).</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">parameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">source</span>  <span class="c1"># Compartment to remove people from</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dest</span> <span class="o">=</span> <span class="n">dest</span>  <span class="c1"># Compartment to add people to</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: Temporarily cache either the fraction converted (normal links) or number of people (source outflows)</span>

    <span class="k">def</span> <span class="fm">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shortcut to set .vals attribute</span>

<span class="sd">        This method assigns values to the `.vals` attribute e.g., ``sus[ti] = 0`` instead of</span>
<span class="sd">        ``sus.vals[ti] = 0``. Importantly, this allows the derived class to overload ``__getitem__``</span>
<span class="sd">        if ``vals`` is a property method instead of an actual array.</span>

<span class="sd">        :param key: Indexer passed directly to the numpy array ``self.vals[item]``</span>
<span class="sd">        :param value: Value to assign to the result of the indexing operation</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Variable</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Flush links have their values computed from a compartment rather than a parameter</span>
            <span class="c1"># So it is possible to have a transition/Link without an associated parameter</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dest</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest</span><span class="o">.</span><span class="n">id</span>

    <span class="k">def</span> <span class="nf">relink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">):</span>
        <span class="c1"># Given a dictionary of objects, restore the internal references</span>
        <span class="n">Variable</span><span class="o">.</span><span class="n">relink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">parameter</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dest</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">dest</span><span class="p">]</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> (parameter </span><span class="si">%s</span><span class="s2">) - </span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">TimedCompartment</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">flush_link</span> <span class="ow">is</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> - </span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2"> (flush)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> - </span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<div class="viewcode-block" id="Link.plot">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.plot">[docs]</a>
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Variable</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Link </span><span class="si">%s</span><span class="s2"> to </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest</span><span class="o">.</span><span class="n">name</span><span class="p">))</span></div>


<div class="viewcode-block" id="Link.update">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Link.html#atomica.model.Link.update">[docs]</a>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">converted_frac</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the value of the link</span>

<span class="sd">        This method takes in the fraction of the source compartment to move, and</span>
<span class="sd">        updates the value of the link accordingly. In `update_links`, parameters are</span>
<span class="sd">        first all converted into timestep-based fractions. These fractions are then</span>
<span class="sd">        used to update the links. However, depending on whether the link stores</span>
<span class="sd">        compartment duration information, this update may or may not require the use</span>
<span class="sd">        of TimedCompartment properties. Therefore, updating the link is delegated</span>
<span class="sd">        to this Link method that can be overloaded in derived classes.</span>

<span class="sd">        :param ti: The time index to update</span>
<span class="sd">        :param converted_frac: The fraction of the source compartment to move (the parent parameter value, converted to timestep fraction)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">*</span> <span class="n">converted_frac</span></div>
</div>



<div class="viewcode-block" id="TimedLink">
<a class="viewcode-back" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink">[docs]</a>
<span class="k">class</span> <span class="nc">TimedLink</span><span class="p">(</span><span class="n">Link</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A TimedLink connects two TimedCompartments</span>

<span class="sd">    A TimedLink should be used between two TimedCompartments if it is important to preserve the &#39;time until forced removal&#39;</span>
<span class="sd">    when making the transition. For example, a vaccinated individual with 3 years of protection remaining may need to move</span>
<span class="sd">    to a vaccinated+latent state, for instance. In that case, they would still have 3 years remaining in vaccinated+latent.</span>

<span class="sd">    The value for the TimedLink corresponds to the number of people in each time bin from the *source* compartment.</span>
<span class="sd">    If there is a mismatch in durations across the TimedLink endpoints, it is up to the destination compartment to</span>
<span class="sd">    resolve them.</span>

<span class="sd">    A TimedLink should _not_ be used for the timed outflow of a TimedCompartment as people flowing out of a timed outflow</span>
<span class="sd">    all originate at the same time.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">dest</span><span class="p">):</span>
        <span class="n">Link</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop</span><span class="p">,</span> <span class="n">parameter</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: Primary storage, a matrix with size matching the source compartment</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vals</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Link total flow</span>

<span class="sd">        This returns link outflow obtained by summing over the people in each time bin at each point in time</span>

<span class="sd">        :return: A numpy array with the link flow rate</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<div class="viewcode-block" id="TimedLink.preallocate">
<a class="viewcode-back" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.preallocate">[docs]</a>
    <span class="k">def</span> <span class="nf">preallocate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tvec</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">dt</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Preallocate data storage</span>

<span class="sd">        Note that TimedLinks preallocate their internal storage based on the preallocated size</span>
<span class="sd">        of the source TimedCompartment. Therefore, it must be preallocated after the compartments</span>
<span class="sd">        have been preallocated.</span>

<span class="sd">        :param tvec: An array of time values</span>
<span class="sd">        :param dt: Time step size</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Preallocate to the same size as the source compartment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">tvec</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">TimedCompartment</span><span class="p">):</span>
            <span class="c1"># Preallocate based on the timed compartment size</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>  <span class="c1"># Fortran/column-major order should be faster for summing over lags to get `vals`</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Preallocate based on the upstream junction&#39;s duration group</span>
            <span class="c1"># Note that the keyring size calculation is duplicated from TimedCompartment, this could be separated into a function if it is needed any more often than this</span>
            <span class="n">parameter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">par_lookup</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">duration_group</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">parameter</span><span class="o">.</span><span class="n">vals</span> <span class="o">==</span> <span class="n">parameter</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s2">&quot;Duration parameter value cannot vary over time&quot;</span>
            <span class="n">duration</span> <span class="o">=</span> <span class="n">parameter</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">parameter</span><span class="o">.</span><span class="n">timescale</span> <span class="o">*</span> <span class="n">parameter</span><span class="o">.</span><span class="n">scale_factor</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">duration</span> <span class="o">/</span> <span class="n">dt</span><span class="p">),</span> <span class="n">tvec</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">order</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>  <span class="c1"># Fortran/column-major order should be faster for summing over lags to get `vals`</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span></div>


<div class="viewcode-block" id="TimedLink.update">
<a class="viewcode-back" href="../../_autosummary/atomica.model.TimedLink.html#atomica.model.TimedLink.update">[docs]</a>
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">converted_frac</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updated link flow rate</span>

<span class="sd">        For TimedLink instances, we update at all of the time indices</span>

<span class="sd">        :param ti: Time index to update</span>
<span class="sd">        :param converted_frac: The fraction of the source compartment to move (the parent parameter value, converted to timestep fraction)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span> <span class="o">*</span> <span class="n">converted_frac</span></div>


    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve total flow at given time index</span>

<span class="sd">        By only adding the requested timesteps, this approach is faster than accessing ``vals`` first i.e.</span>

<span class="sd">        &gt;&gt;&gt; self.vals[ti]</span>
<span class="sd">        &gt;&gt;&gt; self[ti] # &lt;-- Faster</span>

<span class="sd">        :param ti: Time index/indices</span>
<span class="sd">        :return: Total compartment size at given time index/indices</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vals</span><span class="p">[:,</span> <span class="n">ti</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></div>



<div class="viewcode-block" id="Population">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population">[docs]</a>
<span class="k">class</span> <span class="nc">Population</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to wrap up data for one population within model.</span>
<span class="sd">    Each model population must contain a set of compartments with equivalent names.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">framework</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">progset</span><span class="p">:</span> <span class="n">ProgramSet</span><span class="p">,</span> <span class="n">pop_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Construct a Population</span>

<span class="sd">        This function constructs a population instance. Aside from creating the Population, it also</span>
<span class="sd">        instantiates all of the integration objects defined in the Framework. Note that transfers</span>
<span class="sd">        and interactions aren&#39;t added at this point - because they transcend populations, they are</span>
<span class="sd">        instantiated one level higher up, in ``model.build()``</span>

<span class="sd">        :param framework: A ProjectFramework</span>
<span class="sd">        :param name: The code name of the population</span>
<span class="sd">        :param label: The full name of the population</span>
<span class="sd">        :param progset: A ProgramSet instance</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>  <span class="c1">#: The code name of the population</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>  <span class="c1">#: The full name/label of the population</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">pop_type</span>  <span class="c1">#: The population&#39;s type</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">comps</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1">#: List of Compartment objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">characs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1">#: List of Characteristic objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">links</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1">#: List of Link objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pars</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1">#: List of Parameter objects</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">comp_lookup</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1">#: Maps name of a compartment to a Compartment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charac_lookup</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1">#: Maps name of a compartment to a Characteristic</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">par_lookup</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1">#: Maps name of a parameter to a Parameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link_lookup</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>  <span class="c1">#: Maps name of link to a list of Links with that name</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">framework</span><span class="o">=</span><span class="n">framework</span><span class="p">,</span> <span class="n">progset</span><span class="o">=</span><span class="n">progset</span><span class="p">)</span>  <span class="c1"># Convert compartmental cascade into lists of compartment and link objects.</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">popsize_cache_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popsize_cache_val</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">is_linked</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Flag to manage double unlinking/relinking</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> &quot;</span><span class="si">%s</span><span class="s1">&quot;&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check whether variables can be resolved</span>

<span class="sd">        This function returns True if ``Population.get_variable(item)`` would result</span>
<span class="sd">        in some variables being returned. This facilitates checking whether a population</span>
<span class="sd">        contains particular variables - for example, transfer links may only exist in</span>
<span class="sd">        a subset of the model populations, or if population types are being used, not all</span>
<span class="sd">        variables will be defined in any one population.</span>

<span class="sd">        :param item: The name of a parameter or a link specification (supported by ``get_variable``)</span>
<span class="sd">        :return: True if ``Population.get_variable`` would return at least one variable, otherwise False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">except</span> <span class="n">NotFoundError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_linked</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">comps</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">characs</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comp_lookup</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charac_lookup</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">par_lookup</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link_lookup</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_linked</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">relink</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_linked</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">comps</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">characs</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
            <span class="n">obj</span><span class="o">.</span><span class="n">relink</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comp_lookup</span> <span class="o">=</span> <span class="p">{</span><span class="n">comp</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">comp</span> <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">comps</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charac_lookup</span> <span class="o">=</span> <span class="p">{</span><span class="n">charac</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">charac</span> <span class="k">for</span> <span class="n">charac</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">characs</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">par_lookup</span> <span class="o">=</span> <span class="p">{</span><span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">par</span> <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">}</span>
        <span class="n">link_names</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span><span class="n">link</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">links</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">link_lookup</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="p">[</span><span class="n">link</span> <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">links</span> <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">name</span><span class="p">]</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">link_names</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">is_linked</span> <span class="o">=</span> <span class="kc">True</span>

<div class="viewcode-block" id="Population.popsize">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.popsize">[docs]</a>
    <span class="k">def</span> <span class="nf">popsize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ti</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return population size</span>

<span class="sd">        A population&#39;s size is the sum of all of the people in its compartments, excluding</span>
<span class="sd">        birth and death compartments</span>

<span class="sd">        :param ti: Optionally specify a scalar time index to retrieve popsize for. ```None`` corresponds to all times</span>
<span class="sd">        :return: If ``ti`` is specified, returns a scalar population size. If ``ti`` is ``None``, return a numpy array the same size as the simulation time vector</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">ti</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">comp</span><span class="o">.</span><span class="n">vals</span> <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">comps</span> <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="n">SourceCompartment</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="n">SinkCompartment</span><span class="p">))],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ti</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">popsize_cache_time</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">popsize_cache_val</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">comps</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="n">SourceCompartment</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="n">SinkCompartment</span><span class="p">):</span>
                    <span class="n">n</span> <span class="o">+=</span> <span class="n">comp</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">n</span></div>


<div class="viewcode-block" id="Population.get_variable">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.get_variable">[docs]</a>
    <span class="k">def</span> <span class="nf">get_variable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return list of variables given code name</span>

<span class="sd">        At the moment, names are unique across object types and within object</span>
<span class="sd">        types except for links, but if that logic changes, simple modifications can</span>
<span class="sd">        be made here</span>

<span class="sd">        Link names in Atomica end in &#39;par_name:flow&#39; so passing in a code name of this form</span>
<span class="sd">        will return links. Links can also be identified by the compartments that they connect.</span>
<span class="sd">        Allowed syntax is:</span>
<span class="sd">        - &#39;source_name:&#39; - All links going out from source</span>
<span class="sd">        - &#39;:dest_name&#39; - All links going into destination</span>
<span class="sd">        - &#39;source_name:dest_name&#39; - All links from Source to Dest</span>
<span class="sd">        - &#39;source_name:dest_name:par_name&#39; - All links from Source to Dest belonging to a given Parameter</span>
<span class="sd">        - &#39;:dest:par_name&#39;</span>
<span class="sd">        - &#39;source::par_name&#39; - As per above</span>
<span class="sd">        - &#39;::par_name&#39; - All links with specified par_name (less efficient than &#39;par_name:flow&#39;)</span>

<span class="sd">        :param name: Code name to search for</span>
<span class="sd">        :return: A list of Variables</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;___&quot;</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">)</span>  <span class="c1"># Parameter functions will convert &#39;:&#39; to &#39;___&#39; for use in variable names</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">comp_lookup</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">comp_lookup</span><span class="p">[</span><span class="n">name</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">charac_lookup</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">charac_lookup</span><span class="p">[</span><span class="n">name</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">par_lookup</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">par_lookup</span><span class="p">[</span><span class="n">name</span><span class="p">]]</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">link_lookup</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">link_lookup</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s2">&quot;:&quot;</span> <span class="ow">in</span> <span class="n">name</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;:flow&quot;</span><span class="p">):</span>
            <span class="n">name_tokens</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">name_tokens</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">name_tokens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">src</span><span class="p">,</span> <span class="n">dest</span><span class="p">,</span> <span class="n">par</span> <span class="o">=</span> <span class="n">name_tokens</span>

            <span class="k">if</span> <span class="n">src</span> <span class="ow">and</span> <span class="n">dest</span><span class="p">:</span>
                <span class="n">links</span> <span class="o">=</span> <span class="p">[</span><span class="n">link</span> <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_comp</span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="o">.</span><span class="n">outlinks</span> <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">dest</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">dest</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">src</span><span class="p">:</span>
                <span class="n">links</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_comp</span><span class="p">(</span><span class="n">src</span><span class="p">)</span><span class="o">.</span><span class="n">outlinks</span>
            <span class="k">elif</span> <span class="n">dest</span><span class="p">:</span>
                <span class="n">links</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_comp</span><span class="p">(</span><span class="n">dest</span><span class="p">)</span><span class="o">.</span><span class="n">inlinks</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">links</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">links</span>

            <span class="k">if</span> <span class="n">par</span><span class="p">:</span>
                <span class="n">links</span> <span class="o">=</span> <span class="p">[</span><span class="n">link</span> <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">links</span> <span class="k">if</span> <span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">parameter</span> <span class="ow">and</span> <span class="n">link</span><span class="o">.</span><span class="n">parameter</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">par</span><span class="p">)]</span>

            <span class="k">return</span> <span class="n">links</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Object &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; not found in population &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Population.get_comp">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.get_comp">[docs]</a>
    <span class="k">def</span> <span class="nf">get_comp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comp_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Allow compartments to be retrieved by name rather than index. Returns a Compartment.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">comp_lookup</span><span class="p">[</span><span class="n">comp_name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Compartment </span><span class="si">{</span><span class="n">comp_name</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Population.get_links">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.get_links">[docs]</a>
    <span class="k">def</span> <span class="nf">get_links</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve Links.&quot;&quot;&quot;</span>
        <span class="c1"># Links can be looked up by parameter name or by link name, unlike get_variable. This is because</span>
        <span class="c1"># get_links() is guaranteed to return a list of Link objects</span>
        <span class="c1"># As opposed to get_variable which would retrieve the Parameter for &#39;doth rate&#39; and the Links for &#39;z&#39;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">par_lookup</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">par_lookup</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">links</span>
        <span class="k">elif</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">link_lookup</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">link_lookup</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFoundError</span><span class="p">(</span><span class="s2">&quot;Object &#39;</span><span class="si">{0}</span><span class="s2">&#39; not found.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span></div>


<div class="viewcode-block" id="Population.get_charac">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.get_charac">[docs]</a>
    <span class="k">def</span> <span class="nf">get_charac</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">charac_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Allow dependencies to be retrieved by name rather than index. Returns a Variable.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">charac_lookup</span><span class="p">[</span><span class="n">charac_name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Characteristic </span><span class="si">{</span><span class="n">charac_name</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Population.get_par">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.get_par">[docs]</a>
    <span class="k">def</span> <span class="nf">get_par</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">par_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Allow dependencies to be retrieved by name rather than index. Returns a Variable.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">par_lookup</span><span class="p">[</span><span class="n">par_name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parameter </span><span class="si">{</span><span class="n">par_name</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Population.build">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.build">[docs]</a>
    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">framework</span><span class="p">,</span> <span class="n">progset</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a compartmental cascade as defined in a settings object.</span>
<span class="sd">        Fill out the compartment, transition and dependency lists within the model population object.</span>
<span class="sd">        Maintaining order as defined in a cascade workbook is crucial due to cross-referencing.</span>

<span class="sd">        The progset is required so that Parameter instances with functions can correctly identify dynamic quantities</span>
<span class="sd">        if they are only dynamic due to program overwrites.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">comps</span> <span class="o">=</span> <span class="n">framework</span><span class="o">.</span><span class="n">comps</span>
        <span class="n">characs</span> <span class="o">=</span> <span class="n">framework</span><span class="o">.</span><span class="n">characs</span>
        <span class="n">pars</span> <span class="o">=</span> <span class="n">framework</span><span class="o">.</span><span class="n">pars</span>

        <span class="c1"># Parameters first pass</span>
        <span class="c1"># Instantiate all parameters first. That way, we know which compartments need to be TimedCompartments</span>
        <span class="c1"># We make a `timed_compartments` dict mapping {timed_compartment_name:parameter} so that we can identify</span>
        <span class="c1"># the timed compartments and quickly retrieve their parameters. This is done here partly because we need</span>
        <span class="c1"># to instantiate the parameters first, and also because `framework.transitions` is keyed by parameter</span>
        <span class="c1"># rather than compartment so it&#39;s straightforward to include here</span>
        <span class="k">for</span> <span class="n">par_name</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">pars</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">pars</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">par_name</span><span class="p">,</span> <span class="s2">&quot;population type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">:</span>
                <span class="n">par</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">pop</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">par_name</span><span class="p">)</span>
                <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">par_name</span><span class="p">,</span> <span class="s2">&quot;format&quot;</span><span class="p">]</span>
                <span class="n">par</span><span class="o">.</span><span class="n">timescale</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">par_name</span><span class="p">,</span> <span class="s2">&quot;timescale&quot;</span><span class="p">]</span>
                <span class="n">par</span><span class="o">.</span><span class="n">derivative</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">par_name</span><span class="p">,</span> <span class="s2">&quot;is derivative&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">par</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">par_lookup</span> <span class="o">=</span> <span class="p">{</span><span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">par</span> <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">}</span>

        <span class="c1"># Instantiate compartments</span>
        <span class="n">residual_junctions</span> <span class="o">=</span> <span class="p">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">framework</span><span class="o">.</span><span class="n">transitions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;&gt;&quot;</span><span class="p">,</span> <span class="p">[])}</span>
        <span class="k">for</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">comps</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">comps</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">comp_name</span><span class="p">,</span> <span class="s2">&quot;population type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="n">residual_junctions</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">comps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ResidualJunctionCompartment</span><span class="p">(</span><span class="n">pop</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">comp_name</span><span class="p">,</span> <span class="n">duration_group</span><span class="o">=</span><span class="n">comps</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">comp_name</span><span class="p">,</span> <span class="s2">&quot;duration group&quot;</span><span class="p">]))</span>
                <span class="k">elif</span> <span class="n">comps</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">comp_name</span><span class="p">,</span> <span class="s2">&quot;is junction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">comps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">JunctionCompartment</span><span class="p">(</span><span class="n">pop</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">comp_name</span><span class="p">,</span> <span class="n">duration_group</span><span class="o">=</span><span class="n">comps</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">comp_name</span><span class="p">,</span> <span class="s2">&quot;duration group&quot;</span><span class="p">]))</span>
                <span class="k">elif</span> <span class="n">comps</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">comp_name</span><span class="p">,</span> <span class="s2">&quot;duration group&quot;</span><span class="p">]:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">comps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">TimedCompartment</span><span class="p">(</span><span class="n">pop</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">comp_name</span><span class="p">,</span> <span class="n">parameter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">par_lookup</span><span class="p">[</span><span class="n">comps</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">comp_name</span><span class="p">,</span> <span class="s2">&quot;duration group&quot;</span><span class="p">]]))</span>
                <span class="k">elif</span> <span class="n">comps</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">comp_name</span><span class="p">,</span> <span class="s2">&quot;is source&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">comps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SourceCompartment</span><span class="p">(</span><span class="n">pop</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">comp_name</span><span class="p">))</span>
                <span class="k">elif</span> <span class="n">comps</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">comp_name</span><span class="p">,</span> <span class="s2">&quot;is sink&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">comps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SinkCompartment</span><span class="p">(</span><span class="n">pop</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">comp_name</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">comps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Compartment</span><span class="p">(</span><span class="n">pop</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">comp_name</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">comp_lookup</span> <span class="o">=</span> <span class="p">{</span><span class="n">comp</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">comp</span> <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">comps</span><span class="p">}</span>

        <span class="c1"># Characteristics first pass, instantiate objects</span>
        <span class="k">for</span> <span class="n">charac_name</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">characs</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">characs</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">charac_name</span><span class="p">,</span> <span class="s2">&quot;population type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">characs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Characteristic</span><span class="p">(</span><span class="n">pop</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">charac_name</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">charac_lookup</span> <span class="o">=</span> <span class="p">{</span><span class="n">charac</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">charac</span> <span class="k">for</span> <span class="n">charac</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">characs</span><span class="p">}</span>

        <span class="c1"># Characteristics second pass, add includes and denominator</span>
        <span class="c1"># This is a separate pass because characteristics can depend on each other</span>
        <span class="k">for</span> <span class="n">charac</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">characs</span><span class="p">:</span>
            <span class="n">includes</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">characs</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">charac</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;components&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">inc_name</span> <span class="ow">in</span> <span class="n">includes</span><span class="p">:</span>
                <span class="n">charac</span><span class="o">.</span><span class="n">add_include</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="n">inc_name</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># nb. We expect to only get one match for the name, so use index 0</span>
            <span class="n">denominator</span> <span class="o">=</span> <span class="n">characs</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">charac</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;denominator&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">denominator</span><span class="p">):</span>
                <span class="n">charac</span><span class="o">.</span><span class="n">add_denom</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_variable</span><span class="p">(</span><span class="n">denominator</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># nb. framework import strips whitespace from the overall field</span>

        <span class="c1"># Parameters second pass, create parameter objects and links</span>
        <span class="c1"># This is a separate pass because we can&#39;t create the links before the compartments are instantiated</span>
        <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">framework</span><span class="o">.</span><span class="n">transitions</span><span class="p">[</span><span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">framework</span><span class="o">.</span><span class="n">transitions</span><span class="p">[</span><span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">]:</span>
                    <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_comp</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">dst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_comp</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">src</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="n">par</span><span class="p">)</span>  <span class="c1"># If the parameter is a timed parameter, the TimedCompartment will also assign the FlushLink in this step</span>

        <span class="k">if</span> <span class="s2">&quot;&gt;&quot;</span> <span class="ow">in</span> <span class="n">framework</span><span class="o">.</span><span class="n">transitions</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">pair</span> <span class="ow">in</span> <span class="n">framework</span><span class="o">.</span><span class="n">transitions</span><span class="p">[</span><span class="s2">&quot;&gt;&quot;</span><span class="p">]:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">src</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_comp</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">dst</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_comp</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="n">src</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dst</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">NotFoundError</span><span class="p">:</span>
                    <span class="k">continue</span>

        <span class="c1"># Parameters third pass, process f_stacks, deps, and limits</span>
        <span class="c1"># This is a separate pass because output parameters can depend on Links</span>
        <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">:</span>
            <span class="n">min_value</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;minimum value&quot;</span><span class="p">]</span>
            <span class="n">max_value</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;maximum value&quot;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">min_value</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">max_value</span><span class="p">):</span>
                <span class="n">par</span><span class="o">.</span><span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="nb">max</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">min_value</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="n">max_value</span><span class="p">)]</span>

            <span class="n">fcn_str</span> <span class="o">=</span> <span class="n">pars</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;function&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">fcn_str</span><span class="p">):</span>
                <span class="n">par</span><span class="o">.</span><span class="n">set_fcn</span><span class="p">(</span><span class="n">fcn_str</span><span class="p">)</span>

        <span class="c1"># If this Parameter has links and a function, it must be updated before it is needed during integration.</span>
        <span class="c1"># If the function depends on any compartment sizes, it must be updated element-wise during integration.</span>
        <span class="c1"># Similarly, if it is a derivative parameter, it needs to be updated element-wise.</span>
        <span class="c1"># Otherwise, it can be pre-computed in a fast vector operation</span>
        <span class="c1"># A timed parameter doesn&#39;t _directly_ have links associated with it (because it does not supply values</span>
        <span class="c1"># for the links) but it does need to be precomputed</span>
        <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pars</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">fcn_str</span> <span class="ow">and</span> <span class="p">(</span><span class="n">par</span><span class="o">.</span><span class="n">links</span> <span class="ow">or</span> <span class="n">par</span><span class="o">.</span><span class="n">derivative</span> <span class="ow">or</span> <span class="n">framework</span><span class="o">.</span><span class="n">pars</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;timed&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;y&quot;</span> <span class="ow">or</span> <span class="p">(</span><span class="n">progset</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="n">progset</span><span class="o">.</span><span class="n">covouts</span><span class="p">)):</span>
                <span class="n">par</span><span class="o">.</span><span class="n">set_dynamic</span><span class="p">(</span><span class="n">progset</span><span class="p">)</span></div>


<div class="viewcode-block" id="Population.initialize_compartments">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Population.html#atomica.model.Population.initialize_compartments">[docs]</a>
    <span class="k">def</span> <span class="nf">initialize_compartments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parset</span><span class="p">:</span> <span class="n">ParameterSet</span><span class="p">,</span> <span class="n">framework</span><span class="p">,</span> <span class="n">t_init</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set compartment sizes</span>

<span class="sd">        This method takes the databook values for compartments and characteristics, and uses them to</span>
<span class="sd">        compute the initial compartment sizes at ``ti=0``. The computation is carried out by solving</span>
<span class="sd">        the linear matrix equation mapping characteristics to compartments. For this purpose,</span>
<span class="sd">        both compartments and characteristics in the databook are treated in the same way i.e. a databook</span>
<span class="sd">        compartment is treated like a characteristic containing only that compartment.</span>

<span class="sd">        :param parset: A py:class:`ParameterSet` instance with initial values for compartments/characteristics</span>
<span class="sd">        :param framework: A py:class:`ProjectFramework` instance, used to identify and retrieve interaction terms</span>
<span class="sd">        :param t_init: The year to use for initialization. This should generally be set to the sim start year</span>

<span class="sd">        &quot;&quot;&quot;</span>


        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">comps</span><span class="p">:</span>
            <span class="c1"># If this population has no compartments, then nothing needs to be done</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">parset</span><span class="o">.</span><span class="n">initialization</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># If the parset contains explicit parameter values, try to apply them</span>
            <span class="n">parset</span><span class="o">.</span><span class="n">apply_initialization</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">framework</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Given a set of characteristics and their initial values, compute the initial</span>
        <span class="c1"># values for the compartments by solving the set of characteristics simultaneously</span>

        <span class="c1"># Build up the comps and characs containing the setup values in the databook - the `b` in `x=A*b`</span>
        <span class="n">characs_to_use</span> <span class="o">=</span> <span class="n">framework</span><span class="o">.</span><span class="n">characs</span><span class="o">.</span><span class="n">index</span><span class="p">[(</span><span class="n">framework</span><span class="o">.</span><span class="n">characs</span><span class="p">[</span><span class="s2">&quot;setup weight&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">framework</span><span class="o">.</span><span class="n">characs</span><span class="p">[</span><span class="s2">&quot;population type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)]</span>
        <span class="n">comps_to_use</span> <span class="o">=</span> <span class="n">framework</span><span class="o">.</span><span class="n">comps</span><span class="o">.</span><span class="n">index</span><span class="p">[(</span><span class="n">framework</span><span class="o">.</span><span class="n">comps</span><span class="p">[</span><span class="s2">&quot;setup weight&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">framework</span><span class="o">.</span><span class="n">comps</span><span class="p">[</span><span class="s2">&quot;population type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)]</span>
        <span class="n">b_objs</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">charac_lookup</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">characs_to_use</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">comp_lookup</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">comps_to_use</span><span class="p">]</span>

        <span class="c1"># Build up the comps corresponding to the `x` values in `x=A*b` i.e. the compartments being solved for</span>
        <span class="n">comps</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">comps</span> <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">SourceCompartment</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">SinkCompartment</span><span class="p">))]</span>
        <span class="n">charac_indices</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">b_objs</span><span class="p">)}</span>  <span class="c1"># Make lookup dict for characteristic indices</span>
        <span class="n">comp_indices</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">comps</span><span class="p">)}</span>  <span class="c1"># Make lookup dict for compartment indices</span>

        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">b_objs</span><span class="p">),</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">b_objs</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">comps</span><span class="p">)))</span>

        <span class="c1"># Construct the characteristic value vector (b) and the includes matrix (A)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">b_objs</span><span class="p">):</span>
            <span class="c1"># Look up the characteristic value</span>
            <span class="n">par</span> <span class="o">=</span> <span class="n">parset</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">par</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">t_init</span><span class="p">,</span> <span class="n">pop_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">par</span><span class="o">.</span><span class="n">y_factor</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">*</span> <span class="n">par</span><span class="o">.</span><span class="n">meta_y_factor</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">Characteristic</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">obj</span><span class="o">.</span><span class="n">denominator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">denom_par</span> <span class="o">=</span> <span class="n">parset</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">denominator</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
                    <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="n">denom_par</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">t_init</span><span class="p">,</span> <span class="n">pop_name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">denom_par</span><span class="o">.</span><span class="n">y_factor</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">*</span> <span class="n">denom_par</span><span class="o">.</span><span class="n">meta_y_factor</span>
                <span class="k">for</span> <span class="n">inc</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">get_included_comps</span><span class="p">():</span>
                    <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">comp_indices</span><span class="p">[</span><span class="n">inc</span><span class="o">.</span><span class="n">name</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">comp_indices</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]]</span> <span class="o">=</span> <span class="mf">1.0</span>

        <span class="c1"># Solve the linear system (nb. lstsq returns the minimum norm solution</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lstsq</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">b</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span> <span class="n">rcond</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">proposed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">residual</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">proposed</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Accumulate any errors here. The errors could occur either at the system level or at the level</span>
        <span class="c1"># of individual comps/characs. To avoid</span>
        <span class="n">error_msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">characteristic_tolerence_failed</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># Print warning for characteristics that are not well matched by the compartment size solution</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">b_objs</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">proposed</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">model_settings</span><span class="p">[</span><span class="s2">&quot;tolerance&quot;</span><span class="p">]:</span>
                <span class="n">characteristic_tolerence_failed</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">error_msg</span> <span class="o">+=</span> <span class="s2">&quot;Characteristic &#39;</span><span class="si">{0}</span><span class="s2">&#39; &#39;</span><span class="si">{1}</span><span class="s2">&#39; - Requested </span><span class="si">{2}</span><span class="s2">, Calculated </span><span class="si">{3}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">b_objs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">proposed</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="c1"># Print expanded diagnostic for negative compartments showing parent characteristics</span>
        <span class="k">def</span> <span class="nf">report_characteristic</span><span class="p">(</span><span class="n">charac</span><span class="p">,</span> <span class="n">n_indent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Recursively diagnose characteristic</span>

<span class="sd">            If a compartment has been assigned a negative value, it is usually because</span>
<span class="sd">            that negative value is required to match a target characteristic value. This</span>
<span class="sd">            method takes the root characteristic, and prints out all of the compartments</span>
<span class="sd">            relating to it, as well as descending further into any included characteristics.</span>
<span class="sd">            This brings together all of the affected quantities to help diagnose where the</span>
<span class="sd">            negative compartment size originates.</span>

<span class="sd">            :param charac: A :class:`Characteristic` instance</span>
<span class="sd">            :param n_indent: Indent level used to prefix the log message</span>
<span class="sd">            :return: A string containing the debug output</span>

<span class="sd">            &quot;&quot;&quot;</span>

            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">if</span> <span class="n">charac</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">charac_indices</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="n">n_indent</span> <span class="o">*</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;Characteristic &#39;</span><span class="si">{0}</span><span class="s2">&#39;: Target value = </span><span class="si">{1}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">charac</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">b</span><span class="p">[</span><span class="n">charac_indices</span><span class="p">[</span><span class="n">charac</span><span class="o">.</span><span class="n">name</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="n">n_indent</span> <span class="o">*</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;Characteristic &#39;</span><span class="si">{0}</span><span class="s2">&#39; not in databook: Target value = N/A (0.0)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">charac</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="n">n_indent</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">charac</span><span class="p">,</span> <span class="n">Characteristic</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">inc</span> <span class="ow">in</span> <span class="n">charac</span><span class="o">.</span><span class="n">includes</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">inc</span><span class="p">,</span> <span class="n">Characteristic</span><span class="p">):</span>
                        <span class="n">msg</span> <span class="o">+=</span> <span class="n">report_characteristic</span><span class="p">(</span><span class="n">inc</span><span class="p">,</span> <span class="n">n_indent</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">msg</span> <span class="o">+=</span> <span class="n">n_indent</span> <span class="o">*</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;Compartment </span><span class="si">%s</span><span class="s2">: Computed value = </span><span class="si">%f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">inc</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">comp_indices</span><span class="p">[</span><span class="n">inc</span><span class="o">.</span><span class="n">name</span><span class="p">]])</span>
            <span class="k">return</span> <span class="n">msg</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">comps</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">model_settings</span><span class="p">[</span><span class="s2">&quot;tolerance&quot;</span><span class="p">]:</span>
                <span class="n">error_msg</span> <span class="o">+=</span> <span class="s2">&quot;Compartment </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> - Calculated </span><span class="si">%f</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">comps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">charac</span> <span class="ow">in</span> <span class="n">b_objs</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">comps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">charac</span><span class="o">.</span><span class="n">get_included_comps</span><span class="p">():</span>
                            <span class="n">error_msg</span> <span class="o">+=</span> <span class="n">report_characteristic</span><span class="p">(</span><span class="n">charac</span><span class="p">)</span>
                    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">comps</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">charac</span><span class="p">:</span>
                            <span class="n">error_msg</span> <span class="o">+=</span> <span class="n">report_characteristic</span><span class="p">(</span><span class="n">charac</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">residual</span> <span class="o">&gt;</span> <span class="n">model_settings</span><span class="p">[</span><span class="s2">&quot;tolerance&quot;</span><span class="p">]:</span>
            <span class="c1"># Halt for an unsatisfactory overall solution</span>
            <span class="k">raise</span> <span class="n">BadInitialization</span><span class="p">(</span><span class="s2">&quot;Global residual was </span><span class="si">%g</span><span class="s2"> which is unacceptably large (should be &lt; </span><span class="si">%g</span><span class="s2">)</span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">residual</span><span class="p">,</span> <span class="n">model_settings</span><span class="p">[</span><span class="s2">&quot;tolerance&quot;</span><span class="p">],</span> <span class="n">error_msg</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">less</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="n">model_settings</span><span class="p">[</span><span class="s2">&quot;tolerance&quot;</span><span class="p">])):</span>
            <span class="c1"># Halt for any negative popsizes</span>
            <span class="k">raise</span> <span class="n">BadInitialization</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Negative initial popsizes:</span><span class="se">\n</span><span class="si">{</span><span class="n">error_msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">characteristic_tolerence_failed</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">BadInitialization</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Characteristics failed to meet tolerances</span><span class="se">\n</span><span class="si">{</span><span class="n">error_msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">error_msg</span><span class="p">:</span>
            <span class="c1"># Generic error message if any of the warning messages were encountered - not entirely sure when</span>
            <span class="c1"># this would happen so if this *does* occur, it should be written as an explicit branch above</span>
            <span class="c1"># (but it exists as a fallback to ensure that any inconsistencies result in the error being raised)</span>
            <span class="k">raise</span> <span class="n">BadInitialization</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Initialization error</span><span class="se">\n</span><span class="si">{</span><span class="n">error_msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Otherwise, insert the values</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">comps</span><span class="p">):</span>
            <span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">])</span></div>
</div>



<div class="viewcode-block" id="Model">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model">[docs]</a>
<span class="k">class</span> <span class="nc">Model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class to wrap up multiple populations within model and handle cross-population transitions.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">settings</span><span class="p">,</span> <span class="n">framework</span><span class="p">,</span> <span class="n">parset</span><span class="p">,</span> <span class="n">progset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">program_instructions</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="c1"># Note that if a progset is provided and program instructions are not, then programs will not be</span>
        <span class="c1"># turned on. However, the progset is still available so that the coverage can still be probed</span>
        <span class="c1"># (in particular, the coverage denominator from Result.get_coverage(&#39;denominator&#39;) is used</span>
        <span class="c1"># for reconciliation</span>

        <span class="c1"># Record version info for the model run. These are generally NOT updated in migration. Thus, they serve</span>
        <span class="c1"># as a record of which specific version of the code was used to generate the results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="n">version</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gitinfo</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">dcp</span><span class="p">(</span><span class="n">gitinfo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">pops</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>  <span class="c1"># List of population groups that this model subdivides into.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interactions</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">odict</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">programs_active</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># True or False depending on whether Programs will be used or not</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progset</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">dcp</span><span class="p">(</span><span class="n">progset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">program_instructions</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">dcp</span><span class="p">(</span><span class="n">program_instructions</span><span class="p">)</span>  <span class="c1"># program instructions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">tvec</span>  <span class="c1">#: Simulation time vector (this is a brand new instance from the `settings.tvec` property method)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">settings</span><span class="o">.</span><span class="n">sim_dt</span>  <span class="c1">#: Simulation time step</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_t_index</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># Keeps track of array index for current timepoint data within all compartments.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Cache to look up lists of variables by name across populations</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pop_ids</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">odict</span><span class="p">()</span>  <span class="c1"># Maps name of a population to its position index within populations list.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: Cache program capacities and coverage for coverage scenarios</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_exec_order</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1">#: Cache the dependency order of various quantities</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">framework</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">dcp</span><span class="p">(</span><span class="n">framework</span><span class="p">)</span>  <span class="c1"># Store a copy of the Framework used to generate this model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">spreadsheet</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># No need to keep the spreadsheet</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">parset</span><span class="p">)</span>

<div class="viewcode-block" id="Model.unlink">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.unlink">[docs]</a>
    <span class="k">def</span> <span class="nf">unlink</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace references with IDs</span>

<span class="sd">        This method replaces all references with IDs so that there are no circular references</span>
<span class="sd">        that prevent pickling. This operation is reversed using ``Model.relink()``. These get</span>
<span class="sd">        called automatically when pickling and unpickling.</span>

<span class="sd">        Note that primary storage of the variables is in the population objects, so that is the</span>
<span class="sd">        one place where the variables remain in-scope.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># If we are already unlinked, do nothing</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">:</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>

        <span class="c1"># Drop this, it gets set by self._set_vars_by_pop()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Drop caches - these get set again inside `model.process()`</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_exec_order</span> <span class="o">=</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Model.relink">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.relink">[docs]</a>
    <span class="k">def</span> <span class="nf">relink</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Replace IDs with references</span>

<span class="sd">        This is the reverse operation of ``Model.unlink()`` where IDs are replaced with</span>
<span class="sd">        object references.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># If we are already linked, do nothing</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># Need to enumerate objects at Model level because transitions link across pops</span>
        <span class="n">objs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">:</span>
            <span class="n">objs</span><span class="p">[</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">pop</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">pop</span><span class="o">.</span><span class="n">comps</span> <span class="o">+</span> <span class="n">pop</span><span class="o">.</span><span class="n">characs</span> <span class="o">+</span> <span class="n">pop</span><span class="o">.</span><span class="n">pars</span> <span class="o">+</span> <span class="n">pop</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
                <span class="n">objs</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>

        <span class="c1"># Relink populations</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">:</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">relink</span><span class="p">(</span><span class="n">objs</span><span class="p">)</span>

        <span class="c1"># Set vars by pop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_vars_by_pop</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">_update_program_cache</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="c1"># Finally, prepare programs</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">progset</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">program_instructions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">programs_active</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span><span class="p">[</span><span class="s2">&quot;comps&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">prog</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">progset</span><span class="o">.</span><span class="n">programs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span><span class="p">[</span><span class="s2">&quot;comps&quot;</span><span class="p">][</span><span class="n">prog</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">pop_name</span> <span class="ow">in</span> <span class="n">prog</span><span class="o">.</span><span class="n">target_pops</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">comp_name</span> <span class="ow">in</span> <span class="n">prog</span><span class="o">.</span><span class="n">target_comps</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span><span class="p">[</span><span class="s2">&quot;comps&quot;</span><span class="p">][</span><span class="n">prog</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_pop</span><span class="p">(</span><span class="n">pop_name</span><span class="p">)</span><span class="o">.</span><span class="n">get_comp</span><span class="p">(</span><span class="n">comp_name</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span><span class="p">[</span><span class="s2">&quot;capacities&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">progset</span><span class="o">.</span><span class="n">get_capacities</span><span class="p">(</span><span class="n">tvec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span> <span class="n">instructions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">program_instructions</span><span class="p">)</span>

            <span class="c1"># Cache the proportion coverage for coverage scenarios so that we don&#39;t call interpolate() every timestep</span>
            <span class="n">coverage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">progset</span><span class="o">.</span><span class="n">get_prop_coverage</span><span class="p">(</span><span class="n">tvec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">,</span> <span class="n">capacities</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span><span class="p">[</span><span class="s2">&quot;capacities&quot;</span><span class="p">],</span> <span class="n">num_eligible</span><span class="o">=</span><span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">progset</span><span class="o">.</span><span class="n">programs</span><span class="p">},</span> <span class="n">instructions</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">program_instructions</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span><span class="p">[</span><span class="s2">&quot;prop_coverage&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">coverage</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">program_instructions</span><span class="o">.</span><span class="n">coverage</span><span class="p">}</span>

            <span class="c1"># Check that any programs with no coverage denominator have been given coverage overwrites</span>
            <span class="c1"># Otherwise, the coverage denominator will be treated as 0 and will result in 100% coverage</span>
            <span class="c1"># but that would just be a side effect of not targeting anyone (division by 0 is treated as 100%)</span>
            <span class="k">for</span> <span class="n">prog</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">progset</span><span class="o">.</span><span class="n">programs</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span><span class="p">[</span><span class="s2">&quot;comps&quot;</span><span class="p">][</span><span class="n">prog</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="ow">and</span> <span class="n">prog</span><span class="o">.</span><span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span><span class="p">[</span><span class="s2">&quot;prop_coverage&quot;</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Program &quot;</span><span class="si">{</span><span class="n">prog</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&quot; does not target any compartments, but the program instructions did not specify coverage for this program. Programs without target compartments require their coverage to be explicitly specified in the instructions&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">programs_active</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">_set_vars_by_pop</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update cache dicts and lists</span>

<span class="sd">        During integration, the model needs to iterate over parameters with the same name across populations.</span>
<span class="sd">        Therefore, we build a cache dict where we map code names to a list of references to the required</span>
<span class="sd">        Parameter objects. We also construct a cache list of the parameter names from the framework so we</span>
<span class="sd">        can quickly iterate over it.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">pop</span><span class="o">.</span><span class="n">comps</span> <span class="o">+</span> <span class="n">pop</span><span class="o">.</span><span class="n">characs</span> <span class="o">+</span> <span class="n">pop</span><span class="o">.</span><span class="n">pars</span> <span class="o">+</span> <span class="n">pop</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span><span class="p">[</span><span class="n">var</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span><span class="p">)</span>  <span class="c1"># Stop new entries from appearing in here by accident</span>

    <span class="k">def</span> <span class="nf">__getstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">dcp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>  <span class="c1"># Pickling to string results in a copy</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relink</span><span class="p">()</span>  <span class="c1"># Relink, otherwise the original object gets unlinked</span>
        <span class="k">return</span> <span class="n">d</span>

    <span class="k">def</span> <span class="nf">__setstate__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span> <span class="o">=</span> <span class="n">d</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relink</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">memodict</span><span class="o">=</span><span class="p">{}):</span>
        <span class="c1"># Using dcp(self.__dict__) is faster than pickle getstate/setstate</span>
        <span class="c1"># when this is called via copy.deepcopy()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">dcp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relink</span><span class="p">()</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">Model</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="n">Model</span><span class="p">)</span>
        <span class="n">new</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">new</span><span class="o">.</span><span class="n">relink</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">new</span>

<div class="viewcode-block" id="Model.get_pop">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.get_pop">[docs]</a>
    <span class="k">def</span> <span class="nf">get_pop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pop_name</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Allow model populations to be retrieved by name rather than index.&quot;&quot;&quot;</span>
        <span class="n">pop_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pop_ids</span><span class="p">[</span><span class="n">pop_name</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">pop_index</span><span class="p">]</span></div>


<div class="viewcode-block" id="Model.build">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.build">[docs]</a>
    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parset</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Build the full model.&quot;&quot;&quot;</span>

        <span class="c1"># First construct populations</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">pop_name</span><span class="p">,</span> <span class="n">pop_label</span><span class="p">,</span> <span class="n">pop_type</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">parset</span><span class="o">.</span><span class="n">pop_names</span><span class="p">,</span> <span class="n">parset</span><span class="o">.</span><span class="n">pop_labels</span><span class="p">,</span> <span class="n">parset</span><span class="o">.</span><span class="n">pop_types</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Population</span><span class="p">(</span><span class="n">framework</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">framework</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">pop_name</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">pop_label</span><span class="p">,</span> <span class="n">progset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">progset</span><span class="p">,</span> <span class="n">pop_type</span><span class="o">=</span><span class="n">pop_type</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_pop_ids</span><span class="p">[</span><span class="n">pop_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">k</span>

        <span class="c1"># Expand interactions into matrix form</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interactions</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">weights</span> <span class="ow">in</span> <span class="n">parset</span><span class="o">.</span><span class="n">interactions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">from_pops</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">interactions</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;from population type&quot;</span><span class="p">]]</span>
            <span class="n">to_pops</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">interactions</span><span class="o">.</span><span class="n">at</span><span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;to population type&quot;</span><span class="p">]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interactions</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">from_pops</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">to_pops</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)))</span>
            <span class="k">for</span> <span class="n">from_pop</span><span class="p">,</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">weights</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">for</span> <span class="n">to_pop</span> <span class="ow">in</span> <span class="n">par</span><span class="o">.</span><span class="n">pops</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">interactions</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">from_pops</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">from_pop</span><span class="p">),</span> <span class="n">to_pops</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">to_pop</span><span class="p">),</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">par</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">to_pop</span><span class="p">)</span> <span class="o">*</span> <span class="n">par</span><span class="o">.</span><span class="n">y_factor</span><span class="p">[</span><span class="n">to_pop</span><span class="p">]</span> <span class="o">*</span> <span class="n">par</span><span class="o">.</span><span class="n">meta_y_factor</span>

        <span class="c1"># Instantiate transfer parameters</span>
        <span class="c1"># Note transfer parameters can currently only be data parameters (i.e. they don&#39;t have any functions) so</span>
        <span class="c1"># no need to worry about setting functions and flagging dependencies for them</span>
        <span class="k">for</span> <span class="n">transfer_name</span> <span class="ow">in</span> <span class="n">parset</span><span class="o">.</span><span class="n">transfers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">parset</span><span class="o">.</span><span class="n">transfers</span><span class="p">[</span><span class="n">transfer_name</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">pop_source</span> <span class="ow">in</span> <span class="n">parset</span><span class="o">.</span><span class="n">transfers</span><span class="p">[</span><span class="n">transfer_name</span><span class="p">]:</span>

                    <span class="c1"># This contains the data for all of the destination pops.</span>
                    <span class="n">transfer_parameter</span> <span class="o">=</span> <span class="n">parset</span><span class="o">.</span><span class="n">transfers</span><span class="p">[</span><span class="n">transfer_name</span><span class="p">][</span><span class="n">pop_source</span><span class="p">]</span>

                    <span class="n">pop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pop</span><span class="p">(</span><span class="n">pop_source</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">pop_target</span> <span class="ow">in</span> <span class="n">transfer_parameter</span><span class="o">.</span><span class="n">ts</span><span class="p">:</span>

                        <span class="c1"># Create the parameter object for this link (shared across all compartments)</span>
                        <span class="n">par_name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">_</span><span class="si">%s</span><span class="s2">_to_</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">transfer_name</span><span class="p">,</span> <span class="n">pop_source</span><span class="p">,</span> <span class="n">pop_target</span><span class="p">)</span>  <span class="c1"># e.g. &#39;aging_0-4_to_15-64&#39;</span>
                        <span class="n">par</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">pop</span><span class="o">=</span><span class="n">pop</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">par_name</span><span class="p">)</span>
                        <span class="n">par</span><span class="o">.</span><span class="n">preallocate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>  <span class="c1"># Preallocate now, because these parameters are not present in the framework so they won&#39;t get preallocated later</span>
                        <span class="n">par</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">=</span> <span class="n">transfer_parameter</span><span class="o">.</span><span class="n">y_factor</span><span class="p">[</span><span class="n">pop_target</span><span class="p">]</span> <span class="o">*</span> <span class="n">transfer_parameter</span><span class="o">.</span><span class="n">meta_y_factor</span>
                        <span class="n">par</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">transfer_parameter</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">tvec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">pop_name</span><span class="o">=</span><span class="n">pop_target</span><span class="p">)</span> <span class="o">*</span> <span class="n">par</span><span class="o">.</span><span class="n">scale_factor</span>
                        <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="o">=</span> <span class="n">transfer_parameter</span><span class="o">.</span><span class="n">ts</span><span class="p">[</span><span class="n">pop_target</span><span class="p">]</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

                        <span class="c1"># Sampling might result in the parameter value going out of bounds, so make sure the transfer parameter values are constrained</span>
                        <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="ow">in</span> <span class="p">{</span><span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_RATE</span><span class="p">,</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_PROBABILITY</span><span class="p">,</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_NUMBER</span><span class="p">}:</span>
                            <span class="n">par</span><span class="o">.</span><span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>
                        <span class="k">elif</span> <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_DURATION</span><span class="p">:</span>
                            <span class="n">par</span><span class="o">.</span><span class="n">limits</span> <span class="o">=</span> <span class="p">[</span><span class="n">model_settings</span><span class="p">[</span><span class="s2">&quot;tolerance&quot;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">]</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Unknown transfer parameter units&quot;</span><span class="p">)</span>
                        <span class="n">par</span><span class="o">.</span><span class="n">constrain</span><span class="p">()</span>

                        <span class="n">pop</span><span class="o">.</span><span class="n">pars</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">par</span><span class="p">)</span>
                        <span class="n">pop</span><span class="o">.</span><span class="n">par_lookup</span><span class="p">[</span><span class="n">par_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">par</span>

                        <span class="n">target_pop_obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_pop</span><span class="p">(</span><span class="n">pop_target</span><span class="p">)</span>

                        <span class="k">for</span> <span class="n">src</span> <span class="ow">in</span> <span class="n">pop</span><span class="o">.</span><span class="n">comps</span><span class="p">:</span>
                            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">SourceCompartment</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">SinkCompartment</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">JunctionCompartment</span><span class="p">)):</span>
                                <span class="c1"># Instantiate a link between corresponding compartments</span>
                                <span class="n">dest</span> <span class="o">=</span> <span class="n">target_pop_obj</span><span class="o">.</span><span class="n">get_comp</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>  <span class="c1"># Get the corresponding compartment</span>
                                <span class="n">src</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">dest</span><span class="p">,</span> <span class="n">par</span><span class="p">)</span>

        <span class="c1"># Now that all object have been created, update _vars_by_pop() accordingly</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_vars_by_pop</span><span class="p">()</span>

        <span class="c1"># Flag dependencies for aggregated parameters prior to precomputing</span>
        <span class="c1"># Note that all parameters have been instantiated and we can set_dynamic</span>
        <span class="c1"># in any order, as long as we examine all parameters</span>
        <span class="k">for</span> <span class="n">par_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">pars</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>

            <span class="k">if</span> <span class="n">par_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">pars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span><span class="p">[</span><span class="n">par_name</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">:</span>
                <span class="c1"># Make the parameter dynamic, because it needs to be computed during integration</span>
                <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">pars</span><span class="p">:</span>
                    <span class="n">par</span><span class="o">.</span><span class="n">set_dynamic</span><span class="p">()</span>

                <span class="c1"># Also make the variable being aggregated dynamic</span>
                <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span><span class="p">[</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">[</span><span class="mi">1</span><span class="p">]]:</span>
                    <span class="n">var</span><span class="o">.</span><span class="n">set_dynamic</span><span class="p">(</span><span class="n">progset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">progset</span><span class="p">)</span>

                <span class="c1"># If there is a weighting variable,</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span><span class="p">[</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">[</span><span class="mi">3</span><span class="p">]]:</span>
                        <span class="n">var</span><span class="o">.</span><span class="n">set_dynamic</span><span class="p">(</span><span class="n">progset</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">progset</span><span class="p">)</span>

        <span class="c1"># Set execution order - needs to be done _after_ pop aggregations have been flagged as dynamic</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_exec_order</span><span class="p">()</span>

        <span class="c1"># Insert parameter initial values and do any required precomputation</span>
        <span class="k">for</span> <span class="n">par_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exec_order</span><span class="p">[</span><span class="s2">&quot;all_pars&quot;</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">par_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parset</span><span class="o">.</span><span class="n">pars</span><span class="p">:</span>
                <span class="c1"># This happens for transfer parameters that don&#39;t appear in parset.pars, but they have been updated already above</span>
                <span class="k">continue</span>

            <span class="n">cascade_par</span> <span class="o">=</span> <span class="n">parset</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="n">par_name</span><span class="p">]</span>
            <span class="n">pars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span><span class="p">[</span><span class="n">cascade_par</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">pars</span><span class="p">:</span>

                <span class="n">par</span><span class="o">.</span><span class="n">preallocate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
                <span class="n">par</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">=</span> <span class="n">cascade_par</span><span class="o">.</span><span class="n">meta_y_factor</span>  <span class="c1"># Set meta scale factor regardless of whether a population-specific y-factor is also provided</span>

                <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">cascade_par</span><span class="o">.</span><span class="n">y_factor</span><span class="p">:</span>
                    <span class="n">par</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">*=</span> <span class="n">cascade_par</span><span class="o">.</span><span class="n">y_factor</span><span class="p">[</span><span class="n">par</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>  <span class="c1"># Add in population-specific scale factor</span>

                <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="n">cascade_par</span><span class="o">.</span><span class="n">skip_function</span><span class="p">:</span>
                    <span class="n">par</span><span class="o">.</span><span class="n">skip_function</span> <span class="o">=</span> <span class="n">cascade_par</span><span class="o">.</span><span class="n">skip_function</span><span class="p">[</span><span class="n">par</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>  <span class="c1"># Copy in any skipped evaluations</span>
                    <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">skip_function</span><span class="p">:</span>
                        <span class="k">assert</span> <span class="n">cascade_par</span><span class="o">.</span><span class="n">has_values</span><span class="p">(</span><span class="n">par</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="s2">&quot;Parameter function was marked as being skipped for some of the simulation, but the ParameterSet has no values to use instead. If skipping, the ParameterSet must contain some values&quot;</span>

                <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">fcn_str</span> <span class="ow">and</span> <span class="n">par</span><span class="o">.</span><span class="n">_precompute</span><span class="p">:</span>
                    <span class="c1"># If the parameter is marked for precomputation, then insert it now</span>
                    <span class="n">par</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                <span class="k">elif</span> <span class="n">cascade_par</span><span class="o">.</span><span class="n">has_values</span><span class="p">(</span><span class="n">par</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                    <span class="c1"># If the databook contains values, then insert them now</span>
                    <span class="n">par</span><span class="o">.</span><span class="n">vals</span> <span class="o">=</span> <span class="n">cascade_par</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">tvec</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">pop_name</span><span class="o">=</span><span class="n">par</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="o">*</span> <span class="n">par</span><span class="o">.</span><span class="n">scale_factor</span>

                <span class="n">par</span><span class="o">.</span><span class="n">constrain</span><span class="p">()</span>  <span class="c1"># Sampling might result in the parameter value going out of bounds (or user might have entered bad values in the databook) so ensure they are clipped here</span>

        <span class="c1"># Finally, preallocate remaining quantities and initialize the compartments</span>
        <span class="c1"># Note that TimedLink preallocation depends on TimedCompartment preallocation</span>
        <span class="c1"># which is setting the duration based on the evaluated parameters above.</span>
        <span class="c1"># Therefore, in the loop below, compartments must be preallocated before links</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">pop</span><span class="o">.</span><span class="n">comps</span> <span class="o">+</span> <span class="n">pop</span><span class="o">.</span><span class="n">characs</span> <span class="o">+</span> <span class="n">pop</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
                <span class="n">obj</span><span class="o">.</span><span class="n">preallocate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>
            <span class="n">pop</span><span class="o">.</span><span class="n">initialize_compartments</span><span class="p">(</span><span class="n">parset</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">framework</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>


    <span class="k">def</span> <span class="nf">_set_exec_order</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the execution order</span>

<span class="sd">        Some quantities, like parameters, characteristics, and junctions, have dependencies that</span>
<span class="sd">        require them to be updated in a specific order. This method constructs directed</span>
<span class="sd">        graphs of the dependencies and returns the topological ordering, which specifies the order</span>
<span class="sd">        in which to update each quantity.</span>

<span class="sd">        For parameters, we need to update them in dependency order in three places - when precomputing or</span>
<span class="sd">        postcomputing, in which case we need all parameters, and during integration, in which case we only</span>
<span class="sd">        work with the dynamic parameters.</span>
<span class="sd">        which case we need to work with all parameters, and during integration, in which case we need to</span>
<span class="sd">        work.</span>

<span class="sd">        We also need to iterate over transition parameters when updating links, but actually this can be</span>
<span class="sd">        done in any order. However, we cache the transition parameters into a flat list here so that</span>
<span class="sd">        they can be efficiently iterated over.</span>

<span class="sd">        Note that the parameter update order is calculated from the framework, which may be relevant if</span>
<span class="sd">        the model structure is changed after building the model but before processing.</span>

<span class="sd">        :return: Dict containing execution orders for ``&#39;all_pars&#39;``,``dynamic_pars``,``characs``,``junctions``</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>

        <span class="n">exec_order</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="c1"># Set the parameter update order - this is a list of parameters names, in dependency order</span>
        <span class="c1"># The parameters may or may not exist in each population, but they are updated across populations</span>
        <span class="c1"># Since parameters are implemented one name at a time, here we set the parameter order by</span>
        <span class="c1"># making a graph using the names rather than actual parameter objects. Note that par_update_order</span>
        <span class="c1"># contains all parameters, which are used during initialization as well as in update_pars. However, we</span>
        <span class="c1"># could have update_pars only operate on the subset of the graph contributing to transitions, or to</span>
        <span class="c1"># dynamic programs or to program overwrites.</span>
        <span class="n">par_derivative</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">pars</span><span class="p">[</span><span class="s2">&quot;is derivative&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>  <span class="c1"># Store all parameter names in framework, as well as whether they are a derivative or not</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
        <span class="n">G</span><span class="o">.</span><span class="n">add_nodes_from</span><span class="p">(</span><span class="n">par_derivative</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">pop</span><span class="o">.</span><span class="n">pars</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">dep</span><span class="p">,</span> <span class="n">dep_var</span> <span class="ow">in</span> <span class="n">par</span><span class="o">.</span><span class="n">deps</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">dep</span> <span class="ow">in</span> <span class="n">par_derivative</span> <span class="ow">and</span> <span class="n">par_derivative</span><span class="p">[</span><span class="n">dep</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                        <span class="c1"># Derivative parameters are allowed to refer to themselves directly,</span>
                        <span class="c1"># and derivative parameters are not considered dependencies - so we do</span>
                        <span class="c1"># not need to add a dependency edge to the graph</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">dep</span><span class="p">,</span> <span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">pop_aggregation</span> <span class="ow">and</span> <span class="n">par</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">par_derivative</span> <span class="ow">and</span> <span class="n">par_derivative</span><span class="p">[</span><span class="n">par</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">!=</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">par</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">_is_dynamic</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progset</span> <span class="ow">and</span> <span class="n">par</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">progset</span><span class="o">.</span><span class="n">pars</span><span class="p">):</span>
                    <span class="c1"># If the parameter is dynamic or appears in the progset, then we need to</span>
                    <span class="c1"># include it in the list of parameters to iterate over in `update_pars`</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">][</span><span class="s2">&quot;keep&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">nx</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">is_directed_acyclic_graph</span><span class="p">(</span><span class="n">G</span><span class="p">):</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;Circular dependencies in parameters:&quot;</span>
            <span class="k">for</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">simple_cycles</span><span class="p">(</span><span class="n">G</span><span class="p">):</span>
                <span class="n">message</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> - &quot;</span> <span class="o">+</span> <span class="s2">&quot; -&gt; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cycle</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

        <span class="n">exec_order</span><span class="p">[</span><span class="s2">&quot;all_pars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span><span class="p">]</span>  <span class="c1"># Not all parameters may exist depending on populations, so filter out only the ones that are actually instantiated in this Model</span>
        <span class="n">exec_order</span><span class="p">[</span><span class="s2">&quot;dynamic_pars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">exec_order</span><span class="p">[</span><span class="s2">&quot;all_pars&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="s2">&quot;keep&quot;</span><span class="p">]]</span>

        <span class="c1"># Set the parameter execution order - this is a list of only transition parameters, used when updating links</span>
        <span class="c1"># This is a flat list of parameters, but the order actually should not matter since all parameters should be</span>
        <span class="c1"># resolved at this point</span>
        <span class="n">exec_order</span><span class="p">[</span><span class="s2">&quot;transition_pars&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">pop</span><span class="o">.</span><span class="n">pars</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">links</span> <span class="ow">and</span> <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="o">!=</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_PROPORTION</span><span class="p">:</span>
                    <span class="n">exec_order</span><span class="p">[</span><span class="s2">&quot;transition_pars&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">par</span><span class="p">)</span>

        <span class="c1"># Set characteristic execution order - in cases where characteristics depend on each other</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">charac</span> <span class="ow">in</span> <span class="n">pop</span><span class="o">.</span><span class="n">characs</span><span class="p">:</span>
                <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">charac</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">include</span> <span class="ow">in</span> <span class="n">charac</span><span class="o">.</span><span class="n">includes</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">include</span><span class="p">,</span> <span class="n">Characteristic</span><span class="p">):</span>
                        <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">include</span><span class="p">,</span> <span class="n">charac</span><span class="p">)</span>  <span class="c1"># Note directionality - the included characteristic needs to be added first</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">charac</span><span class="o">.</span><span class="n">denominator</span><span class="p">,</span> <span class="n">Characteristic</span><span class="p">):</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">charac</span><span class="o">.</span><span class="n">denominator</span><span class="p">,</span> <span class="n">charac</span><span class="p">)</span>  <span class="c1"># Note directionality - the included characteristic needs to be added first</span>
        <span class="k">assert</span> <span class="n">nx</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">is_directed_acyclic_graph</span><span class="p">(</span><span class="n">G</span><span class="p">),</span> <span class="s2">&quot;There is a circular dependency in characteristics, which is not permitted&quot;</span>
        <span class="n">exec_order</span><span class="p">[</span><span class="s2">&quot;characs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">nx</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">_is_dynamic</span><span class="p">]</span>  <span class="c1"># Topological sorting of the junction graph, which is a valid execution order</span>

        <span class="c1"># TODO - Move normal compartments into here as well</span>
        <span class="c1"># Set the junction execution order</span>
        <span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">pop</span><span class="o">.</span><span class="n">comps</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">comp</span><span class="p">,</span> <span class="n">JunctionCompartment</span><span class="p">):</span>
                    <span class="n">G</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">comp</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">comp</span><span class="o">.</span><span class="n">outlinks</span><span class="p">:</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">dest</span><span class="p">,</span> <span class="n">JunctionCompartment</span><span class="p">):</span>
                            <span class="n">G</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">link</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">dest</span><span class="p">)</span>

        <span class="k">assert</span> <span class="n">nx</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">is_directed_acyclic_graph</span><span class="p">(</span><span class="n">G</span><span class="p">),</span> <span class="s2">&quot;There is a cycle present where one junction has flows into another, which results in an infinite loop and is not permitted&quot;</span>
        <span class="n">exec_order</span><span class="p">[</span><span class="s2">&quot;junctions&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">dag</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="n">G</span><span class="p">))</span>  <span class="c1"># Topological sorting of the junction graph, which is a valid execution order</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_exec_order</span> <span class="o">=</span> <span class="n">exec_order</span>

<div class="viewcode-block" id="Model.process">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.process">[docs]</a>
    <span class="k">def</span> <span class="nf">process</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run the full model.&quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t_index</span> <span class="o">==</span> <span class="mi">0</span>  <span class="c1"># Only makes sense to process a simulation once, starting at ti=0 - this might be relaxed later on</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_exec_order</span><span class="p">()</span>  <span class="c1"># Set the execution order again in case the user has updated the parameters etc. It is critically important that this is correct during integration</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_program_cache</span><span class="p">()</span>

        <span class="c1"># Initial flush of people in junctions</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_pars</span><span class="p">()</span>  <span class="c1"># Update transition parameters in case junction outflows are function parameters</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flush_junctions</span><span class="p">()</span>  <span class="c1"># Flush the current contents of the junction without including any inflows</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_pars</span><span class="p">()</span>  <span class="c1"># Update the transition parameters in case junction outflows are functions _and_ they depend on compartment sizes that just changed in the line above</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_links</span><span class="p">()</span>  <span class="c1"># Update all of the links</span>

        <span class="c1"># Main integration loop</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t_index</span> <span class="o">&lt;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_t_index</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># Step the simulation forward</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_comps</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_pars</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_links</span><span class="p">()</span>

        <span class="c1"># Update postcompute parameters - note that it needs to be done in execution order</span>
        <span class="k">for</span> <span class="n">par_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exec_order</span><span class="p">[</span><span class="s2">&quot;all_pars&quot;</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span><span class="p">[</span><span class="n">par_name</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">fcn_str</span> <span class="ow">and</span> <span class="ow">not</span> <span class="p">(</span><span class="n">par</span><span class="o">.</span><span class="n">_is_dynamic</span> <span class="ow">or</span> <span class="n">par</span><span class="o">.</span><span class="n">_precompute</span><span class="p">):</span>
                    <span class="n">par</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
                    <span class="n">par</span><span class="o">.</span><span class="n">constrain</span><span class="p">()</span>

        <span class="c1"># Clear characteristic internal storage and switch to dynamic computation to save space</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">charac</span> <span class="ow">in</span> <span class="n">pop</span><span class="o">.</span><span class="n">characs</span><span class="p">:</span>
                <span class="n">charac</span><span class="o">.</span><span class="n">_vals</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Drop the program cache afterwards to save space</span></div>


<div class="viewcode-block" id="Model.update_links">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.update_links">[docs]</a>
    <span class="k">def</span> <span class="nf">update_links</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update link values</span>

<span class="sd">        This method takes the current parameter values in the model, and uses them to populate</span>
<span class="sd">        associated links. This requires conversion between parameter units and actual flow rates.</span>

<span class="sd">        Methods that populate links by means other than parameter e.g. `Compartment.resolve_outflows`</span>
<span class="sd">        or `Junction.balance` also get called here.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t_index</span>

        <span class="c1"># First, populate all of the link values without any outflow constraints</span>
        <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exec_order</span><span class="p">[</span><span class="s2">&quot;transition_pars&quot;</span><span class="p">]:</span>

            <span class="n">transition</span> <span class="o">=</span> <span class="n">par</span><span class="o">.</span><span class="n">vals</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">transition</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># This condition is likely to occur if the parameter has a function but it has been</span>
                <span class="c1"># incorrectly/poorly defined so that it returns a negative value. If this is expected</span>
                <span class="c1"># to happen under certain conditions, then the Framework should have a minimum value of 0</span>
                <span class="c1"># entered for the parameter to make it explicit that the value is constrained to be positive.</span>
                <span class="c1"># This could be important if the parameter is *also* used as a dependency in other parameters</span>
                <span class="c1"># because clipping in the Framework is applied before downstream parameters are computed, whereas</span>
                <span class="c1"># the check here only relates to the links, so an incorrect negative value could still propagate</span>
                <span class="c1"># to other parameters (but we cannot be *certain* here that this isn&#39;t what the user intended)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;Negative transition occurred&quot;</span><span class="p">)</span>
                <span class="n">transition</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">transition</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">par</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
                    <span class="n">link</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="k">continue</span>

            <span class="c1"># Convert probability by Poisson distribution formula to a value appropriate for timestep.</span>
            <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_RATE</span> <span class="ow">or</span> <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_PROBABILITY</span><span class="p">:</span>
                <span class="c1"># Note that we convert the transition to the timestep before checking whether it is greater than 1 or not. That way,</span>
                <span class="c1"># durations get preserved until we limit them based on the timestep size. The rationale is that the annual probability</span>
                <span class="c1"># will come out at 1.0 if the *mean* duration is the same as the step size, but that doesn&#39;t mean that if the step size</span>
                <span class="c1"># was smaller the timestep probability is also 1.0 - it&#39;s a consequence of the discretization. Essentially, a value</span>
                <span class="c1"># greater than 1 simply implies that the mean duration is less than the timescale in question, and we need to retain that value</span>
                <span class="c1"># to be able to correctly convert between timescales. The subsequent call to min() then ensures that the fraction moved never</span>
                <span class="c1"># exceeds 1.0 once operating on the timestep level</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">converted_frac</span> <span class="o">=</span> <span class="n">transition</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="n">par</span><span class="o">.</span><span class="n">timescale</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error when converting the parameter </span><span class="si">{</span><span class="n">par</span><span class="si">}</span><span class="s2"> to a per timestep value.&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
                <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">par</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
                    <span class="n">link</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="n">converted_frac</span>

            <span class="c1"># Linearly convert number down to that appropriate for one timestep.</span>
            <span class="k">elif</span> <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_NUMBER</span><span class="p">:</span>
                <span class="c1"># Disaggregate proportionally across all source compartment sizes related to all links.</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">converted_amt</span> <span class="o">=</span> <span class="n">transition</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="n">par</span><span class="o">.</span><span class="n">timescale</span><span class="p">)</span>  <span class="c1"># Number flow in this timestep, so it includes a timescale factor</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error when converting the parameter </span><span class="si">{</span><span class="n">par</span><span class="si">}</span><span class="s2"> to a per timestep value.&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">par</span><span class="o">.</span><span class="n">links</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">source</span><span class="p">,</span> <span class="n">SourceCompartment</span><span class="p">):</span>
                    <span class="c1"># For a source compartment, the link value should be explicitly set directly</span>
                    <span class="c1"># Also, there is guaranteed to only be one link per parameter for outflows from source compartments</span>
                    <span class="n">par</span><span class="o">.</span><span class="n">links</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="n">converted_amt</span>
                    <span class="k">continue</span>

                <span class="n">source_popsize</span> <span class="o">=</span> <span class="n">par</span><span class="o">.</span><span class="n">source_popsize</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">source_popsize</span><span class="p">:</span>
                    <span class="n">converted_frac</span> <span class="o">=</span> <span class="n">converted_amt</span> <span class="o">/</span> <span class="n">source_popsize</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">converted_frac</span> <span class="o">=</span> <span class="mf">0.0</span>

                <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">par</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
                    <span class="n">link</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="n">converted_frac</span>

            <span class="c1"># Convert from duration to equivalent probability</span>
            <span class="k">elif</span> <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_DURATION</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">converted_frac</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">/</span> <span class="p">(</span><span class="n">transition</span> <span class="o">*</span> <span class="n">par</span><span class="o">.</span><span class="n">timescale</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error when converting the parameter </span><span class="si">{</span><span class="n">par</span><span class="si">}</span><span class="s2"> to a per timestep value.&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
                <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">par</span><span class="o">.</span><span class="n">links</span><span class="p">:</span>
                    <span class="n">link</span><span class="o">.</span><span class="n">_cache</span> <span class="o">=</span> <span class="n">converted_frac</span>

            <span class="c1"># NOTE - proportion format parameters should not be present in the exec list, so any other units are an error</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">par_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">framework</span><span class="o">.</span><span class="n">get_label</span><span class="p">(</span><span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">NotFoundError</span><span class="p">:</span>  <span class="c1"># Name lookup will fail for transfer parameters</span>
                    <span class="n">par_label</span> <span class="o">=</span> <span class="n">par</span><span class="o">.</span><span class="n">name</span>
                <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="s2">&quot;Encountered unknown units &#39;</span><span class="si">%s</span><span class="s2">&#39; for Parameter &#39;</span><span class="si">%s</span><span class="s2">&#39; (</span><span class="si">%s</span><span class="s2">) in Population </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">par</span><span class="o">.</span><span class="n">units</span><span class="p">,</span> <span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">par_label</span><span class="p">,</span> <span class="n">par</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>

        <span class="c1"># Adjust cached fraction outflows and convert them to number units</span>
        <span class="c1"># `Compartment.resolve_outflows()` also populates flush links</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">pop</span><span class="o">.</span><span class="n">comps</span><span class="p">:</span>
                <span class="n">comp</span><span class="o">.</span><span class="n">resolve_outflows</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>

        <span class="c1"># Balance junctions. Note that the order of execution is critical here for junctions that flow into other junctions,</span>
        <span class="c1"># so `self._exec_order` must have already been populated</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exec_order</span><span class="p">[</span><span class="s2">&quot;junctions&quot;</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">j</span><span class="o">.</span><span class="n">balance</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error when balancing the junction: </span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>


<div class="viewcode-block" id="Model.update_comps">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.update_comps">[docs]</a>
    <span class="k">def</span> <span class="nf">update_comps</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the compartment values at self._t_index+1 based on the current values at self._t_index</span>
<span class="sd">        and the link values at self._t_index. Values are updated by iterating over all outgoing links</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t_index</span>

        <span class="c1"># Pre-populate the current value - need to iterate over pops here because transfers</span>
        <span class="c1"># will cross population boundaries</span>
        <span class="k">for</span> <span class="n">pop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">pop</span><span class="o">.</span><span class="n">comps</span><span class="p">:</span>
                <span class="n">comp</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span></div>


<div class="viewcode-block" id="Model.flush_junctions">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.flush_junctions">[docs]</a>
    <span class="k">def</span> <span class="nf">flush_junctions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Flush initialization values from junctions</span>

<span class="sd">        If junctions have been initialized with nonzero values as a mcv1 for initializing the</span>
<span class="sd">        downstream compartments, then the junctions need to be flushed into the downstream</span>
<span class="sd">        compartments at the start of the simulation. This is done using the ``.flush()`` method</span>
<span class="sd">        of the ``JunctionCompartment``. The order of the loop is important if junctions flow into</span>
<span class="sd">        other junctions - this needs to be computed from the graph prior to calling this method</span>
<span class="sd">        (so that ``Model.junctions`` is in the correct order)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exec_order</span><span class="p">[</span><span class="s2">&quot;junctions&quot;</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">j</span><span class="o">.</span><span class="n">initial_flush</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error when initially flushing junction: </span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span></div>


<div class="viewcode-block" id="Model.update_pars">
<a class="viewcode-back" href="../../_autosummary/atomica.model.Model.html#atomica.model.Model.update_pars">[docs]</a>
    <span class="k">def</span> <span class="nf">update_pars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update parameter values</span>

<span class="sd">        Run through all parameters and characteristics, updating as required. This takes place in stages</span>

<span class="sd">        1. Characteristics that are dependencies of parameters are updated</span>
<span class="sd">        2. Parameters are updated in dependency order</span>
<span class="sd">            a. The parameter function is evaluated</span>
<span class="sd">            b. The parameter is overwritten by programs</span>
<span class="sd">            c. The parameter is updated with the population aggregation calculation</span>
<span class="sd">            d. The parameter value is constrained</span>

<span class="sd">        The parameters are updated parameter-at-a-time (across populations) so that the population aggregation</span>
<span class="sd">        can be carried out.</span>

<span class="sd">        Only parameters that are required for transitions or that are overwritten by programs are</span>
<span class="sd">        modified here - otherwise, parameter values are computed in vector calculations either before</span>
<span class="sd">        integration (if the value is purely from the databook) or after integration (if the parameter depends</span>
<span class="sd">        on any flow rates or compartment sizes).</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ti</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_t_index</span>

        <span class="c1"># First, compute dependent characteristics, as parameters might depend on them</span>
        <span class="k">for</span> <span class="n">charac</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exec_order</span><span class="p">[</span><span class="s2">&quot;characs&quot;</span><span class="p">]:</span>
            <span class="n">charac</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>

        <span class="n">do_program_overwrite</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">programs_active</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">program_instructions</span><span class="o">.</span><span class="n">start_year</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">program_instructions</span><span class="o">.</span><span class="n">stop_year</span>

        <span class="k">if</span> <span class="n">do_program_overwrite</span><span class="p">:</span>
            <span class="n">prop_coverage</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">odict</span><span class="o">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span><span class="p">[</span><span class="s2">&quot;comps&quot;</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">comp_list</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span><span class="p">[</span><span class="s2">&quot;comps&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span><span class="p">[</span><span class="s2">&quot;prop_coverage&quot;</span><span class="p">]:</span>  <span class="c1"># If the coverage was precomputed in a coverage scenario</span>
                    <span class="n">prop_coverage</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span><span class="p">[</span><span class="s2">&quot;prop_coverage&quot;</span><span class="p">][</span><span class="n">k</span><span class="p">][[</span><span class="n">ti</span><span class="p">]]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">n</span> <span class="o">=</span> <span class="mf">0.0</span>
                    <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">comp_list</span><span class="p">:</span>
                        <span class="n">n</span> <span class="o">+=</span> <span class="n">comp</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span>
                    <span class="n">prop_coverage</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">progset</span><span class="o">.</span><span class="n">programs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">get_prop_covered</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">ti</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_program_cache</span><span class="p">[</span><span class="s2">&quot;capacities&quot;</span><span class="p">][</span><span class="n">k</span><span class="p">][</span><span class="n">ti</span><span class="p">],</span> <span class="n">n</span><span class="p">)</span>
            <span class="n">prog_vals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">progset</span><span class="o">.</span><span class="n">get_outcomes</span><span class="p">(</span><span class="n">prop_coverage</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">par_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_exec_order</span><span class="p">[</span><span class="s2">&quot;dynamic_pars&quot;</span><span class="p">]:</span>
            <span class="c1"># All of the parameters with this name, across populations.</span>
            <span class="c1"># There should be one for each population (these are Parameters, not Links).</span>
            <span class="n">pars</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span><span class="p">[</span><span class="n">par_name</span><span class="p">]</span>

            <span class="c1"># First - update parameters that are dependencies, evaluating f_stack if required</span>
            <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">pars</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">_is_dynamic</span><span class="p">:</span>
                    <span class="n">par</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>

            <span class="c1"># Then overwrite with program values</span>
            <span class="k">if</span> <span class="n">do_program_overwrite</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">pars</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">par</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="ow">in</span> <span class="n">prog_vals</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">derivative</span><span class="p">:</span>
                            <span class="n">par</span><span class="o">.</span><span class="n">_dx</span> <span class="o">=</span> <span class="n">prog_vals</span><span class="p">[(</span><span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">par</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="p">)]</span>  <span class="c1"># For derivative parameters, overwrite the derivative rather than the value</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">par</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="n">prog_vals</span><span class="p">[(</span><span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">par</span><span class="o">.</span><span class="n">pop</span><span class="o">.</span><span class="n">name</span><span class="p">)]</span>

                        <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_NUMBER</span><span class="p">:</span>
                            <span class="n">par</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">*=</span> <span class="n">par</span><span class="o">.</span><span class="n">source_popsize</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>  <span class="c1"># The outcome in the progbook is per person reached, which is a timestep specific value. Thus, need to annualize here</span>
                        <span class="k">elif</span> <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_RATE</span> <span class="ow">or</span> <span class="n">par</span><span class="o">.</span><span class="n">units</span> <span class="o">==</span> <span class="n">FS</span><span class="o">.</span><span class="n">QUANTITY_TYPE_PROBABILITY</span><span class="p">:</span>
                            <span class="c1"># Continuous programs generally should not target number or probability parameters</span>
                            <span class="c1"># We apply a factor of dt here regardless of the parameter&#39;s timescale. This is because the dt factor here</span>
                            <span class="c1"># matches the factor of dt used to divide the annual spending into timestep spending</span>
                            <span class="n">par</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">/=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>

            <span class="c1"># Handle parameters that aggregate over populations and use interactions in these functions.</span>
            <span class="k">if</span> <span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">:</span>
                <span class="c1"># NB. `par.pop_aggregation` is (agg_fcn,par_name,interaction_name,charac_name) where the last item is optional</span>

                <span class="n">par_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span><span class="p">[</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">[</span><span class="mi">1</span><span class="p">]]]</span>  <span class="c1"># Value of variable being averaged</span>
                <span class="n">par_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">par_vals</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

                <span class="c1"># NOTE - When doing cross-population interactions, &#39;pars&#39; is from the &#39;to&#39; pop</span>
                <span class="c1"># and &#39;par_vals&#39; is from the &#39;from pop</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">par_vals</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">pars</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">weights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interactions</span><span class="p">[</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">[</span><span class="mi">2</span><span class="p">]][:,</span> <span class="p">:,</span> <span class="n">ti</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

                <span class="k">if</span> <span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;SRC_POP_AVG&quot;</span><span class="p">,</span> <span class="s2">&quot;SRC_POP_SUM&quot;</span><span class="p">}:</span>
                    <span class="n">weights</span> <span class="o">=</span> <span class="n">weights</span><span class="o">.</span><span class="n">T</span>
                <span class="k">elif</span> <span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;TGT_POP_AVG&quot;</span><span class="p">,</span> <span class="s2">&quot;TGT_POP_SUM&quot;</span><span class="p">}:</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ModelError</span><span class="p">(</span><span class="s2">&quot;Unknown aggregation function &#39;</span><span class="si">{0}</span><span class="s2">&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>  <span class="c1"># This should never happen, an error should be raised earlier</span>

                <span class="c1"># If we are weighting by a variable, multiply the weights matrix accordingly</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">par</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_vars_by_pop</span><span class="p">[</span><span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">[</span><span class="mi">3</span><span class="p">]]]</span>  <span class="c1"># Value of weighting variable</span>
                    <span class="n">vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                    <span class="n">weights</span> <span class="o">*=</span> <span class="n">vals</span><span class="o">.</span><span class="n">T</span>

                <span class="k">if</span> <span class="n">pars</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">pop_aggregation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">{</span><span class="s2">&quot;SRC_POP_AVG&quot;</span><span class="p">,</span> <span class="s2">&quot;TGT_POP_AVG&quot;</span><span class="p">}:</span>
                    <span class="n">norm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">norm</span><span class="p">[</span><span class="n">norm</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="n">weights</span> <span class="o">/=</span> <span class="n">norm</span>
                <span class="n">par_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">par_vals</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">par</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">par_vals</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">skip_function</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">par</span><span class="o">.</span><span class="n">skip_function</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">par</span><span class="o">.</span><span class="n">skip_function</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>  <span class="c1"># Careful - note how the &lt; here matches &gt;= in Parameter.update()</span>
                        <span class="n">par</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">=</span> <span class="n">par</span><span class="o">.</span><span class="n">scale_factor</span> <span class="o">*</span> <span class="n">val</span>

            <span class="c1"># Restrict the parameter&#39;s value if a limiting range was defined</span>
            <span class="k">for</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">pars</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">par</span><span class="o">.</span><span class="n">derivative</span> <span class="ow">and</span> <span class="n">ti</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># If derivative parameter, then perform an Euler forward step before constraining</span>
                    <span class="n">par</span><span class="p">[</span><span class="n">ti</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">par</span><span class="p">[</span><span class="n">ti</span><span class="p">]</span> <span class="o">+</span> <span class="n">par</span><span class="o">.</span><span class="n">_dx</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dt</span>
                    <span class="n">par</span><span class="o">.</span><span class="n">constrain</span><span class="p">(</span><span class="n">ti</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">par</span><span class="o">.</span><span class="n">constrain</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span></div>
</div>



<div class="viewcode-block" id="run_model">
<a class="viewcode-back" href="../../_autosummary/atomica.model.run_model.html#atomica.model.run_model">[docs]</a>
<span class="k">def</span> <span class="nf">run_model</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="n">framework</span><span class="p">,</span> <span class="n">parset</span><span class="p">:</span> <span class="n">ParameterSet</span><span class="p">,</span> <span class="n">progset</span><span class="p">:</span> <span class="n">ProgramSet</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">program_instructions</span><span class="p">:</span> <span class="n">ProgramInstructions</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Build and process model</span>

<span class="sd">    Running simulations is accomplished via the :class:`Model` object in two steps</span>

<span class="sd">    1. The :class:`Model` object is build, and all variables are initialized</span>
<span class="sd">    2. The integration is carried out</span>

<span class="sd">    ``run_model`` serves as a wrapper for both of these steps, which are commonly performed</span>
<span class="sd">    together. However, in some cases it may be desired to split the operations. For example</span>

<span class="sd">    - In optimization, the same ``Model`` is used at each iteration, but with different instructions.</span>
<span class="sd">      To save time, the model is built just once, and deep-copied after building but before processing</span>
<span class="sd">    - Sometimes it may be required to make changes to the model&#39;s structure e.g. to implement exotic</span>
<span class="sd">      cross-population interactions that cannot be expressed via the Excel inputs. In that case, it may</span>
<span class="sd">      again be necessary</span>

<span class="sd">    :param settings: Project settings defining simulation time span and time step</span>
<span class="sd">    :param framework: A :class:`ProjectFramework` instance</span>
<span class="sd">    :param parset: A :class:`ParameterSet` instance</span>
<span class="sd">    :param progset: Optionally provide a :class:`ProgramSet` instance to use programs</span>
<span class="sd">    :param program_instructions: Optional :class:`ProgramInstructions` instance. If ``progset`` is specified, then instructions must be provided</span>
<span class="sd">    :param name: Optionally specify the name to assign to the output result</span>
<span class="sd">    :return: A :class:`Result` object containing the processed model</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span> <span class="n">framework</span><span class="p">,</span> <span class="n">parset</span><span class="p">,</span> <span class="n">progset</span><span class="p">,</span> <span class="n">program_instructions</span><span class="p">)</span>
    <span class="n">m</span><span class="o">.</span><span class="n">process</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">Result</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">m</span><span class="p">,</span> <span class="n">parset</span><span class="o">=</span><span class="n">parset</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Atomica Team.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>